(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,22520,e=>{"use strict";var s=e.i(43476),a=e.i(6705),l=e.i(70703);let t=(0,l.default)(()=>e.A(99277),{loadableGenerated:{modules:[77115]},ssr:!1,loading:()=>(0,s.jsx)("div",{className:"h-64 w-full animate-pulse rounded-lg bg-gray-100"})}),r=e=>{let{costList:l,dateStr:r,isMobile:d}=e,i=new Date(r),n=i.getFullYear(),o=i.getMonth(),c=new Date(n,o+1,0).getDate(),m=Array(c).fill(0),x=0;return l.forEach(e=>{if(e.type===a.SpendingType.Outcome){let s=new Date(e.date).getDate()-1;m[s]+=Number(e.amount),x=Math.max(x,Math.abs(m[s]))}}),(0,s.jsxs)("div",{className:"bg-background relative flex w-full flex-col items-start rounded-2xl border border-solid border-gray-300 p-6 text-gray-700 shadow-sm transition-shadow duration-200 hover:shadow md:min-w-110",children:[(0,s.jsx)("h3",{className:"mb-2 text-lg font-semibold",children:"本月消費趨勢"}),(0,s.jsx)("div",{className:"flex w-full items-end py-4 text-xs sm:text-sm",children:(0,s.jsx)(t,{month:o,data:m,init:Array(c).fill(0),isMobile:d,handleOnClick:()=>{}})})]})};var d=e.i(22016),i=e.i(40141);function n(e){return(0,i.GenIcon)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M416 277.333H277.333V416h-42.666V277.333H96v-42.666h138.667V96h42.666v138.667H416v42.666z"},child:[]}]})(e)}let o=({children:e,className:a=""})=>(0,s.jsx)("div",{className:`bg-background w-fit rounded-lg ${a}`,children:(0,s.jsxs)(d.default,{href:"/edit",className:"gradient-r-from-purple-to-blue flex items-center justify-center gap-2 rounded-lg px-4 py-2 sm:px-6 sm:py-3 shadow-sm hover:shadow-md transition-all duration-200",scroll:!1,children:[(0,s.jsx)(n,{className:"size-5"}),(0,s.jsx)("span",{children:e})]})});var c=e.i(44970),m=e.i(73886),x=e.i(71645),g=e.i(73665);let u=(0,l.default)(()=>e.A(95264),{loadableGenerated:{modules:[82103]},ssr:!1});function h(e){let{monthlyBudget:a=0,costList:l,isMobile:t}=e,{totalIncome:r,totalOutcome:d}=(0,x.useMemo)(()=>(0,c.getExpenseFromData)(l),[l]),i=a-d,n=a>0?d/a*100:0,h=i<0,f=n>=80&&!h;return(0,s.jsxs)("div",{className:"bg-background relative flex w-full flex-col gap-5 rounded-2xl border border-solid border-gray-300 p-6 text-gray-700 shadow-sm transition-shadow duration-200 hover:shadow md:min-w-110",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"mb-1 flex items-center gap-2",children:[(0,s.jsx)(g.MdOutlineWallet,{className:"text-primary-400 size-5"}),(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"本月預算結餘"})]}),(0,s.jsxs)("div",{className:"mb-2 flex items-baseline gap-2",children:[(0,s.jsxs)("span",{className:`text-3xl font-bold sm:text-4xl ${h?"text-red-600":f?"text-orange-600":"text-primary-500"}`,children:["$",(0,m.normalizeNumber)(Math.abs(i))]}),h&&(0,s.jsx)("span",{className:"text-sm font-medium text-red-600",children:"超支"})]}),(0,s.jsx)("div",{className:"relative h-2.5 w-full overflow-hidden rounded-full bg-gray-100",children:(0,s.jsx)("div",{className:`h-full rounded-full transition-all duration-300 ${h?"bg-red-500":f?"bg-orange-500":"bg-primary-400"}`,style:{width:`${Math.min(n,100)}%`}})}),(0,s.jsxs)("div",{className:"mt-1 flex items-center justify-between text-xs text-gray-500",children:[(0,s.jsxs)("span",{children:["已使用 ",n.toFixed(1),"%"]}),h&&(0,s.jsxs)("span",{className:"font-medium text-red-600",children:["超出 ",(n-100).toFixed(1),"%"]})]})]}),!t&&(0,s.jsx)(u,{totalIncome:a,totalOutcome:d,isMobile:t})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1 rounded-lg bg-gray-50 p-3",children:[(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"預算"}),(0,s.jsxs)("span",{className:"text-base font-semibold text-gray-700 sm:text-lg",children:["$",(0,m.normalizeNumber)(a)]})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-1 rounded-lg bg-red-50 p-3",children:[(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"支出"}),(0,s.jsxs)("span",{className:"text-base font-semibold text-red-600 sm:text-lg",children:["$",(0,m.normalizeNumber)(d)]})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-1 rounded-lg bg-green-50 p-3",children:[(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"收入"}),(0,s.jsxs)("span",{className:"text-base font-semibold text-green-600 sm:text-lg",children:["$",(0,m.normalizeNumber)(r)]})]})]}),(0,s.jsx)(o,{className:"w-full text-sm sm:text-base",children:"立即新增帳目"})]})}var f=e.i(83439),b=e.i(30059),p=e.i(1350);let j=[{title:"帳目編輯",description:"詳細收支記錄",href:"/transactions",icon:e.i(86864).ListTaskIcon,gradient:"from-purple-400 to-pink-300"},{title:"帳本管理",description:"管理帳本與成員",href:"/group",icon:b.BookIcon,gradient:"from-primary-400 to-primary-600"},{title:"帳目分析",description:"查看消費統計圖表",href:"/analysis",icon:f.BarChartIcon,gradient:"from-blue-400 to-indigo-500"},{title:"預算管理",description:"設定與管理預算",href:"/budget",icon:p.CoinIcon,gradient:"from-green-400 to-emerald-500"}],v=({isMobile:e})=>(0,s.jsx)("div",{className:"grid w-full grid-cols-2 gap-3 md:min-w-110",children:j.map(e=>{let a=e.icon;return(0,s.jsxs)(d.default,{href:e.href,className:"bg-background group relative flex flex-col items-center justify-center gap-2 rounded-2xl border border-gray-200 p-4 shadow-sm transition-all duration-200 hover:scale-105 hover:shadow active:scale-100",children:[(0,s.jsx)("div",{className:`flex items-center justify-center rounded-full bg-gradient-to-r ${e.gradient} p-3`,children:(0,s.jsx)(a,{className:"size-6 text-white"})}),(0,s.jsx)("h3",{className:"text-sm font-bold text-gray-700",children:e.title}),(0,s.jsx)("p",{className:"text-center text-xs text-gray-500",children:e.description})]},e.href)})});var w=e.i(48702);let N=e=>(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-chevron-double-right",viewBox:"0 0 16 16",...e,children:[(0,s.jsx)("path",{fillRule:"evenodd",d:"M3.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L9.293 8 3.646 2.354a.5.5 0 0 1 0-.708"}),(0,s.jsx)("path",{fillRule:"evenodd",d:"M7.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L13.293 8 7.646 2.354a.5.5 0 0 1 0-.708"})]}),y=({data:e,loading:a,refreshData:l})=>{let t=(0,x.useMemo)(()=>[...e].sort((e,s)=>new Date(s.date).getTime()-new Date(e.date).getTime()).slice(0,5),[e]);return a&&0===e.length?(0,s.jsxs)("div",{className:"bg-background flex w-full flex-col rounded-2xl border border-gray-200 p-5 shadow-sm md:min-w-110",children:[(0,s.jsx)("h3",{className:"mb-4 text-lg font-bold",children:"最近 5 筆交易"}),(0,s.jsx)("div",{className:"flex flex-col gap-2",children:[1,2,3].map(e=>(0,s.jsx)("div",{className:"h-14 w-full animate-pulse rounded-lg bg-gray-100"},e))})]}):(0,s.jsxs)("div",{className:"bg-background flex w-full flex-col rounded-2xl border border-gray-200 p-5 shadow-sm md:min-w-110",children:[(0,s.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-lg font-bold",children:"最近 5 筆交易"}),(0,s.jsxs)(d.default,{href:"/transactions",className:"text-primary-500 hover:text-primary-400 active:text-primary-600 flex items-center gap-1 text-xs font-bold transition-colors",children:["查看更多",(0,s.jsx)(N,{className:"size-3"})]})]}),(0,s.jsx)("div",{className:"flex flex-col gap-2",children:0===t.length?(0,s.jsx)("p",{className:"py-8 text-center text-sm text-gray-400",children:"尚無交易記錄"}):t.map((e,a)=>(0,s.jsx)(w.SpendingItem,{spending:e,refreshData:l||(()=>{})},`${e.id}-${a}`))})]})},S=()=>(0,s.jsxs)("div",{className:"content-wrapper animate-pulse",children:[(0,s.jsx)("div",{className:"flex justify-center rounded-lg border border-gray-200 bg-gray-100 p-2 shadow-sm h-10 w-64"}),(0,s.jsxs)("div",{className:"flex w-full flex-col gap-3 md:w-auto md:flex-row md:gap-5",children:[(0,s.jsxs)("div",{className:"bg-background relative flex w-full items-center justify-between gap-4 rounded-2xl border border-solid border-gray-200 p-6 shadow-sm md:min-w-110",children:[(0,s.jsxs)("div",{className:"flex h-full min-h-35 flex-col gap-3 md:min-h-50",children:[(0,s.jsx)("div",{className:"h-4 w-32 bg-gray-200 rounded"}),(0,s.jsx)("div",{className:"h-8 w-40 bg-gray-200 rounded"}),(0,s.jsx)("div",{className:"h-6 w-36 bg-gray-200 rounded"})]}),(0,s.jsx)("div",{className:"size-32 rounded-full bg-gray-200"})]}),(0,s.jsxs)("div",{className:"bg-background relative flex w-full flex-col items-start rounded-2xl border border-solid border-gray-200 p-6 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex w-full items-center justify-between mb-2",children:[(0,s.jsx)("div",{className:"h-6 w-24 bg-gray-200 rounded"}),(0,s.jsx)("div",{className:"h-4 w-16 bg-gray-200 rounded"})]}),(0,s.jsx)("div",{className:"w-full h-48 bg-gray-100 rounded-lg"})]})]}),(0,s.jsx)("div",{className:"grid w-full grid-cols-2 gap-3 md:grid-cols-4 md:gap-5",children:[1,2,3,4].map(e=>(0,s.jsxs)("div",{className:"bg-background flex min-h-24 flex-col items-center justify-center gap-2 rounded-2xl border border-solid border-gray-200 p-4 shadow-sm",children:[(0,s.jsx)("div",{className:"size-8 bg-gray-200 rounded-full"}),(0,s.jsx)("div",{className:"h-4 w-20 bg-gray-200 rounded"})]},e))}),(0,s.jsxs)("div",{className:"bg-background flex w-full flex-col rounded-2xl border border-solid border-gray-200 p-6 shadow-sm",children:[(0,s.jsx)("div",{className:"h-6 w-32 bg-gray-200 rounded mb-4"}),(0,s.jsx)("div",{className:"flex flex-col gap-2",children:[1,2,3,4,5].map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-3 rounded-lg bg-gray-50 p-3",children:[(0,s.jsx)("div",{className:"size-6 bg-gray-200 rounded"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"h-4 w-32 bg-gray-200 rounded mb-1"}),(0,s.jsx)("div",{className:"h-3 w-20 bg-gray-200 rounded"})]}),(0,s.jsx)("div",{className:"h-5 w-16 bg-gray-200 rounded"})]},e))})]})]});var M=e.i(76877),D=e.i(26383),k=e.i(1550),O=e.i(75329),z=e.i(86780),I=e.i(96133);e.s(["DashboardSection",0,({isMobile:e})=>{let{syncData:a,data:l,loading:t}=(0,D.useGetSpendingCtx)(),[d,i]=(0,x.useState)(!0),{currentGroup:n}=(0,M.useGroupCtx)(),[o,c]=(0,x.useState)([]),[m,g]=(0,x.useState)(null),u=(0,I.useYearMonth)(new Date),f=(0,x.useCallback)(()=>{let e=new Date,{startDate:s,endDate:l}=(0,O.getStartEndOfMonth)(e);a(n?.account_id?String(n.account_id):void 0,void 0,s.toISOString(),l.toISOString())},[n?.account_id,a]),b=(0,x.useCallback)((e,s,l)=>{let{startDate:t,endDate:r}=(0,O.getStartEndOfMonth)(new Date(Number(s),Number(l)-1));a(e||void 0,void 0,t.toISOString(),r.toISOString())},[a]);(0,x.useEffect)(()=>{n?.account_id&&(0,k.getBudget)(n.account_id).then(e=>{e.status&&e.data&&g(e.data)}).catch(console.error)},[n?.account_id]),(0,x.useEffect)(()=>{f()},[f]),(0,x.useEffect)(()=>{(0,x.startTransition)(()=>{c([...l]),d&&l.length>0&&i(!1)})},[l,d]);let p=(0,x.useMemo)(()=>{if(!m?.monthly_items)return 0;let e=new Date().getMonth()+1,s=0;return m.monthly_items.forEach(a=>{let l=a.months?.[e.toString()];l&&(s+=l)}),s},[m]);return d&&t?(0,s.jsx)(S,{}):(0,s.jsxs)("div",{className:"content-wrapper",children:[(0,s.jsx)(z.YearMonthFilter,{refreshData:b,group:n,dateOptions:u,className:"flex justify-center rounded-lg border border-gray-200 bg-white p-2 text-base shadow-sm"}),(0,s.jsxs)("div",{className:"flex w-full flex-col gap-3 md:w-auto md:flex-row md:gap-5",children:[(0,s.jsx)(h,{monthlyBudget:p,costList:o,isMobile:e}),(0,s.jsx)(r,{dateStr:new Date().toISOString(),costList:o,isMobile:e})]}),(0,s.jsxs)("div",{className:"flex w-full flex-col gap-3 md:w-auto md:flex-row md:gap-5",children:[(0,s.jsx)(v,{isMobile:e}),(0,s.jsx)(y,{data:o,loading:t,refreshData:f})]})]})}],22520)}]);