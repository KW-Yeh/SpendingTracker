(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,73886,e=>{"use strict";e.s(["normalizeNumber",0,e=>{let t=Math.floor(e).toString(),s=[],r=t.split("").reverse(),a=0;return r.forEach(e=>{0!==a&&a%3==0&&s.push(","),s.push(e),a++}),s.toReversed().join("")}])},3995,e=>{"use strict";var t=e.i(43476);e.s(["CalendarIcon",0,e=>(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-calendar-event",viewBox:"0 0 16 16",...e,children:[(0,t.jsx)("path",{d:"M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"}),(0,t.jsx)("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"})]})])},40141,e=>{"use strict";var t=e.i(71645),s={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},r=t.default.createContext&&t.default.createContext(s),a=["attr","size","title"];function l(){return(l=Object.assign.bind()).apply(this,arguments)}function n(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function o(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?n(Object(s),!0).forEach(function(t){var r,a,l;r=e,a=t,l=s[t],(a=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(a))in r?Object.defineProperty(r,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):r[a]=l}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):n(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function c(e){return s=>t.default.createElement(i,l({attr:o({},e.attr)},s),function e(s){return s&&s.map((s,r)=>t.default.createElement(s.tag,o({key:r},s.attr),e(s.child)))}(e.child))}function i(e){var n=s=>{var r,{attr:n,size:c,title:i}=e,u=function(e,t){if(null==e)return{};var s,r,a=function(e,t){if(null==e)return{};var s={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;s[r]=e[r]}return s}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)s=l[r],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,a),d=c||s.size||"1em";return s.className&&(r=s.className),e.className&&(r=(r?r+" ":"")+e.className),t.default.createElement("svg",l({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,n,u,{className:r,style:o(o({color:e.color||s.color},s.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),i&&t.default.createElement("title",null,i),e.children)};return void 0!==r?t.default.createElement(r.Consumer,null,e=>n(e)):n(s)}e.s(["GenIcon",()=>c],40141)},14491,e=>{"use strict";let t={50:"hsl(270, 50%, 98%)",100:"hsl(270, 50%, 95%)",200:"hsl(270, 50%, 85%)",300:"hsl(270, 50%, 70%)",400:"hsl(270, 50%, 55%)",500:"hsl(270, 50%, 40%)",600:"hsl(270, 50%, 32%)",700:"hsl(270, 50%, 24%)",800:"hsl(270, 50%, 16%)",900:"hsl(270, 50%, 10%)"},s={100:"hsl(150, 40%, 95%)",500:"hsl(150, 40%, 55%)"},r={100:"hsl(20, 80%, 95%)",500:"hsl(20, 80%, 70%)"};s[500],s[100],r[500],r[100],t[500],t[100],e.s(["CHART_COLORS",0,{INCOME_PRIMARY:"hsl(150, 40%, 55%)",INCOME_NECESSARY:"hsl(150, 50%, 65%)",INCOME_UNNECESSARY:"hsl(150, 30%, 75%)",OUTCOME_PRIMARY:"hsl(20, 80%, 70%)",OUTCOME_NECESSARY:"hsl(20, 70%, 75%)",OUTCOME_UNNECESSARY:"hsl(20, 60%, 85%)",NEUTRAL:"hsl(0, 0%, 80%)"}])},10788,e=>{"use strict";var t=e.i(71645);e.s(["useScrollToTop",0,()=>{(0,t.useEffect)(()=>{window.scrollTo(0,0)},[])}])},67585,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"BailoutToCSR",{enumerable:!0,get:function(){return a}});let r=e.r(32061);function a({reason:e,children:t}){if("undefined"==typeof window)throw Object.defineProperty(new r.BailoutToCSRError(e),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return t}},9885,(e,t,s)=>{"use strict";function r(e){return e.split("/").map(e=>encodeURIComponent(e)).join("/")}Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"encodeURIPath",{enumerable:!0,get:function(){return r}})},52157,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"PreloadChunks",{enumerable:!0,get:function(){return o}});let r=e.r(43476),a=e.r(74080),l=e.r(63599),n=e.r(9885);function o({moduleIds:e}){if("undefined"!=typeof window)return null;let t=l.workAsyncStorage.getStore();if(void 0===t)return null;let s=[];if(t.reactLoadableManifest&&e){let r=t.reactLoadableManifest;for(let t of e){if(!r[t])continue;let e=r[t].files;s.push(...e)}}return 0===s.length?null:(0,r.jsx)(r.Fragment,{children:s.map(e=>{let s=`${t.assetPrefix}/_next/${(0,n.encodeURIPath)(e)}`;return e.endsWith(".css")?(0,r.jsx)("link",{precedence:"dynamic",href:s,rel:"stylesheet",as:"style",nonce:t.nonce},e):((0,a.preload)(s,{as:"script",fetchPriority:"low",nonce:t.nonce}),null)})})}},69093,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return i}});let r=e.r(43476),a=e.r(71645),l=e.r(67585),n=e.r(52157);function o(e){return{default:e&&"default"in e?e.default:e}}let c={loader:()=>Promise.resolve(o(()=>null)),loading:null,ssr:!0},i=function(e){let t={...c,...e},s=(0,a.lazy)(()=>t.loader().then(o)),i=t.loading;function u(e){let o=i?(0,r.jsx)(i,{isLoading:!0,pastDelay:!0,error:null}):null,c=!t.ssr||!!t.loading,u=c?a.Suspense:a.Fragment,d=t.ssr?(0,r.jsxs)(r.Fragment,{children:["undefined"==typeof window?(0,r.jsx)(n.PreloadChunks,{moduleIds:t.modules}):null,(0,r.jsx)(s,{...e})]}):(0,r.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(s,{...e})});return(0,r.jsx)(u,{...c?{fallback:o}:{},children:d})}return u.displayName="LoadableComponent",u}},70703,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return a}});let r=e.r(55682)._(e.r(69093));function a(e,t){let s={};"function"==typeof e&&(s.loader=e);let a={...s,...t};return(0,r.default)({...a,modules:a.loadableGenerated?.modules})}("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),t.exports=s.default)},76814,e=>{"use strict";var t=e.i(43476);let s=({title:e,children:s})=>(0,t.jsxs)("div",{className:"relative flex w-full flex-col items-center rounded-xl bg-white p-6 shadow-md transition-all hover:shadow-lg z-10",children:[(0,t.jsx)("div",{className:"mb-4 w-full",children:(0,t.jsxs)("h2",{className:"relative inline-block text-xl font-bold text-gray-800 select-none",children:[e,(0,t.jsx)("span",{className:"absolute -bottom-1 left-0 h-1 w-1/2 rounded-full bg-primary-300"})]})}),s]});var r=e.i(86780),a=e.i(76877),l=e.i(26383),n=e.i(61500),o=e.i(10788),c=e.i(96133),i=e.i(6705),u=e.i(14491);let d=(e,t,s,r,a)=>{let l=[],n=[],o=[];return e.forEach(({label:e})=>{let c=t.get(e)??m();l.push({id:e,name:e,value:c.total,necessary:c.necessary,unnecessary:c.unnecessary,color:s}),n.push({name:e,value:c.necessaryList.reduce((e,t)=>e+t,0),color:r}),o.push({name:e,value:c.unnecessaryList.reduce((e,t)=>e+t,0),color:a})}),{results:l,necessaryList:n,unnecessaryList:o}},m=()=>({necessary:0,unnecessary:0,necessaryList:[],unnecessaryList:[],total:0});var f=e.i(75329),y=e.i(70703),b=e.i(71645),h=e.i(73886);let p=({title:e,total:s,list:r,options:a={headerStyle:"bg-gray-200"}})=>(0,t.jsxs)("div",{className:"flex w-full flex-col gap-2 whitespace-nowrap",children:[(0,t.jsx)("h3",{className:"font-semibold",children:e}),(0,t.jsxs)("table",{className:"w-full border-collapse text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:a.headerStyle,children:[(0,t.jsx)("th",{className:"border border-solid border-gray-300 border-r-transparent px-2 py-1 text-center",children:"類型"}),(0,t.jsx)("th",{className:"border border-solid border-gray-300 border-r-transparent px-2 py-1 text-right",children:"比例 (%)"}),(0,t.jsx)("th",{className:"border border-solid border-gray-300 px-2 py-1 text-right",children:"金額 (NTD)"})]})}),(0,t.jsx)("tbody",{children:r.map(e=>(0,t.jsxs)("tr",{className:0===e.value?"text-gray-300":"",children:[(0,t.jsx)("td",{className:"col-span-1 border border-solid border-gray-300 p-2 text-center",children:e.name}),(0,t.jsxs)("td",{className:"col-span-1 border border-solid border-gray-300 p-2 text-end",children:[0===e.value?0:(Math.round(e.value/s*100)||0).toFixed(0),"%"]}),(0,t.jsxs)("td",{className:"col-span-2 border border-solid border-gray-300 p-2 text-end",children:["$",(0,h.normalizeNumber)(e.value)]})]},`income-${e.name}`))})]})]}),g=i.OUTCOME_TYPE_MAP.map(({label:e})=>({name:e,value:0})),x=i.INCOME_TYPE_MAP.map(({label:e})=>({name:e,value:0})),j=e=>{let[s,r]=(0,b.useState)(g),[a,l]=(0,b.useState)(x),n=(0,b.useMemo)(()=>e.totalIncome+e.totalOutcome,[e.totalIncome,e.totalOutcome]),o=(0,b.useMemo)(()=>100*e.totalOutcome/(n||100),[e.totalOutcome,n]),c=(0,b.useMemo)(()=>100*e.totalIncome/(n||100),[e.totalIncome,n]);return(0,b.useEffect)(()=>{e.outcomeList.length>0&&r(t=>t.map((t,s)=>({...t,value:e.outcomeList[s].value})))},[e.outcomeList]),(0,b.useEffect)(()=>{e.incomeList.length>0&&l(t=>t.map((t,s)=>({...t,value:e.incomeList[s].value})))},[e.incomeList]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p,{title:`支出各項資訊 $${(0,h.normalizeNumber)(e.totalOutcome)}（${o.toFixed(0)}%）`,total:e.totalOutcome,list:s,options:{headerStyle:"bg-red-500/30"}}),(0,t.jsx)(p,{title:`收入各項資訊 $${(0,h.normalizeNumber)(e.totalIncome)}（${c.toFixed(0)}%）`,total:e.totalIncome,list:a,options:{headerStyle:"bg-green-500/30"}})]})},v=i.OUTCOME_TYPE_MAP.map(({label:e})=>({name:e,value:0})),N=e=>{let[s,r]=(0,b.useState)(v),[a,l]=(0,b.useState)(v),n=(0,b.useMemo)(()=>e.totalNecessary+e.totalUnnecessary,[e.totalNecessary,e.totalUnnecessary]),o=(0,b.useMemo)(()=>100*e.totalUnnecessary/(n||100),[e.totalUnnecessary,n]),c=(0,b.useMemo)(()=>100*e.totalNecessary/(n||100),[e.totalNecessary,n]);return(0,b.useEffect)(()=>{e.unnecessaryList.length>0&&l(t=>t.map((t,s)=>({...t,value:e.unnecessaryList[s].value})))},[e.unnecessaryList]),(0,b.useEffect)(()=>{e.necessaryList.length>0&&r(t=>t.map((t,s)=>({...t,value:e.necessaryList[s].value})))},[e.necessaryList]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p,{title:`必要支出各項資訊 $${(0,h.normalizeNumber)(e.totalNecessary)}（${c.toFixed(0)}%）`,total:e.totalNecessary,list:s,options:{headerStyle:"bg-orange-500/30"}}),(0,t.jsx)(p,{title:`額外支出各項資訊 $${(0,h.normalizeNumber)(e.totalUnnecessary)}（${o.toFixed(0)}%）`,total:e.totalUnnecessary,list:a,options:{headerStyle:"bg-gray-500/30"}})]})},O=(0,y.default)(()=>e.A(92760),{loadableGenerated:{modules:[50790]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"mx-auto mt-15 aspect-square size-45 rounded-full bg-gray-200 p-1.5",children:(0,t.jsx)("div",{className:"bg-background size-full rounded-full p-1.5",children:(0,t.jsx)("div",{className:"size-full rounded-full bg-gray-200 p-5",children:(0,t.jsx)("div",{className:"bg-background size-full rounded-full"})})})})}),E=(0,y.default)(()=>e.A(35879),{loadableGenerated:{modules:[75689]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"mx-auto mt-15 aspect-square size-45 rounded-full bg-gray-200 p-1.5",children:(0,t.jsx)("div",{className:"bg-background size-full rounded-full p-1.5",children:(0,t.jsx)("div",{className:"size-full rounded-full bg-gray-200 p-5",children:(0,t.jsx)("div",{className:"bg-background size-full rounded-full"})})})})});e.s(["ChartBlock",0,()=>{(0,o.useScrollToTop)();let{config:e}=(0,n.useUserConfigCtx)(),{data:y,syncData:h}=(0,l.useGetSpendingCtx)(),{currentGroup:p}=(0,a.useGroupCtx)(),[g,x]=(0,b.useState)({income:{list:[],total:100,necessary:50,unnecessary:50,necessaryList:[],unnecessaryList:[]},outcome:{list:[],total:50,necessary:25,unnecessary:25,necessaryList:[],unnecessaryList:[]}}),v=new Date,C=(0,c.useYearMonth)(v),w=(0,b.useCallback)((t,s,r)=>{let{startDate:a,endDate:l}=(0,f.getStartEndOfMonth)(new Date(Number(s),Number(r)-1));h(t,e?.email,a.toISOString(),l.toISOString())},[h,e?.email]);return(0,b.useEffect)(()=>{(0,b.startTransition)(()=>{x((e=>{var t;let s,r,a,l,n,o,c,f,{incomeResult:y,totalIncome:b,necessaryIncome:h,unnecessaryIncome:p,outcomeResult:g,totalOutcome:x,necessaryOutcome:j,unnecessaryOutcome:v}=(t=e,s=new Map,r=0,a=0,l=0,n=new Map,o=0,c=0,f=0,t.forEach(e=>{if(e.type===i.SpendingType.Income){let t=i.INCOME_TYPE_MAP.find(t=>t.value===e.category);if(t){r+=Number(e.amount);let n=s.get(t.label)??m();e.necessity===i.Necessity.Need?(a+=Number(e.amount),n={...n,necessary:n.necessary+Number(e.amount),necessaryList:[...n.necessaryList,Number(e.amount)]}):(l+=Number(e.amount),n={...n,unnecessary:n.unnecessary+Number(e.amount),unnecessaryList:[...n.unnecessaryList,Number(e.amount)]}),s.set(t.label,{...n,total:n.total+Number(e.amount)})}}else{let t=i.OUTCOME_TYPE_MAP.find(t=>t.value===e.category);if(t){o+=Number(e.amount);let s=n.get(t.label)??m();e.necessity===i.Necessity.Need?(c+=Number(e.amount),s={...s,necessary:s.necessary+Number(e.amount),necessaryList:[...s.necessaryList,Number(e.amount)]}):(f+=Number(e.amount),s={...s,unnecessary:s.unnecessary+Number(e.amount),unnecessaryList:[...s.unnecessaryList,Number(e.amount)]}),n.set(t.label,{...s,total:s.total+Number(e.amount)})}}}),{incomeResult:s,totalIncome:r,necessaryIncome:a,unnecessaryIncome:l,outcomeResult:n,totalOutcome:o,necessaryOutcome:c,unnecessaryOutcome:f}),{results:N,necessaryList:O,unnecessaryList:E}=d(i.INCOME_TYPE_MAP,y,u.CHART_COLORS.INCOME_PRIMARY,u.CHART_COLORS.INCOME_NECESSARY,u.CHART_COLORS.NEUTRAL),{results:C,necessaryList:w,unnecessaryList:L}=d(i.OUTCOME_TYPE_MAP,g,u.CHART_COLORS.OUTCOME_PRIMARY,u.CHART_COLORS.OUTCOME_NECESSARY,u.CHART_COLORS.NEUTRAL);return{income:{total:b,necessary:h,unnecessary:p,necessaryList:O,unnecessaryList:E,list:N},outcome:{total:x,necessary:j,unnecessary:v,necessaryList:w,unnecessaryList:L,list:C}}})(y.filter(e=>`${new Date(e.date).getFullYear()}`===C.year&&`${new Date(e.date).getMonth()+1}`===C.month)))})},[y,C.year,C.month]),(0,t.jsxs)("div",{className:"content-wrapper",children:[(0,t.jsx)(r.YearMonthFilter,{refreshData:w,group:p,dateOptions:C,className:"flex self-center rounded-lg border border-gray-200 bg-white p-2 text-base shadow-sm"}),(0,t.jsxs)("div",{className:"flex w-full flex-col items-center gap-8 md:flex-row md:items-start",children:[(0,t.jsx)(s,{title:"收支類別比例",children:(0,t.jsxs)("div",{className:"flex w-full flex-wrap justify-center gap-4",children:[(0,t.jsx)("div",{className:"size-75",children:(0,t.jsx)(O,{totalIncome:g.income.total,totalOutcome:g.outcome.total,list:[...g.outcome.list,...g.income.list]})}),(0,t.jsx)("div",{className:"flex flex-1 flex-col gap-4",children:(0,t.jsx)(j,{totalIncome:g.income.total,totalOutcome:g.outcome.total,incomeList:g.income.list,outcomeList:g.outcome.list})})]})}),(0,t.jsx)(s,{title:"支出類別比例（必要 vs 額外）",children:(0,t.jsxs)("div",{className:"flex w-full flex-wrap justify-center gap-4",children:[(0,t.jsx)("div",{className:"size-75",children:(0,t.jsx)(E,{totalNecessity:g.outcome.necessary,totalUnnecessity:g.outcome.unnecessary,list:[...g.outcome.necessaryList,...g.outcome.unnecessaryList]})}),(0,t.jsx)("div",{className:"flex flex-1 flex-col gap-4",children:(0,t.jsx)(N,{totalNecessary:g.outcome.necessary,totalUnnecessary:g.outcome.unnecessary,necessaryList:g.outcome.necessaryList,unnecessaryList:g.outcome.unnecessaryList})})]})})]})]})}],76814)},92760,e=>{e.v(t=>Promise.all(["static/chunks/5054840b4b7a1bd6.js","static/chunks/042b4b5cbe281748.js","static/chunks/8007746fd0e61649.js"].map(t=>e.l(t))).then(()=>t(50790)))},35879,e=>{e.v(t=>Promise.all(["static/chunks/d90bdc4c22840e57.js","static/chunks/042b4b5cbe281748.js","static/chunks/8007746fd0e61649.js"].map(t=>e.l(t))).then(()=>t(75689)))}]);