(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71208,e=>{"use strict";function t(e,r,s={}){let a=`${encodeURIComponent(e)}=${encodeURIComponent(r)}`;if(s.expires){let e=s.expires instanceof Date?s.expires:new Date(Date.now()+24*s.expires*36e5);a+=`; expires=${e.toUTCString()}`}s.path&&(a+=`; path=${s.path}`),s.domain&&(a+=`; domain=${s.domain}`),s.secure&&(a+="; secure"),s.sameSite&&(a+=`; samesite=${s.sameSite}`),document.cookie=a}function r(e){let t=encodeURIComponent(e)+"=",r=document.cookie.split(";");for(let e=0;e<r.length;e++){let s=r[e].trim();if(s.startsWith(t))return decodeURIComponent(s.substring(t.length))}return null}e.s(["getCookie",()=>r,"setCookie",()=>t])},26383,e=>{"use strict";var t=e.i(43476),r=e.i(10969),s=e.i(39287),a=e.i(71208),n=e.i(71645);let o=(e,t)=>({data:t,loading:!1}),i=(0,n.createContext)({loading:!0,data:[],syncData:()=>{}});e.s(["SpendingProvider",0,({children:e})=>{let[l,c]=(0,n.useReducer)(o,{data:[],loading:!0}),{db:u,getSpendingData:d,setSpendingData:g}=(0,r.useIDB)(),h=(0,n.useRef)(null),m=(0,n.useCallback)(e=>{c(e)},[]),f=(0,n.useCallback)((e,t,r,a)=>{(e||t)&&(0,s.getItems)(t,e,r,a).then(e=>{h.current&&h.current.abort(),console.log("Get Data from API"),m(e.data),g(u,e.data,Number(t),r).then(()=>{console.log("Update IDB success.")}).catch(e=>{console.log("Update IDB failed: ",e)})}).catch(console.error)},[u,m,g]),p=(0,n.useCallback)((e,t,r,s)=>{f(t,e,r,s)},[f]),w=(0,n.useMemo)(()=>({...l,syncData:p}),[l,p]);return(0,n.useEffect)(()=>{let e=h.current=new AbortController,t=(0,a.getCookie)("currentGroupId");return u&&t&&d(u,Number(t),e.signal).then(e=>{if(e&&1===e.length){let t=JSON.parse(e[0].data);console.log("Get Data from IDB",t),0!==t.length&&(m(t),h.current=null)}}).catch(e=>{console.log("Error while syncing data: ",e)}),()=>e.abort()},[u,d,m]),(0,t.jsx)(i.Provider,{value:w,children:e})},"useGetSpendingCtx",0,()=>(0,n.useContext)(i)])},75329,e=>{"use strict";e.s(["getStartEndOfMonth",0,e=>({startDate:new Date(new Date(e).getFullYear(),new Date(e).getMonth(),1,0,0,0),endDate:new Date(new Date(e).getFullYear(),new Date(e).getMonth()+1,0,23,59,59)})])},39287,e=>{"use strict";let t="/api/aurora/items",r=async(e,r,s,a)=>{try{let n=new URLSearchParams;if(e)n.set("groupId",e);else{if(!r)return{status:!1,data:[],message:"ç¼ºå°‘ç¾¤çµ„ ID æˆ–ä¿¡ç®±è³‡è¨Š"};n.set("email",r)}s&&n.set("startDate",s),a&&n.set("endDate",a);let o=await fetch(`${t}?${n}`).then(e=>e.json());return{status:!0,data:o,message:"success"}}catch(e){return console.error(e),{status:!1,data:[],message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}},s=async e=>{try{return await fetch(t,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(e){return console.error(e),{status:!1,message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}},a=async e=>{try{return await fetch(`${t}?id=${e}`,{method:"DELETE"})}catch(e){return console.error(e),{status:!1,message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}};e.s(["deleteItem",0,a,"getItems",0,r,"putItem",0,s])},47573,e=>{"use strict";var t=e.i(71645);e.s(["default",0,e=>{let r=(0,t.useRef)(null);return(0,t.useEffect)(()=>{let t=t=>{r.current&&!r.current.contains(t.target)&&e()};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[e]),r}])},6705,e=>{"use strict";var t,r,s=((t={}).Income="Income",t.Outcome="Outcome",t),a=((r={}).Need="å¿…",r.NotNeed="éž",r);let n=["æŠ•è³‡","è–ªè³‡","çŽé‡‘","å…¶ä»–"],o=["ðŸ“ˆ","ðŸ’°","ðŸŽ","âœ¨"].map((e,t)=>({value:e,label:n[t]})),i=["é£²é£Ÿ","æœé£¾","ä½å®¿","äº¤é€š","å­¸ç¿’","å¨›æ¨‚","æ—¥å¸¸","é†«ç™‚","æŠ•è³‡","å…¶ä»–"],l=["ðŸ”","ðŸ‘—","ðŸ ","ðŸš—","ðŸ“š","ðŸŽ²","ðŸ§»","ðŸ’Š","ðŸ“‰","âœ¨"].map((e,t)=>({value:e,label:i[t]}));e.s(["CATEGORY_WORDING_MAP",0,{"ðŸ”":"é£²é£Ÿ","ðŸ‘—":"æœé£¾","ðŸ ":"ä½å®¿","ðŸš—":"äº¤é€š","ðŸ“š":"å­¸ç¿’","ðŸŽ²":"å¨›æ¨‚","ðŸ§»":"æ—¥å¸¸","ðŸ’Š":"é†«ç™‚","ðŸ“‰":"æŠ•è³‡","âœ¨":"å…¶ä»–","ðŸ“ˆ":"æŠ•è³‡","ðŸ’°":"è–ªè³‡","ðŸŽ":"çŽé‡‘"},"IDB_NAME",0,"Expense Tracking","IDB_VERSION",0,2,"INCOME_TYPE_MAP",0,o,"MENU_CONFIG",0,{"/":"é¦–é ","/transactions":"å¸³ç›®","/group":"å¸³æœ¬","/analysis":"åˆ†æž","/budget":"é ç®—"},"MONTH_LABEL",0,{Jan:"1",Feb:"2",Mar:"3",Apr:"4",May:"5",Jun:"6",Jul:"7",Aug:"8",Sep:"9",Oct:"10",Nov:"11",Dec:"12"},"MONTH_MAP",0,{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},"Necessity",()=>a,"OUTCOME_TYPE_MAP",0,l,"SpendingType",()=>s,"WEEKDAY",0,["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"]])},10969,e=>{"use strict";var t,r=e.i(6705),s=e.i(71645),a=((t=a||{}).UserConfig="User Config",t.ExpenseRecord="Expense Record",t.GroupData="Group Data",t.BudgetData="Budget Data",t);let n=r.IDB_NAME,o=r.IDB_VERSION,i=["User Config","Expense Record","Group Data","Budget Data"],l={"Expense Record":{indexName:"group_year_month",indexValue:["group_id","year","month"]},"User Config":{indexName:"email",indexValue:["email"]},"Group Data":{indexName:"user_id",indexValue:["user_id"]},"Budget Data":{indexName:"account_id",indexValue:["account_id"]}};e.s(["useIDB",0,()=>{let[e,t]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=indexedDB.open(n,o);e.onsuccess=()=>{let r=e.result;for(let e of i)if(!r.objectStoreNames.contains(e)){console.error(`Object store ${e} does not exist.`),r.close(),indexedDB.deleteDatabase(n),window.location.reload();return}t(r)},e.onupgradeneeded=()=>{let t=e.result;for(let e of i)if(!t.objectStoreNames.contains(e)){let r=t.createObjectStore(e,{keyPath:"id",autoIncrement:!0}),s=l[e];r.createIndex(s.indexName,s.indexValue,{unique:!0})}},e.onerror=()=>console.error("Error opening IndexedDB:",e.error)},[]);let r=(0,s.useCallback)((e,t)=>e?new Promise((r,s)=>{let a=e.transaction(i,"readwrite").objectStore("User Config"),n={email:t.email,data:JSON.stringify(t)},o=a.index(l["User Config"].indexName).get([t.email]);o.onsuccess=()=>{let e=o.result;e&&(n.id=e.id);let t=a.put(n);t.onsuccess=()=>r(),t.onerror=()=>console.error(t.error)},o.onerror=()=>console.error(o.error)}):Promise.reject("Database not initialized"),[]),a=(0,s.useCallback)((e,t,r)=>e?new Promise((s,a)=>{let n=e.transaction(i,"readonly"),o=!0;n.oncomplete=()=>{o=!1},n.onerror=e=>{o=!1,console.error(e.target.error)},r.addEventListener("abort",()=>{o&&(console.log("getUserData aborted"),n.abort())});let c=n.objectStore("User Config").index(l["User Config"].indexName).get([t]);c.onsuccess=()=>{o=!1,s(c.result)},c.onerror=()=>{o=!1,console.error(c.error)},n.onabort=()=>console.error("Transaction aborted")}):Promise.reject("Database not initialized"),[]),c=(0,s.useCallback)((e,t,r,s=new Date().toISOString())=>e?null==r?Promise.reject("Invalid groupId"):new Promise((a,n)=>{let o=e.transaction(i,"readwrite").objectStore("Expense Record"),c=new Date(s).getFullYear(),u=new Date(s).getMonth(),d={group_id:r,year:c,month:u,data:JSON.stringify(t)},g=o.index(l["Expense Record"].indexName);try{let e=g.get([r,c,u]);e.onsuccess=()=>{let t=e.result;t&&(d.id=t.id);let r=o.put(d);r.onsuccess=()=>a(),r.onerror=()=>n(r.error)},e.onerror=()=>n(e.error)}catch(t){let e=o.getAll();e.onsuccess=()=>{try{let t=e.result.find(e=>e.group_id==r&&e.year===c&&e.month===u);t&&(d.id=t.id);let s=o.put(d);s.onsuccess=()=>a(),s.onerror=()=>n(s.error)}catch(e){n(e)}},e.onerror=()=>n(e.error)}}):Promise.reject("Database not initialized"),[]),u=(0,s.useCallback)((e,t,r)=>e?new Promise((s,a)=>{let n=e.transaction(i,"readonly"),o=!0;n.oncomplete=()=>{o=!1},n.onerror=e=>{o=!1,console.error(e.target.error)},r.addEventListener("abort",()=>{o&&(console.log("getUserData aborted"),n.abort())});let c=n.objectStore("Expense Record").index(l["Expense Record"].indexName),u=new Date().getFullYear(),d=new Date().getMonth(),g=c.getAll([t,u,d]);g.onsuccess=()=>{o=!1,s(g.result)},g.onerror=()=>{o=!1,console.error(g.error)},n.onabort=()=>console.error("Transaction aborted")}):Promise.reject("Database not initialized"),[]),d=(0,s.useCallback)((e,t,r)=>e?new Promise((s,a)=>{let n=e.transaction(i,"readwrite").objectStore("Group Data"),o={user_id:t,data:JSON.stringify(r),timestamp:Date.now()},c=n.index(l["Group Data"].indexName).get([t]);c.onsuccess=()=>{let e=c.result;e&&(o.id=e.id);let t=n.put(o);t.onsuccess=()=>s(),t.onerror=()=>a(t.error)},c.onerror=()=>a(c.error)}):Promise.reject("Database not initialized"),[]),g=(0,s.useCallback)((e,t,r=3e5)=>e?new Promise((s,a)=>{let n=e.transaction(i,"readonly").objectStore("Group Data").index(l["Group Data"].indexName).get([t]);n.onsuccess=()=>{let e=n.result;if(!e||Date.now()-e.timestamp>r)return void s(null);try{let t=JSON.parse(e.data);s(t)}catch(e){a(e)}},n.onerror=()=>a(n.error)}):Promise.reject("Database not initialized"),[]);return{db:e,setSpendingData:c,getSpendingData:u,setUserData:r,getUserData:a,setGroupData:d,getGroupData:g,setBudgetData:(0,s.useCallback)((e,t,r)=>e?new Promise((s,a)=>{let n=e.transaction(i,"readwrite").objectStore("Budget Data"),o={account_id:t,data:JSON.stringify(r),timestamp:Date.now()},c=n.index(l["Budget Data"].indexName).get([t]);c.onsuccess=()=>{let e=c.result;e&&(o.id=e.id);let t=n.put(o);t.onsuccess=()=>s(),t.onerror=()=>a(t.error)},c.onerror=()=>a(c.error)}):Promise.reject("Database not initialized"),[]),getBudgetData:(0,s.useCallback)((e,t,r=3e5)=>e?new Promise((s,a)=>{let n=e.transaction(i,"readonly").objectStore("Budget Data").index(l["Budget Data"].indexName).get([t]);n.onsuccess=()=>{let e=n.result;if(!e||Date.now()-e.timestamp>r)return void s(null);try{let t=JSON.parse(e.data);s(t)}catch(e){a(e)}},n.onerror=()=>a(n.error)}):Promise.reject("Database not initialized"),[])}}])},18566,(e,t,r)=>{t.exports=e.r(76562)},26732,e=>{"use strict";var t=e.i(47167),r=e.i(43476),s=e.i(71645);class a extends Error{constructor(e,t){e instanceof Error?super(void 0,{cause:{err:e,...e.cause,...t}}):"string"==typeof e?(t instanceof Error&&(t={err:t,...t.cause}),super(e,t)):super(void 0,e),this.name=this.constructor.name,this.type=this.constructor.type??"AuthError",this.kind=this.constructor.kind??"error",Error.captureStackTrace?.(this,this.constructor);const r=`https://errors.authjs.dev#${this.type.toLowerCase()}`;this.message+=`${this.message?". ":""}Read more at ${r}`}}class n extends a{}class o extends a{}async function i(e,t,r,s={}){let a=`${l(t)}/${e}`;try{let e={headers:{"Content-Type":"application/json",...s?.headers?.cookie?{cookie:s.headers.cookie}:{}}};s?.body&&(e.body=JSON.stringify(s.body),e.method="POST");let t=await fetch(a,e),r=await t.json();if(!t.ok)throw r;return r}catch(e){return r.error(new n(e.message,e)),null}}function l(e){return"undefined"==typeof window?`${e.baseUrlServer}${e.basePathServer}`:e.basePath}function c(){return Math.floor(Date.now()/1e3)}function u(e){let t=new URL("http://localhost:3000/api/auth");e&&!e.startsWith("http")&&(e=`https://${e}`);let r=new URL(e||t),s=("/"===r.pathname?t.pathname:r.pathname).replace(/\/$/,""),a=`${r.origin}${s}`;return{origin:r.origin,host:r.host,path:s,base:a,toString:()=>a}}let d={baseUrl:u(t.default.env.NEXTAUTH_URL??t.default.env.VERCEL_URL).origin,basePath:u(t.default.env.NEXTAUTH_URL).path,baseUrlServer:u(t.default.env.NEXTAUTH_URL_INTERNAL??t.default.env.NEXTAUTH_URL??t.default.env.VERCEL_URL).origin,basePathServer:u(t.default.env.NEXTAUTH_URL_INTERNAL??t.default.env.NEXTAUTH_URL).path,_lastSync:0,_session:void 0,_getSession:()=>{}},g=null;function h(){return"undefined"==typeof BroadcastChannel?{postMessage:()=>{},addEventListener:()=>{},removeEventListener:()=>{},name:"next-auth",onmessage:null,onmessageerror:null,close:()=>{},dispatchEvent:()=>!1}:new BroadcastChannel("next-auth")}function m(){return null===g&&(g=h()),g}let f={debug:console.debug,error:console.error,warn:console.warn},p=s.createContext?.(void 0);function w(e){if(!p)throw Error("React Context is unavailable in Server Components");let t=s.useContext(p),{required:r,onUnauthenticated:a}=e??{},n=r&&"unauthenticated"===t.status;return(s.useEffect(()=>{if(n){let e=`${d.basePath}/signin?${new URLSearchParams({error:"SessionRequired",callbackUrl:window.location.href})}`;a?a():window.location.href=e}},[n,a]),n)?{data:t.data,update:t.update,status:"loading"}:t}async function v(e){let t=await i("session",d,f,e);return(e?.broadcast??!0)&&h().postMessage({event:"session",data:{trigger:"getSession"}}),t}async function y(){let e=await i("csrf",d,f);return e?.csrfToken??""}async function b(){return i("providers",d,f)}async function C(e,t,r){let{callbackUrl:s,...a}=t??{},{redirect:n=!0,redirectTo:o=s??window.location.href,...i}=a,c=l(d),u=await b();if(!u){let e=`${c}/error`;window.location.href=e;return}if(!e||!u[e]){let e=`${c}/signin?${new URLSearchParams({callbackUrl:o})}`;window.location.href=e;return}let g=u[e].type;if("webauthn"===g)throw TypeError(`Provider id "${e}" refers to a WebAuthn provider.
Please use \`import { signIn } from "next-auth/webauthn"\` instead.`);let h=`${c}/${"credentials"===g?"callback":"signin"}/${e}`,m=await y(),f=await fetch(`${h}?${new URLSearchParams(r)}`,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({...i,csrfToken:m,callbackUrl:o})}),p=await f.json();if(n){let e=p.url??o;window.location.href=e,e.includes("#")&&window.location.reload();return}let w=new URL(p.url).searchParams.get("error")??void 0,v=new URL(p.url).searchParams.get("code")??void 0;return f.ok&&await d._getSession({event:"storage"}),{error:w,code:v,status:f.status,ok:f.ok,url:w?null:p.url}}async function x(e){let{redirect:t=!0,redirectTo:r=e?.callbackUrl??window.location.href}=e??{},s=l(d),a=await y(),n=await fetch(`${s}/signout`,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({csrfToken:a,callbackUrl:r})}),o=await n.json();if(m().postMessage({event:"session",data:{trigger:"signout"}}),t){let e=o.url??r;window.location.href=e,e.includes("#")&&window.location.reload();return}return await d._getSession({event:"storage"}),o}function D(e){if(!p)throw Error("React Context is unavailable in Server Components");let{children:t,basePath:a,refetchInterval:n,refetchWhenOffline:l}=e;a&&(d.basePath=a);let u=void 0!==e.session;d._lastSync=u?c():0;let[g,h]=s.useState(()=>(u&&(d._session=e.session),e.session)),[w,b]=s.useState(!u);s.useEffect(()=>(d._getSession=async({event:e}={})=>{try{let t="storage"===e;if(t||void 0===d._session){d._lastSync=c(),d._session=await v({broadcast:!t}),h(d._session);return}if(!e||null===d._session||c()<d._lastSync)return;d._lastSync=c(),d._session=await v(),h(d._session)}catch(e){f.error(new o(e.message,e))}finally{b(!1)}},d._getSession(),()=>{d._lastSync=0,d._session=void 0,d._getSession=()=>{}}),[]),s.useEffect(()=>{let e=()=>d._getSession({event:"storage"});return m().addEventListener("message",e),()=>m().removeEventListener("message",e)},[]),s.useEffect(()=>{let{refetchOnWindowFocus:t=!0}=e,r=()=>{t&&"visible"===document.visibilityState&&d._getSession({event:"visibilitychange"})};return document.addEventListener("visibilitychange",r,!1),()=>document.removeEventListener("visibilitychange",r,!1)},[e.refetchOnWindowFocus]);let C=function(){let[e,t]=s.useState("undefined"!=typeof navigator&&navigator.onLine),r=()=>t(!0),a=()=>t(!1);return s.useEffect(()=>(window.addEventListener("online",r),window.addEventListener("offline",a),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",a)}),[]),e}(),x=!1!==l||C;s.useEffect(()=>{if(n&&x){let e=setInterval(()=>{d._session&&d._getSession({event:"poll"})},1e3*n);return()=>clearInterval(e)}},[n,x]);let D=s.useMemo(()=>({data:g,status:w?"loading":g?"authenticated":"unauthenticated",async update(e){if(w)return;b(!0);let t=await i("session",d,f,void 0===e?void 0:{body:{csrfToken:await y(),data:e}});return b(!1),t&&(h(t),m().postMessage({event:"session",data:{trigger:"getSession"}})),t}}),[g,w]);return(0,r.jsx)(p.Provider,{value:D,children:t})}e.s(["SessionContext",0,p,"SessionProvider",()=>D,"__NEXTAUTH",0,d,"getCsrfToken",()=>y,"getProviders",()=>b,"getSession",()=>v,"signIn",()=>C,"signOut",()=>x,"useSession",()=>w],26732)},61500,e=>{"use strict";var t=e.i(43476),r=e.i(10969);let s="/api/aurora/user",a=async e=>{try{if(!e)return{status:!1,data:null,message:"ç¼ºå°‘ ID è³‡è¨Š"};console.log("[Client getUser] Fetching user with email:",e);let t=await fetch(`${s}?id=${e}`).then(e=>e.json());return console.log("[Client getUser] Response data:",t),{status:!0,data:t,message:"success"}}catch(e){return console.error("[Client getUser] Error:",e),{status:!1,data:null,message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}},n=async e=>{try{return await fetch(s,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),{status:!0,message:"success"}}catch(e){return console.error(e),{status:!1,message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}},o=async e=>{try{console.log("[Client createUser] Creating user with data:",e);let t=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();return console.log("[Client createUser] Server response:",r),{status:!0,message:"success"}}catch(e){return console.error("[Client createUser] Error:",e),{status:!1,message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}};var i=e.i(26732),l=e.i(18566),c=e.i(71645);let u=(0,c.createContext)({loading:!0,config:void 0,budgetData:{budget:[]},syncUser:()=>{},setter:async()=>{},setBudgetData:async()=>{}});e.s(["UserConfigProvider",0,({children:e})=>{let[s,d]=(0,c.useState)(),[g,h]=(0,c.useState)(!0),[m,f]=(0,c.useState)({budget:[]}),{data:p,status:w}=(0,i.useSession)(),{db:v,getUserData:y,setUserData:b}=(0,r.useIDB)(),C=(0,c.useRef)(null),x=(0,l.usePathname)(),D=(0,c.useCallback)(e=>{d(e),h(!1)},[]),S=(0,c.useCallback)(async e=>{await n(e),d(e)},[]),E=(0,c.useCallback)(async e=>{f(e)},[]),U=(0,c.useCallback)(async e=>{p?.user&&await o({user_id:Date.now(),name:p.user.name||"åŒ¿å",email:e})},[p?.user]),P=(0,c.useCallback)(e=>{a(e).then(t=>{console.log("Querying user response: ",t),C.current&&C.current.abort(),t.status&&null===t.data?(console.log("User not found, creating new user..."),U(e).then(()=>{setTimeout(()=>{P(e)},3e3)})):t.status&&null!==t.data&&(console.log("User found, updating local state..."),D(t.data),b(v,t.data).then(()=>{console.log("Update User IDB success.")}).catch(e=>{console.log("Update User IDB failed: ",e)}))}).catch(console.error)},[v,U,b,D]),N=(0,c.useCallback)(()=>{h(!0),p?.user?.email&&(console.log("Syncing user: ",p.user.email),P(p.user.email))},[P,p?.user?.email]),_=(0,c.useMemo)(()=>({loading:g,config:s,budgetData:m,syncUser:N,setter:S,setBudgetData:E}),[g,s,m,N,S,E]),R=(0,c.useCallback)(()=>{"/login"!==x&&(0,l.redirect)("/login")},[x]);return(0,c.useEffect)(()=>{"unauthenticated"===w&&R()},[w,R]),(0,c.useEffect)(()=>{console.log("[UserConfigProvider] Session status:",w),console.log("[UserConfigProvider] Session email:",p?.user?.email),console.log("[UserConfigProvider] Config exists:",!!s),"authenticated"===w&&p?.user?.email&&!s?(console.log("[UserConfigProvider] âœ… Conditions met! Syncing user..."),h(!0),P(p.user.email)):console.log("[UserConfigProvider] âŒ Conditions not met for sync")},[w,p?.user?.email,s,P]),(0,c.useEffect)(()=>{let e=C.current=new AbortController;return v&&!s&&y(v,p?.user?.email??"",e.signal).then(e=>{e&&(D(JSON.parse(e.data)),C.current=null)}).catch(e=>{console.log("Error while syncing data: ",e)}),()=>e.abort()},[v,s,y,D,p?.user?.email]),(0,t.jsx)(u.Provider,{value:_,children:e})},"useUserConfigCtx",0,()=>(0,c.useContext)(u)],61500)},76877,39997,e=>{"use strict";var t=e.i(43476);let r="/api/aurora/groups",s=async e=>{try{return await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),{status:!0,message:"success"}}catch(e){return console.error(e),{status:!1,data:[],message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}},a=async e=>{try{return await fetch(r,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),{status:!0,message:"success"}}catch(e){return console.error(e),{status:!1,data:[],message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}},n=async e=>{try{return await fetch(`${r}?id=${e}`,{method:"DELETE"}),{status:!0,message:"success"}}catch(e){return console.error(e),{status:!1,data:[],message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}},o=async e=>{try{let t=await fetch(`${r}?id=${e}`).then(e=>e.json());return{status:!0,data:t,message:"success"}}catch(e){return console.error(e),{status:!1,data:[],message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}},i=async(e,t)=>{try{return await fetch(`/api/aurora/group/member?account_id=${e}&user_id=${t}`,{method:"DELETE"}),{status:!0,message:"success"}}catch(e){return console.error(e),{status:!1,message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}},l=async e=>{try{if(!e)return{status:!1,data:[],message:"ç¼ºå°‘å¸³æœ¬ ID"};let t=await fetch(`/api/aurora/group/members?account_id=${e}`).then(e=>e.json());return{status:!0,data:t,message:"success"}}catch(e){return console.error(e),{status:!1,data:[],message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}};e.s(["createGroup",0,s,"deleteGroup",0,n,"getGroupMembers",0,l,"getGroups",0,o,"putGroup",0,a,"removeGroupMember",0,i],39997);var c=e.i(10969),u=e.i(71645);let d=(0,u.createContext)({loading:!0,currentGroup:void 0,groups:[],syncGroup:()=>{},setter:()=>{},setCurrentGroup:()=>{}});e.s(["GroupProvider",0,({children:e})=>{let[r,s]=(0,u.useState)(!0),[a,n]=(0,u.useState)([]),[i,l]=(0,u.useState)(),{db:g,getGroupData:h,setGroupData:m}=(0,c.useIDB)(),f=(0,u.useCallback)(e=>{n(e),s(!1)},[]),p=(0,u.useCallback)(async e=>{if(!g){s(!0),o(e).then(e=>{e.status&&f(e.data)}).catch(console.error);return}try{let t=await h(g,e);t?(console.log("[GroupProvider] Using cached group data"),(0,u.startTransition)(()=>{n(t),s(!1)})):s(!0)}catch(e){console.error("[GroupProvider] Error reading cache:",e),s(!0)}o(e).then(t=>{t.status&&((0,u.startTransition)(()=>{f(t.data)}),m(g,e,t.data).catch(console.error))}).catch(console.error)},[g,h,m,f]),w=(0,u.useMemo)(()=>({loading:r,groups:a,currentGroup:i,setCurrentGroup:l,syncGroup:p,setter:f}),[i,a,r,p,f]);return(0,t.jsx)(d.Provider,{value:w,children:e})},"useGroupCtx",0,()=>(0,u.useContext)(d)],76877)},77136,e=>{"use strict";var t,r=e.i(43476);let s=e=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-caret-down-fill",viewBox:"0 0 16 16",...e,children:(0,r.jsx)("path",{d:"M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"})});var a=e.i(47573),n=e.i(71645),o=((t=o||{}).Up="Up",t.Down="Down",t.Left="Left",t.Right="Right",t);let i=e=>{let{children:t,className:o="",caretStyle:i="",menuStyle:g="",onChange:h,value:m,label:f,name:p}=e,[w,v]=(0,n.useState)(!1),[y,b]=(0,n.useState)(0),[C,x]=(0,n.useState)("Down"),[D,S]=(0,n.useState)("Left"),E=(0,a.default)(()=>{v(!1)}),U=(0,n.useCallback)(()=>{let e=E.current;if(e){let t=c(e);x(t),S(u(e)),b(d(e,t))}},[E]);return(0,n.useEffect)(()=>(E.current&&(U(),window.addEventListener("scroll",U),window.addEventListener("animationend",U)),()=>{window.removeEventListener("scroll",U),window.removeEventListener("animationend",U)}),[E,U]),(0,r.jsxs)(l.Provider,{value:{onChange:h,value:m,close:()=>v(!1)},children:[(0,r.jsxs)("div",{ref:E,className:"relative w-full",children:[(0,r.jsxs)("button",{className:`${o} flex items-center justify-between gap-1`,type:"button",onClick:()=>v(e=>!e),children:[(f||m)&&(0,r.jsx)("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:f??m}),(0,r.jsx)(s,{className:`size-2 shrink-0 ${i}`})]}),(0,r.jsx)("div",{className:`${"Down"===C?"top-full mt-1":"bottom-full mb-1"} ${"Left"===D?"right-0":"left-0"} bg-background absolute z-40 w-fit overflow-hidden rounded-lg border border-solid border-gray-300 py-2 shadow transition-all ${w?"visible opacity-100":"invisible opacity-0"}`,style:{minWidth:(E.current?.clientWidth??0)-8+"px",maxHeight:y+"px"},children:(0,r.jsx)("div",{className:`${g} scrollbar flex h-full w-full flex-col overflow-x-hidden overflow-y-auto`,style:{maxHeight:y-8+"px"},children:t})})]}),(0,r.jsx)("input",{value:m,name:p,className:"hidden",readOnly:!0})]})},l=(0,n.createContext)({onChange:()=>{},value:void 0,close:()=>{}});i.Item=({className:e="",value:t,children:s})=>{let{value:a,onChange:o,close:i}=(0,n.useContext)(l);return(0,r.jsx)("button",{type:"button",onClick:()=>{o(t),i()},className:`flex w-full px-4 py-2 transition-colors ${e} ${a===t?"bg-primary-100":"hover:bg-primary-100"}`,children:(0,r.jsx)("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:s})})};let c=e=>{let t=e.getBoundingClientRect().bottom-e.getBoundingClientRect().top;return e.getBoundingClientRect().top<(window.innerHeight-t)/2?"Down":"Up"},u=e=>{let t=e.getBoundingClientRect().right-e.getBoundingClientRect().left;return e.getBoundingClientRect().left<(window.innerWidth-t)/2?"Right":"Left"},d=(e,t)=>"Down"===t?window.innerHeight-e.getBoundingClientRect().bottom-24:e.getBoundingClientRect().top-24;e.s(["Select",0,i],77136)},46526,e=>{"use strict";var t=e.i(43476),r=e.i(26732),s=e.i(71645);let a=(0,s.createContext)({date:new Date,setDate:()=>{}});e.s(["DateProvider",0,({children:e})=>{let[n,o]=(e=>{let{data:t}=(0,r.useSession)(),[a,n]=(0,s.useState)(e??new Date),o=(0,s.useRef)(e??new Date);return(0,s.useEffect)(()=>{o.current.getDate()!==new Date().getDate()&&(n(new Date),o.current=new Date)},[t]),[a,n]})(new Date),i=(0,s.useMemo)(()=>({date:n,setDate:o}),[n,o]);return(0,t.jsx)(a.Provider,{value:i,children:e})},"useDateCtx",0,()=>(0,s.useContext)(a)],46526)},98454,e=>{"use strict";var t=e.i(43476);let r="/api/aurora/favorite-categories",s=async e=>{try{if(!e)return{status:!1,data:null,message:"ç¼ºå°‘ä½¿ç”¨è€… ID"};let t=await fetch(`${r}?owner_id=${e}`).then(e=>e.json());return{status:!0,data:t,message:"success"}}catch(e){return console.error(e),{status:!1,data:null,message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}},a=async e=>{try{let t=await fetch(r,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json());return{status:!0,data:t,message:"success"}}catch(e){return console.error(e),{status:!1,message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}},n={"ðŸ”":"food","ðŸ‘—":"clothing","ðŸ ":"housing","ðŸš—":"transportation","ðŸ“š":"education","ðŸŽ²":"entertainment","ðŸ§»":"daily","ðŸ’Š":"medical","ðŸ“‰":"investment","ðŸ“ˆ":"investment","ðŸ’°":"salary","ðŸŽ":"bonus","âœ¨":"other"};function o(e,t){if(!e)return[];let r=n[t];if(!r)return[];let s=e[r];return s&&""!==s.trim()?s.split(",").map(e=>e.trim()).filter(e=>""!==e):[]}function i(e,t,r){let s=n[t];if(!s)throw Error("ç„¡æ•ˆçš„é¡žåˆ¥");return{...e,[s]:r.join(",")}}var l=e.i(71645);let c=(0,l.createContext)({loading:!0,favorites:null,syncFavorites:()=>{},updateFavorites:async()=>{},getCategoryDescriptions:()=>[],addCategoryDescription:async()=>{},removeCategoryDescription:async()=>{}});e.s(["FavoriteCategoriesProvider",0,({children:e})=>{let[r,n]=(0,l.useState)(!0),[u,d]=(0,l.useState)(null),g=(0,l.useCallback)(e=>{d(e),n(!1)},[]),h=(0,l.useCallback)(e=>{n(!0),s(e).then(e=>{e.status?g(e.data):g(null)}).catch(e=>{console.error(e),g(null)})},[g]),m=(0,l.useCallback)(async e=>{n(!0);let t=await a(e);t.status&&t.data?g(t.data):n(!1)},[g]),f=(0,l.useCallback)(e=>o(u,e),[u]),p=(0,l.useCallback)(async(e,t,r)=>{let s=o(u,e);if(s.includes(t))return;let a=i(u,e,[...s,t]);await m({owner_id:r,...a})},[u,m]),w=(0,l.useCallback)(async(e,t,r)=>{let s=o(u,e).filter(e=>e!==t),a=i(u,e,s);await m({owner_id:r,...a})},[u,m]),v=(0,l.useMemo)(()=>({loading:r,favorites:u,syncFavorites:h,updateFavorites:m,getCategoryDescriptions:f,addCategoryDescription:p,removeCategoryDescription:w}),[r,u,h,m,f,p,w]);return(0,t.jsx)(c.Provider,{value:v,children:e})},"useFavoriteCategoriesCtx",0,()=>(0,l.useContext)(c)],98454)}]);