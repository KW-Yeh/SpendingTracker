(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,73886,e=>{"use strict";e.s(["normalizeNumber",0,e=>{let t=Math.floor(e).toString(),s=[],r=t.split("").reverse(),l=0;return r.forEach(e=>{0!==l&&l%3==0&&s.push(","),s.push(e),l++}),s.toReversed().join("")}])},14491,e=>{"use strict";let t={50:"hsl(270, 50%, 98%)",100:"hsl(270, 50%, 95%)",200:"hsl(270, 50%, 85%)",300:"hsl(270, 50%, 70%)",400:"hsl(270, 50%, 55%)",500:"hsl(270, 50%, 40%)",600:"hsl(270, 50%, 32%)",700:"hsl(270, 50%, 24%)",800:"hsl(270, 50%, 16%)",900:"hsl(270, 50%, 10%)"},s={100:"hsl(150, 40%, 95%)",500:"hsl(150, 40%, 55%)"},r={100:"hsl(20, 80%, 95%)",500:"hsl(20, 80%, 70%)"},l={100:"hsl(0, 0%, 95%)",200:"hsl(0, 0%, 80%)",300:"hsl(0, 0%, 70%)",400:"hsl(0, 0%, 60%)",500:"hsl(0, 0%, 50%)",600:"hsl(0, 0%, 40%)",700:"hsl(0, 0%, 30%)",800:"hsl(0, 0%, 20%)",900:"hsl(0, 0%, 10%)"};s[500],s[100],r[500],r[100],t[500],t[100],l[200],l[100],e.s(["CHART_COLORS",0,{INCOME_PRIMARY:"hsl(150, 40%, 55%)",INCOME_NECESSARY:"hsl(150, 50%, 65%)",INCOME_UNNECESSARY:"hsl(150, 30%, 75%)",OUTCOME_PRIMARY:"hsl(20, 80%, 70%)",OUTCOME_NECESSARY:"hsl(20, 70%, 75%)",OUTCOME_UNNECESSARY:"hsl(20, 60%, 85%)",NEUTRAL:"hsl(0, 0%, 80%)"},"GRAY_COLORS",0,l,"PRIMARY_COLORS",0,t])},3995,e=>{"use strict";var t=e.i(43476);e.s(["CalendarIcon",0,e=>(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-calendar-event",viewBox:"0 0 16 16",...e,children:[(0,t.jsx)("path",{d:"M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"}),(0,t.jsx)("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"})]})])},40141,e=>{"use strict";var t=e.i(71645),s={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},r=t.default.createContext&&t.default.createContext(s),l=["attr","size","title"];function a(){return(a=Object.assign.bind()).apply(this,arguments)}function n(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function o(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?n(Object(s),!0).forEach(function(t){var r,l,a;r=e,l=t,a=s[t],(l=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(l))in r?Object.defineProperty(r,l,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[l]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):n(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function i(e){return s=>t.default.createElement(c,a({attr:o({},e.attr)},s),function e(s){return s&&s.map((s,r)=>t.default.createElement(s.tag,o({key:r},s.attr),e(s.child)))}(e.child))}function c(e){var n=s=>{var r,{attr:n,size:i,title:c}=e,u=function(e,t){if(null==e)return{};var s,r,l=function(e,t){if(null==e)return{};var s={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;s[r]=e[r]}return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)s=a[r],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(l[s]=e[s])}return l}(e,l),d=i||s.size||"1em";return s.className&&(r=s.className),e.className&&(r=(r?r+" ":"")+e.className),t.default.createElement("svg",a({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,n,u,{className:r,style:o(o({color:e.color||s.color},s.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),c&&t.default.createElement("title",null,c),e.children)};return void 0!==r?t.default.createElement(r.Consumer,null,e=>n(e)):n(s)}e.s(["GenIcon",()=>i],40141)},10788,e=>{"use strict";var t=e.i(71645);e.s(["useScrollToTop",0,()=>{(0,t.useEffect)(()=>{window.scrollTo(0,0)},[])}])},67585,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"BailoutToCSR",{enumerable:!0,get:function(){return l}});let r=e.r(32061);function l({reason:e,children:t}){if("undefined"==typeof window)throw Object.defineProperty(new r.BailoutToCSRError(e),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return t}},9885,(e,t,s)=>{"use strict";function r(e){return e.split("/").map(e=>encodeURIComponent(e)).join("/")}Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"encodeURIPath",{enumerable:!0,get:function(){return r}})},52157,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"PreloadChunks",{enumerable:!0,get:function(){return o}});let r=e.r(43476),l=e.r(74080),a=e.r(63599),n=e.r(9885);function o({moduleIds:e}){if("undefined"!=typeof window)return null;let t=a.workAsyncStorage.getStore();if(void 0===t)return null;let s=[];if(t.reactLoadableManifest&&e){let r=t.reactLoadableManifest;for(let t of e){if(!r[t])continue;let e=r[t].files;s.push(...e)}}return 0===s.length?null:(0,r.jsx)(r.Fragment,{children:s.map(e=>{let s=`${t.assetPrefix}/_next/${(0,n.encodeURIPath)(e)}`;return e.endsWith(".css")?(0,r.jsx)("link",{precedence:"dynamic",href:s,rel:"stylesheet",as:"style",nonce:t.nonce},e):((0,l.preload)(s,{as:"script",fetchPriority:"low",nonce:t.nonce}),null)})})}},69093,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return c}});let r=e.r(43476),l=e.r(71645),a=e.r(67585),n=e.r(52157);function o(e){return{default:e&&"default"in e?e.default:e}}let i={loader:()=>Promise.resolve(o(()=>null)),loading:null,ssr:!0},c=function(e){let t={...i,...e},s=(0,l.lazy)(()=>t.loader().then(o)),c=t.loading;function u(e){let o=c?(0,r.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,i=!t.ssr||!!t.loading,u=i?l.Suspense:l.Fragment,d=t.ssr?(0,r.jsxs)(r.Fragment,{children:["undefined"==typeof window?(0,r.jsx)(n.PreloadChunks,{moduleIds:t.modules}):null,(0,r.jsx)(s,{...e})]}):(0,r.jsx)(a.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(s,{...e})});return(0,r.jsx)(u,{...i?{fallback:o}:{},children:d})}return u.displayName="LoadableComponent",u}},70703,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return l}});let r=e.r(55682)._(e.r(69093));function l(e,t){let s={};"function"==typeof e&&(s.loader=e);let l={...s,...t};return(0,r.default)({...l,modules:l.loadableGenerated?.modules})}("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),t.exports=s.default)},76814,e=>{"use strict";var t=e.i(43476);let s=({title:e,children:s})=>(0,t.jsxs)("div",{className:"relative flex w-full flex-col items-center rounded-xl bg-white p-6 shadow-md transition-all hover:shadow-lg z-10",children:[(0,t.jsx)("div",{className:"mb-4 w-full",children:(0,t.jsxs)("h2",{className:"relative inline-block text-xl font-bold text-gray-800 select-none",children:[e,(0,t.jsx)("span",{className:"absolute -bottom-1 left-0 h-1 w-1/2 rounded-full bg-primary-300"})]})}),s]});var r=e.i(86780),l=e.i(76877),a=e.i(26383),n=e.i(61500),o=e.i(10788),i=e.i(96133),c=e.i(6705),u=e.i(14491);let d=new Map(c.INCOME_TYPE_MAP.map(e=>[e.value,e.label])),m=new Map(c.OUTCOME_TYPE_MAP.map(e=>[e.value,e.label])),f=(e,t,s,r,l)=>{let a=[],n=[],o=[];return e.forEach(({label:e})=>{let i=t.get(e)??h();a.push({id:e,name:e,value:i.total,necessary:i.necessary,unnecessary:i.unnecessary,color:s}),n.push({name:e,value:i.necessaryList.reduce((e,t)=>e+t,0),color:r}),o.push({name:e,value:i.unnecessaryList.reduce((e,t)=>e+t,0),color:l})}),{results:a,necessaryList:n,unnecessaryList:o}},h=()=>({necessary:0,unnecessary:0,necessaryList:[],unnecessaryList:[],total:0});var y=e.i(75329),p=e.i(70703),b=e.i(71645),g=e.i(73886);let x=({title:e,total:s,list:r,options:l={headerStyle:"bg-gray-200"}})=>(0,t.jsxs)("div",{className:"flex w-full flex-col gap-2 whitespace-nowrap",children:[(0,t.jsx)("h3",{className:"font-semibold",children:e}),(0,t.jsxs)("table",{className:"w-full border-collapse text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:l.headerStyle,children:[(0,t.jsx)("th",{className:"border border-solid border-gray-300 border-r-transparent px-2 py-1 text-center",children:"類型"}),(0,t.jsx)("th",{className:"border border-solid border-gray-300 border-r-transparent px-2 py-1 text-right",children:"比例 (%)"}),(0,t.jsx)("th",{className:"border border-solid border-gray-300 px-2 py-1 text-right",children:"金額 (NTD)"})]})}),(0,t.jsx)("tbody",{children:r.map(e=>(0,t.jsxs)("tr",{className:0===e.value?"text-gray-300":"",children:[(0,t.jsx)("td",{className:"col-span-1 border border-solid border-gray-300 p-2 text-center",children:e.name}),(0,t.jsxs)("td",{className:"col-span-1 border border-solid border-gray-300 p-2 text-end",children:[0===e.value?0:(Math.round(e.value/s*100)||0).toFixed(0),"%"]}),(0,t.jsxs)("td",{className:"col-span-2 border border-solid border-gray-300 p-2 text-end",children:["$",(0,g.normalizeNumber)(e.value)]})]},`income-${e.name}`))})]})]}),j=c.OUTCOME_TYPE_MAP.map(({label:e})=>({name:e,value:0})),O=c.INCOME_TYPE_MAP.map(({label:e})=>({name:e,value:0})),v=e=>{let[s,r]=(0,b.useState)(j),[l,a]=(0,b.useState)(O),n=(0,b.useMemo)(()=>e.totalIncome+e.totalOutcome,[e.totalIncome,e.totalOutcome]),o=(0,b.useMemo)(()=>100*e.totalOutcome/(n||100),[e.totalOutcome,n]),i=(0,b.useMemo)(()=>100*e.totalIncome/(n||100),[e.totalIncome,n]);return(0,b.useEffect)(()=>{e.outcomeList.length>0&&r(t=>t.map((t,s)=>({...t,value:e.outcomeList[s].value})))},[e.outcomeList]),(0,b.useEffect)(()=>{e.incomeList.length>0&&a(t=>t.map((t,s)=>({...t,value:e.incomeList[s].value})))},[e.incomeList]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x,{title:`支出各項資訊 $${(0,g.normalizeNumber)(e.totalOutcome)}（${o.toFixed(0)}%）`,total:e.totalOutcome,list:s,options:{headerStyle:"bg-red-500/30"}}),(0,t.jsx)(x,{title:`收入各項資訊 $${(0,g.normalizeNumber)(e.totalIncome)}（${i.toFixed(0)}%）`,total:e.totalIncome,list:l,options:{headerStyle:"bg-green-500/30"}})]})},N=c.OUTCOME_TYPE_MAP.map(({label:e})=>({name:e,value:0})),C=e=>{let[s,r]=(0,b.useState)(N),[l,a]=(0,b.useState)(N),n=(0,b.useMemo)(()=>e.totalNecessary+e.totalUnnecessary,[e.totalNecessary,e.totalUnnecessary]),o=(0,b.useMemo)(()=>100*e.totalUnnecessary/(n||100),[e.totalUnnecessary,n]),i=(0,b.useMemo)(()=>100*e.totalNecessary/(n||100),[e.totalNecessary,n]);return(0,b.useEffect)(()=>{e.unnecessaryList.length>0&&a(t=>t.map((t,s)=>({...t,value:e.unnecessaryList[s].value})))},[e.unnecessaryList]),(0,b.useEffect)(()=>{e.necessaryList.length>0&&r(t=>t.map((t,s)=>({...t,value:e.necessaryList[s].value})))},[e.necessaryList]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x,{title:`必要支出各項資訊 $${(0,g.normalizeNumber)(e.totalNecessary)}（${i.toFixed(0)}%）`,total:e.totalNecessary,list:s,options:{headerStyle:"bg-orange-500/30"}}),(0,t.jsx)(x,{title:`額外支出各項資訊 $${(0,g.normalizeNumber)(e.totalUnnecessary)}（${o.toFixed(0)}%）`,total:e.totalUnnecessary,list:l,options:{headerStyle:"bg-gray-500/30"}})]})},E=(0,p.default)(()=>e.A(92760),{loadableGenerated:{modules:[50790]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"mx-auto mt-15 aspect-square size-45 rounded-full bg-gray-200 p-1.5",children:(0,t.jsx)("div",{className:"bg-background size-full rounded-full p-1.5",children:(0,t.jsx)("div",{className:"size-full rounded-full bg-gray-200 p-5",children:(0,t.jsx)("div",{className:"bg-background size-full rounded-full"})})})})}),w=(0,p.default)(()=>e.A(35879),{loadableGenerated:{modules:[75689]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"mx-auto mt-15 aspect-square size-45 rounded-full bg-gray-200 p-1.5",children:(0,t.jsx)("div",{className:"bg-background size-full rounded-full p-1.5",children:(0,t.jsx)("div",{className:"size-full rounded-full bg-gray-200 p-5",children:(0,t.jsx)("div",{className:"bg-background size-full rounded-full"})})})})});e.s(["ChartBlock",0,()=>{(0,o.useScrollToTop)();let{config:e}=(0,n.useUserConfigCtx)(),{data:p,syncData:g}=(0,a.useGetSpendingCtx)(),{currentGroup:x}=(0,l.useGroupCtx)(),j=new Date,O=(0,i.useYearMonth)(j),N=(0,b.useCallback)((t,s,r)=>{let{startDate:l,endDate:a}=(0,y.getStartEndOfMonth)(new Date(Number(s),Number(r)-1));g(t,e?.email,l.toISOString(),a.toISOString())},[g,e?.email]),M=(0,b.useMemo)(()=>(e=>{var t;let s,r,l,a,n,o,i,y,{incomeResult:p,totalIncome:b,necessaryIncome:g,unnecessaryIncome:x,outcomeResult:j,totalOutcome:O,necessaryOutcome:v,unnecessaryOutcome:N}=(t=e,s=new Map,r=0,l=0,a=0,n=new Map,o=0,i=0,y=0,t.forEach(e=>{let t=Number(e.amount),u=e.necessity===c.Necessity.Need;if(e.type===c.SpendingType.Income){let n=d.get(e.category);if(n){r+=t;let e=s.get(n);e||(e=h(),s.set(n,e)),e.total+=t,u?(l+=t,e.necessary+=t,e.necessaryList.push(t)):(a+=t,e.unnecessary+=t,e.unnecessaryList.push(t))}}else{let s=m.get(e.category);if(s){o+=t;let e=n.get(s);e||(e=h(),n.set(s,e)),e.total+=t,u?(i+=t,e.necessary+=t,e.necessaryList.push(t)):(y+=t,e.unnecessary+=t,e.unnecessaryList.push(t))}}}),{incomeResult:s,totalIncome:r,necessaryIncome:l,unnecessaryIncome:a,outcomeResult:n,totalOutcome:o,necessaryOutcome:i,unnecessaryOutcome:y}),{results:C,necessaryList:E,unnecessaryList:w}=f(c.INCOME_TYPE_MAP,p,u.CHART_COLORS.INCOME_PRIMARY,u.CHART_COLORS.INCOME_NECESSARY,u.CHART_COLORS.NEUTRAL),{results:M,necessaryList:P,unnecessaryList:S}=f(c.OUTCOME_TYPE_MAP,j,u.CHART_COLORS.OUTCOME_PRIMARY,u.CHART_COLORS.OUTCOME_NECESSARY,u.CHART_COLORS.NEUTRAL);return{income:{total:b,necessary:g,unnecessary:x,necessaryList:E,unnecessaryList:w,list:C},outcome:{total:O,necessary:v,unnecessary:N,necessaryList:P,unnecessaryList:S,list:M}}})(p.filter(e=>`${new Date(e.date).getFullYear()}`===O.year&&`${new Date(e.date).getMonth()+1}`===O.month)),[p,O.year,O.month]);return(0,t.jsxs)("div",{className:"content-wrapper",children:[(0,t.jsx)(r.YearMonthFilter,{refreshData:N,group:x,dateOptions:O,className:"flex self-center rounded-lg border border-gray-200 bg-white p-2 text-base shadow-sm"}),(0,t.jsxs)("div",{className:"flex w-full flex-col items-center gap-8 md:flex-row md:items-start",children:[(0,t.jsx)(s,{title:"收支類別比例",children:(0,t.jsxs)("div",{className:"flex w-full flex-wrap justify-center gap-4",children:[(0,t.jsx)("div",{className:"size-75",children:(0,t.jsx)(E,{totalIncome:M.income.total,totalOutcome:M.outcome.total,list:[...M.outcome.list,...M.income.list]})}),(0,t.jsx)("div",{className:"flex flex-1 flex-col gap-4",children:(0,t.jsx)(v,{totalIncome:M.income.total,totalOutcome:M.outcome.total,incomeList:M.income.list,outcomeList:M.outcome.list})})]})}),(0,t.jsx)(s,{title:"支出類別比例（必要 vs 額外）",children:(0,t.jsxs)("div",{className:"flex w-full flex-wrap justify-center gap-4",children:[(0,t.jsx)("div",{className:"size-75",children:(0,t.jsx)(w,{totalNecessity:M.outcome.necessary,totalUnnecessity:M.outcome.unnecessary,list:[...M.outcome.necessaryList,...M.outcome.unnecessaryList]})}),(0,t.jsx)("div",{className:"flex flex-1 flex-col gap-4",children:(0,t.jsx)(C,{totalNecessary:M.outcome.necessary,totalUnnecessary:M.outcome.unnecessary,necessaryList:M.outcome.necessaryList,unnecessaryList:M.outcome.unnecessaryList})})]})})]})]})}],76814)},92760,e=>{e.v(t=>Promise.all(["static/chunks/5054840b4b7a1bd6.js","static/chunks/042b4b5cbe281748.js","static/chunks/8007746fd0e61649.js"].map(t=>e.l(t))).then(()=>t(50790)))},35879,e=>{e.v(t=>Promise.all(["static/chunks/d90bdc4c22840e57.js","static/chunks/042b4b5cbe281748.js","static/chunks/8007746fd0e61649.js"].map(t=>e.l(t))).then(()=>t(75689)))}]);