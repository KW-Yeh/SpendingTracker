(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,73886,e=>{"use strict";e.s(["normalizeNumber",0,e=>{let t=Math.floor(e).toString(),s=[],r=t.split("").reverse(),a=0;return r.forEach(e=>{0!==a&&a%3==0&&s.push(","),s.push(e),a++}),s.toReversed().join("")}])},3995,e=>{"use strict";var t=e.i(43476);e.s(["CalendarIcon",0,e=>(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-calendar-event",viewBox:"0 0 16 16",...e,children:[(0,t.jsx)("path",{d:"M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"}),(0,t.jsx)("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"})]})])},40141,e=>{"use strict";var t=e.i(71645),s={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},r=t.default.createContext&&t.default.createContext(s),a=["attr","size","title"];function n(){return(n=Object.assign.bind()).apply(this,arguments)}function l(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function o(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?l(Object(s),!0).forEach(function(t){var r,a,n;r=e,a=t,n=s[t],(a=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(a))in r?Object.defineProperty(r,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[a]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function c(e){return s=>t.default.createElement(i,n({attr:o({},e.attr)},s),function e(s){return s&&s.map((s,r)=>t.default.createElement(s.tag,o({key:r},s.attr),e(s.child)))}(e.child))}function i(e){var l=s=>{var r,{attr:l,size:c,title:i}=e,u=function(e,t){if(null==e)return{};var s,r,a=function(e,t){if(null==e)return{};var s={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;s[r]=e[r]}return s}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)s=n[r],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,a),d=c||s.size||"1em";return s.className&&(r=s.className),e.className&&(r=(r?r+" ":"")+e.className),t.default.createElement("svg",n({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,l,u,{className:r,style:o(o({color:e.color||s.color},s.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),i&&t.default.createElement("title",null,i),e.children)};return void 0!==r?t.default.createElement(r.Consumer,null,e=>l(e)):l(s)}e.s(["GenIcon",()=>c],40141)},10788,e=>{"use strict";var t=e.i(71645);e.s(["useScrollToTop",0,()=>{(0,t.useEffect)(()=>{window.scrollTo(0,0)},[])}])},67585,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"BailoutToCSR",{enumerable:!0,get:function(){return a}});let r=e.r(32061);function a({reason:e,children:t}){if("undefined"==typeof window)throw Object.defineProperty(new r.BailoutToCSRError(e),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return t}},9885,(e,t,s)=>{"use strict";function r(e){return e.split("/").map(e=>encodeURIComponent(e)).join("/")}Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"encodeURIPath",{enumerable:!0,get:function(){return r}})},52157,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"PreloadChunks",{enumerable:!0,get:function(){return o}});let r=e.r(43476),a=e.r(74080),n=e.r(63599),l=e.r(9885);function o({moduleIds:e}){if("undefined"!=typeof window)return null;let t=n.workAsyncStorage.getStore();if(void 0===t)return null;let s=[];if(t.reactLoadableManifest&&e){let r=t.reactLoadableManifest;for(let t of e){if(!r[t])continue;let e=r[t].files;s.push(...e)}}return 0===s.length?null:(0,r.jsx)(r.Fragment,{children:s.map(e=>{let s=`${t.assetPrefix}/_next/${(0,l.encodeURIPath)(e)}`;return e.endsWith(".css")?(0,r.jsx)("link",{precedence:"dynamic",href:s,rel:"stylesheet",as:"style",nonce:t.nonce},e):((0,a.preload)(s,{as:"script",fetchPriority:"low",nonce:t.nonce}),null)})})}},69093,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return i}});let r=e.r(43476),a=e.r(71645),n=e.r(67585),l=e.r(52157);function o(e){return{default:e&&"default"in e?e.default:e}}let c={loader:()=>Promise.resolve(o(()=>null)),loading:null,ssr:!0},i=function(e){let t={...c,...e},s=(0,a.lazy)(()=>t.loader().then(o)),i=t.loading;function u(e){let o=i?(0,r.jsx)(i,{isLoading:!0,pastDelay:!0,error:null}):null,c=!t.ssr||!!t.loading,u=c?a.Suspense:a.Fragment,d=t.ssr?(0,r.jsxs)(r.Fragment,{children:["undefined"==typeof window?(0,r.jsx)(l.PreloadChunks,{moduleIds:t.modules}):null,(0,r.jsx)(s,{...e})]}):(0,r.jsx)(n.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(s,{...e})});return(0,r.jsx)(u,{...c?{fallback:o}:{},children:d})}return u.displayName="LoadableComponent",u}},70703,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return a}});let r=e.r(55682)._(e.r(69093));function a(e,t){let s={};"function"==typeof e&&(s.loader=e);let a={...s,...t};return(0,r.default)({...a,modules:a.loadableGenerated?.modules})}("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),t.exports=s.default)},76814,e=>{"use strict";var t=e.i(43476);let s=({title:e,children:s})=>(0,t.jsxs)("div",{className:"relative flex w-full flex-col items-center rounded-xl bg-white p-6 shadow-md transition-all hover:shadow-lg z-10",children:[(0,t.jsx)("div",{className:"mb-4 w-full",children:(0,t.jsxs)("h2",{className:"relative inline-block text-xl font-bold text-gray-800 select-none",children:[e,(0,t.jsx)("span",{className:"absolute -bottom-1 left-0 h-1 w-1/2 rounded-full bg-primary-300"})]})}),s]});var r=e.i(86780),a=e.i(76877),n=e.i(26383),l=e.i(61500),o=e.i(10788),c=e.i(96133),i=e.i(6705);let u=(e,t,s,r,a)=>{let n=[],l=[],o=[];return e.forEach(({label:e})=>{let c=t.get(e)??d();n.push({id:e,name:e,value:c.total,necessary:c.necessary,unnecessary:c.unnecessary,color:s}),l.push({name:e,value:c.necessaryList.reduce((e,t)=>e+t,0),color:r}),o.push({name:e,value:c.unnecessaryList.reduce((e,t)=>e+t,0),color:a})}),{results:n,necessaryList:l,unnecessaryList:o}},d=()=>({necessary:0,unnecessary:0,necessaryList:[],unnecessaryList:[],total:0});var m=e.i(75329),f=e.i(70703),y=e.i(71645),b=e.i(73886);let p=({title:e,total:s,list:r,options:a={headerStyle:"bg-gray-200"}})=>(0,t.jsxs)("div",{className:"flex w-full flex-col gap-2 whitespace-nowrap",children:[(0,t.jsx)("h3",{className:"font-semibold",children:e}),(0,t.jsxs)("table",{className:"w-full border-collapse text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:a.headerStyle,children:[(0,t.jsx)("th",{className:"border border-solid border-gray-300 border-r-transparent px-2 py-1 text-center",children:"類型"}),(0,t.jsx)("th",{className:"border border-solid border-gray-300 border-r-transparent px-2 py-1 text-right",children:"比例 (%)"}),(0,t.jsx)("th",{className:"border border-solid border-gray-300 px-2 py-1 text-right",children:"金額 (NTD)"})]})}),(0,t.jsx)("tbody",{children:r.map(e=>(0,t.jsxs)("tr",{className:0===e.value?"text-gray-300":"",children:[(0,t.jsx)("td",{className:"col-span-1 border border-solid border-gray-300 p-2 text-center",children:e.name}),(0,t.jsxs)("td",{className:"col-span-1 border border-solid border-gray-300 p-2 text-end",children:[0===e.value?0:(Math.round(e.value/s*100)||0).toFixed(0),"%"]}),(0,t.jsxs)("td",{className:"col-span-2 border border-solid border-gray-300 p-2 text-end",children:["$",(0,b.normalizeNumber)(e.value)]})]},`income-${e.name}`))})]})]}),h=i.OUTCOME_TYPE_MAP.map(({label:e})=>({name:e,value:0})),g=i.INCOME_TYPE_MAP.map(({label:e})=>({name:e,value:0})),x=e=>{let[s,r]=(0,y.useState)(h),[a,n]=(0,y.useState)(g),l=(0,y.useMemo)(()=>e.totalIncome+e.totalOutcome,[e.totalIncome,e.totalOutcome]),o=(0,y.useMemo)(()=>100*e.totalOutcome/(l||100),[e.totalOutcome,l]),c=(0,y.useMemo)(()=>100*e.totalIncome/(l||100),[e.totalIncome,l]);return(0,y.useEffect)(()=>{e.outcomeList.length>0&&r(t=>t.map((t,s)=>({...t,value:e.outcomeList[s].value})))},[e.outcomeList]),(0,y.useEffect)(()=>{e.incomeList.length>0&&n(t=>t.map((t,s)=>({...t,value:e.incomeList[s].value})))},[e.incomeList]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p,{title:`支出各項資訊 $${(0,b.normalizeNumber)(e.totalOutcome)}（${o.toFixed(0)}%）`,total:e.totalOutcome,list:s,options:{headerStyle:"bg-red-500/30"}}),(0,t.jsx)(p,{title:`收入各項資訊 $${(0,b.normalizeNumber)(e.totalIncome)}（${c.toFixed(0)}%）`,total:e.totalIncome,list:a,options:{headerStyle:"bg-green-500/30"}})]})},j=i.OUTCOME_TYPE_MAP.map(({label:e})=>({name:e,value:0})),v=e=>{let[s,r]=(0,y.useState)(j),[a,n]=(0,y.useState)(j),l=(0,y.useMemo)(()=>e.totalNecessary+e.totalUnnecessary,[e.totalNecessary,e.totalUnnecessary]),o=(0,y.useMemo)(()=>100*e.totalUnnecessary/(l||100),[e.totalUnnecessary,l]),c=(0,y.useMemo)(()=>100*e.totalNecessary/(l||100),[e.totalNecessary,l]);return(0,y.useEffect)(()=>{e.unnecessaryList.length>0&&n(t=>t.map((t,s)=>({...t,value:e.unnecessaryList[s].value})))},[e.unnecessaryList]),(0,y.useEffect)(()=>{e.necessaryList.length>0&&r(t=>t.map((t,s)=>({...t,value:e.necessaryList[s].value})))},[e.necessaryList]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p,{title:`必要支出各項資訊 $${(0,b.normalizeNumber)(e.totalNecessary)}（${c.toFixed(0)}%）`,total:e.totalNecessary,list:s,options:{headerStyle:"bg-orange-500/30"}}),(0,t.jsx)(p,{title:`額外支出各項資訊 $${(0,b.normalizeNumber)(e.totalUnnecessary)}（${o.toFixed(0)}%）`,total:e.totalUnnecessary,list:a,options:{headerStyle:"bg-gray-500/30"}})]})},N=(0,f.default)(()=>e.A(92760),{loadableGenerated:{modules:[50790]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"mx-auto mt-15 aspect-square size-45 rounded-full bg-gray-200 p-1.5",children:(0,t.jsx)("div",{className:"bg-background size-full rounded-full p-1.5",children:(0,t.jsx)("div",{className:"size-full rounded-full bg-gray-200 p-5",children:(0,t.jsx)("div",{className:"bg-background size-full rounded-full"})})})})}),O=(0,f.default)(()=>e.A(35879),{loadableGenerated:{modules:[75689]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"mx-auto mt-15 aspect-square size-45 rounded-full bg-gray-200 p-1.5",children:(0,t.jsx)("div",{className:"bg-background size-full rounded-full p-1.5",children:(0,t.jsx)("div",{className:"size-full rounded-full bg-gray-200 p-5",children:(0,t.jsx)("div",{className:"bg-background size-full rounded-full"})})})})});e.s(["ChartBlock",0,()=>{(0,o.useScrollToTop)();let{config:e}=(0,l.useUserConfigCtx)(),{data:f,syncData:b}=(0,n.useGetSpendingCtx)(),{currentGroup:p}=(0,a.useGroupCtx)(),[h,g]=(0,y.useState)({income:{list:[],total:100,necessary:50,unnecessary:50,necessaryList:[],unnecessaryList:[]},outcome:{list:[],total:50,necessary:25,unnecessary:25,necessaryList:[],unnecessaryList:[]}}),j=new Date,w=(0,c.useYearMonth)(j),P=(0,y.useCallback)((t,s,r)=>{let{startDate:a,endDate:n}=(0,m.getStartEndOfMonth)(new Date(Number(s),Number(r)-1));b(t,e?.email,a.toISOString(),n.toISOString())},[b,e?.email]);return(0,y.useEffect)(()=>{(0,y.startTransition)(()=>{g((e=>{var t;let s,r,a,n,l,o,c,m,{incomeResult:f,totalIncome:y,necessaryIncome:b,unnecessaryIncome:p,outcomeResult:h,totalOutcome:g,necessaryOutcome:x,unnecessaryOutcome:j}=(t=e,s=new Map,r=0,a=0,n=0,l=new Map,o=0,c=0,m=0,t.forEach(e=>{if(e.type===i.SpendingType.Income){let t=i.INCOME_TYPE_MAP.find(t=>t.value===e.category);if(t){r+=Number(e.amount);let l=s.get(t.label)??d();e.necessity===i.Necessity.Need?(a+=Number(e.amount),l={...l,necessary:l.necessary+Number(e.amount),necessaryList:[...l.necessaryList,Number(e.amount)]}):(n+=Number(e.amount),l={...l,unnecessary:l.unnecessary+Number(e.amount),unnecessaryList:[...l.unnecessaryList,Number(e.amount)]}),s.set(t.label,{...l,total:l.total+Number(e.amount)})}}else{let t=i.OUTCOME_TYPE_MAP.find(t=>t.value===e.category);if(t){o+=Number(e.amount);let s=l.get(t.label)??d();e.necessity===i.Necessity.Need?(c+=Number(e.amount),s={...s,necessary:s.necessary+Number(e.amount),necessaryList:[...s.necessaryList,Number(e.amount)]}):(m+=Number(e.amount),s={...s,unnecessary:s.unnecessary+Number(e.amount),unnecessaryList:[...s.unnecessaryList,Number(e.amount)]}),l.set(t.label,{...s,total:s.total+Number(e.amount)})}}}),{incomeResult:s,totalIncome:r,necessaryIncome:a,unnecessaryIncome:n,outcomeResult:l,totalOutcome:o,necessaryOutcome:c,unnecessaryOutcome:m}),{results:v,necessaryList:N,unnecessaryList:O}=u(i.INCOME_TYPE_MAP,f,"#82ca9d","#fdba74","#d1d5db"),{results:w,necessaryList:P,unnecessaryList:L}=u(i.OUTCOME_TYPE_MAP,h,"#faa5a5","#fdba74","#d1d5db");return{income:{total:y,necessary:b,unnecessary:p,necessaryList:N,unnecessaryList:O,list:v},outcome:{total:g,necessary:x,unnecessary:j,necessaryList:P,unnecessaryList:L,list:w}}})(f.filter(e=>`${new Date(e.date).getFullYear()}`===w.year&&`${new Date(e.date).getMonth()+1}`===w.month)))})},[f,w.year,w.month]),(0,t.jsxs)("div",{className:"content-wrapper",children:[(0,t.jsx)(r.YearMonthFilter,{refreshData:P,group:p,dateOptions:w,className:"flex self-center rounded-lg border border-gray-200 bg-white p-2 text-base shadow-sm"}),(0,t.jsxs)("div",{className:"flex w-full flex-col items-center gap-8 md:flex-row md:items-start",children:[(0,t.jsx)(s,{title:"收支類別比例",children:(0,t.jsxs)("div",{className:"flex w-full flex-wrap justify-center gap-4",children:[(0,t.jsx)("div",{className:"size-75",children:(0,t.jsx)(N,{totalIncome:h.income.total,totalOutcome:h.outcome.total,list:[...h.outcome.list,...h.income.list]})}),(0,t.jsx)("div",{className:"flex flex-1 flex-col gap-4",children:(0,t.jsx)(x,{totalIncome:h.income.total,totalOutcome:h.outcome.total,incomeList:h.income.list,outcomeList:h.outcome.list})})]})}),(0,t.jsx)(s,{title:"支出類別比例（必要 vs 額外）",children:(0,t.jsxs)("div",{className:"flex w-full flex-wrap justify-center gap-4",children:[(0,t.jsx)("div",{className:"size-75",children:(0,t.jsx)(O,{totalNecessity:h.outcome.necessary,totalUnnecessity:h.outcome.unnecessary,list:[...h.outcome.necessaryList,...h.outcome.unnecessaryList]})}),(0,t.jsx)("div",{className:"flex flex-1 flex-col gap-4",children:(0,t.jsx)(v,{totalNecessary:h.outcome.necessary,totalUnnecessary:h.outcome.unnecessary,necessaryList:h.outcome.necessaryList,unnecessaryList:h.outcome.unnecessaryList})})]})})]})]})}],76814)},92760,e=>{e.v(t=>Promise.all(["static/chunks/79e35da8be086c36.js","static/chunks/042b4b5cbe281748.js","static/chunks/8007746fd0e61649.js"].map(t=>e.l(t))).then(()=>t(50790)))},35879,e=>{e.v(t=>Promise.all(["static/chunks/2b10d00cb03b02cb.js","static/chunks/042b4b5cbe281748.js","static/chunks/8007746fd0e61649.js"].map(t=>e.l(t))).then(()=>t(75689)))}]);