{"version":3,"sources":["../../../../src/components/PageTitle.tsx","../../../../src/context/BudgetProvider.tsx","../../../../src/app/budget/AnnualBudgetSection.tsx","../../../../src/app/budget/MonthlyBudgetSection.tsx","../../../../src/app/budget/MonthlyBudgetBlocks.tsx","../../../../src/components/skeletons/BudgetSkeleton.tsx","../../../../src/app/budget/page.tsx"],"sourcesContent":["import { HTMLAttributes } from 'react';\n\nexport const PageTitle = (props: HTMLAttributes<HTMLDivElement>) => {\n  const { children, className = '', ...legacy } = props;\n  return (\n    <h1\n      className={`clipped-text gradient-r-from-purple-to-blue w-fit self-center p-6 text-xl font-bold sm:text-2xl ${className}`}\n      {...legacy}\n    >\n      {children}\n    </h1>\n  );\n};\n","'use client';\n\nimport { getBudget, putBudget, deleteBudget } from '@/services/budgetServices';\nimport { useIDB } from '@/hooks/useIDB';\nimport {\n  createContext,\n  ReactNode,\n  useCallback,\n  useContext,\n  useMemo,\n  useState,\n  startTransition,\n} from 'react';\n\nconst INIT_CTX_VAL: {\n  loading: boolean;\n  budget: Budget | null;\n  syncBudget: (accountId: number) => void;\n  updateBudget: (data: {\n    budget_id?: number;\n    account_id: number;\n    annual_budget: number;\n    monthly_items: MonthlyBudgetItem[];\n  }) => Promise<void>;\n  removeBudget: (accountId: number) => Promise<void>;\n} = {\n  loading: true,\n  budget: null,\n  syncBudget: () => {},\n  updateBudget: async () => {},\n  removeBudget: async () => {},\n};\n\nexport const BudgetProvider = ({ children }: { children: ReactNode }) => {\n  const [loading, setLoading] = useState(true);\n  const [budget, setBudget] = useState<Budget | null>(null);\n  const { db, getBudgetData, setBudgetData } = useIDB();\n\n  const handleState = useCallback((data: Budget | null) => {\n    setBudget(data);\n    setLoading(false);\n  }, []);\n\n  // Stale-While-Revalidate strategy for budget\n  const syncBudget = useCallback(\n    async (accountId: number) => {\n      if (!db) {\n        // Fallback to direct API call\n        setLoading(true);\n        getBudget(accountId)\n          .then((res) => {\n            if (res.status) {\n              handleState(res.data);\n            } else {\n              handleState(null);\n            }\n          })\n          .catch((err) => {\n            console.error(err);\n            handleState(null);\n          });\n        return;\n      }\n\n      // Try cache first\n      try {\n        const cachedData = await getBudgetData(db, accountId);\n        if (cachedData) {\n          console.log('[BudgetProvider] Using cached budget data');\n          startTransition(() => {\n            setBudget(cachedData);\n            setLoading(false);\n          });\n        } else {\n          setLoading(true);\n        }\n      } catch (error) {\n        console.error('[BudgetProvider] Error reading cache:', error);\n        setLoading(true);\n      }\n\n      // Revalidate in background\n      getBudget(accountId)\n        .then((res) => {\n          if (res.status) {\n            startTransition(() => {\n              handleState(res.data);\n            });\n            if (res.data) {\n              setBudgetData(db, accountId, res.data).catch(console.error);\n            }\n          } else {\n            handleState(null);\n          }\n        })\n        .catch((err) => {\n          console.error(err);\n          handleState(null);\n        });\n    },\n    [db, getBudgetData, setBudgetData, handleState],\n  );\n\n  const updateBudget = useCallback(\n    async (data: {\n      budget_id?: number;\n      account_id: number;\n      annual_budget: number;\n      monthly_items: MonthlyBudgetItem[];\n    }) => {\n      setLoading(true);\n      const res = await putBudget(data);\n      if (res.status && res.data) {\n        handleState(res.data);\n        // Update cache\n        if (db) {\n          setBudgetData(db, data.account_id, res.data).catch(console.error);\n        }\n      } else {\n        setLoading(false);\n        throw new Error(res.message);\n      }\n    },\n    [db, setBudgetData, handleState],\n  );\n\n  const removeBudget = useCallback(\n    async (accountId: number) => {\n      setLoading(true);\n      const res = await deleteBudget(accountId);\n      if (res.status) {\n        handleState(null);\n      } else {\n        setLoading(false);\n        throw new Error(res.message);\n      }\n    },\n    [handleState],\n  );\n\n  const ctxVal = useMemo(\n    () => ({\n      loading,\n      budget,\n      syncBudget,\n      updateBudget,\n      removeBudget,\n    }),\n    [loading, budget, syncBudget, updateBudget, removeBudget],\n  );\n\n  return <Ctx.Provider value={ctxVal}>{children}</Ctx.Provider>;\n};\n\nconst Ctx = createContext(INIT_CTX_VAL);\nexport const useBudgetCtx = () => useContext(Ctx);\n","'use client';\n\nimport { useBudgetCtx } from '@/context/BudgetProvider';\nimport { normalizeNumber } from '@/utils/normalizeNumber';\nimport { getExpenseFromData } from '@/utils/getExpenseFromData';\nimport { useMemo } from 'react';\n\ninterface Props {\n  yearlySpending: SpendingRecord[];\n}\n\nexport const AnnualBudgetSection = ({ yearlySpending }: Props) => {\n  const { budget } = useBudgetCtx();\n\n  // Calculate annual budget from all monthly items\n  const annualBudget = useMemo(() => {\n    if (!budget?.monthly_items || budget.monthly_items.length === 0) return 0;\n\n    let total = 0;\n    budget.monthly_items.forEach((item) => {\n      Object.values(item.months || {}).forEach((amount) => {\n        total += amount;\n      });\n    });\n    return total;\n  }, [budget?.monthly_items]);\n\n  // Calculate spent from transactions\n  const spent = useMemo(() => {\n    const { totalOutcome } = getExpenseFromData(yearlySpending);\n    return totalOutcome;\n  }, [yearlySpending]);\n\n  const percentage = annualBudget ? (spent / annualBudget) * 100 : 0;\n\n  return (\n    <div className=\"bg-background w-full rounded-xl p-6 shadow\">\n      <div className=\"flex items-center justify-between\">\n        <h2 className=\"text-xl font-bold\">年度預算</h2>\n      </div>\n\n      <div className=\"mt-4\">\n        <p className=\"text-3xl font-bold\">{normalizeNumber(annualBudget)} 元</p>\n        <p className=\"text-sm text-gray-500\">(自動計算)</p>\n        <div className=\"mt-2 h-2 w-full rounded-full bg-gray-200\">\n          <div\n            className=\"h-full rounded-full bg-gradient-to-r from-purple-500 to-blue-500\"\n            style={{ width: `${Math.min(percentage, 100)}%` }}\n          />\n        </div>\n        <p className=\"mt-2 text-sm text-gray-600\">\n          已使用 {normalizeNumber(spent)} 元 ({percentage.toFixed(1)}%)\n        </p>\n      </div>\n    </div>\n  );\n};\n","'use client';\n\nimport { useBudgetCtx } from '@/context/BudgetProvider';\nimport { normalizeNumber } from '@/utils/normalizeNumber';\nimport { getExpenseFromData } from '@/utils/getExpenseFromData';\nimport { useMemo } from 'react';\n\ninterface Props {\n  yearlySpending: SpendingRecord[];\n}\n\nexport const MonthlyBudgetSection = ({ yearlySpending }: Props) => {\n  const { budget } = useBudgetCtx();\n\n  // Calculate current month's budget and spending\n  const { monthlyBudget, spent } = useMemo(() => {\n    const currentMonth = new Date().getMonth() + 1;\n\n    // Calculate budget\n    let budgetTotal = 0;\n    if (budget?.monthly_items) {\n      budget.monthly_items.forEach((item) => {\n        const monthAmount = item.months?.[currentMonth.toString()];\n        if (monthAmount) {\n          budgetTotal += monthAmount;\n        }\n      });\n    }\n\n    // Calculate spent\n    const currentMonthRecords = yearlySpending.filter((record) => {\n      const recordDate = new Date(record.date);\n      return recordDate.getMonth() + 1 === currentMonth;\n    });\n    const { totalOutcome } = getExpenseFromData(currentMonthRecords);\n\n    return {\n      monthlyBudget: budgetTotal,\n      spent: totalOutcome,\n    };\n  }, [budget?.monthly_items, yearlySpending]);\n\n  const percentage = monthlyBudget ? (spent / monthlyBudget) * 100 : 0;\n\n  return (\n    <div className=\"bg-background w-full rounded-xl p-6 shadow\">\n      <h2 className=\"text-xl font-bold\">本月預算</h2>\n\n      <div className=\"mt-4\">\n        <p className=\"text-3xl font-bold\">\n          {normalizeNumber(monthlyBudget)} 元\n        </p>\n        <p className=\"text-sm text-gray-500\">(由月度項目自動計算)</p>\n\n        <div className=\"mt-2 h-2 w-full rounded-full bg-gray-200\">\n          <div\n            className={`h-full rounded-full ${\n              percentage > 100\n                ? 'bg-red-500'\n                : 'bg-gradient-to-r from-purple-500 to-blue-500'\n            }`}\n            style={{ width: `${Math.min(percentage, 100)}%` }}\n          />\n        </div>\n        <p className=\"mt-2 text-sm text-gray-600\">\n          已使用 {normalizeNumber(spent)} 元 ({percentage.toFixed(1)}%)\n        </p>\n      </div>\n    </div>\n  );\n};\n","'use client';\n\nimport { Modal } from '@/components/Modal';\nimport { Loading } from '@/components/icons/Loading';\nimport { DeleteIcon } from '@/components/icons/DeleteIcon';\nimport { useBudgetCtx } from '@/context/BudgetProvider';\nimport { useGroupCtx } from '@/context/GroupProvider';\nimport { normalizeNumber } from '@/utils/normalizeNumber';\nimport { SpendingType } from '@/utils/constants';\nimport { useState, useCallback, useMemo } from 'react';\n\nconst MONTHS = [\n  { value: 1, label: '一月' },\n  { value: 2, label: '二月' },\n  { value: 3, label: '三月' },\n  { value: 4, label: '四月' },\n  { value: 5, label: '五月' },\n  { value: 6, label: '六月' },\n  { value: 7, label: '七月' },\n  { value: 8, label: '八月' },\n  { value: 9, label: '九月' },\n  { value: 10, label: '十月' },\n  { value: 11, label: '十一月' },\n  { value: 12, label: '十二月' },\n];\n\ninterface Props {\n  yearlySpending: SpendingRecord[];\n}\n\nexport const MonthlyBudgetBlocks = ({ yearlySpending }: Props) => {\n  const { budget, updateBudget } = useBudgetCtx();\n  const { currentGroup } = useGroupCtx();\n  const [modalOpen, setModalOpen] = useState(false);\n  const [selectedMonth, setSelectedMonth] = useState<number | null>(null);\n  const [itemName, setItemName] = useState('');\n  const [itemAmount, setItemAmount] = useState<number>(0);\n  const [saving, setSaving] = useState(false);\n\n  // Calculate total budget for each month\n  const monthlyTotals = useMemo(() => {\n    const totals: { [key: number]: number } = {};\n    MONTHS.forEach((month) => {\n      totals[month.value] = 0;\n    });\n\n    if (budget?.monthly_items) {\n      budget.monthly_items.forEach((item) => {\n        Object.entries(item.months || {}).forEach(([monthStr, amount]) => {\n          const monthNum = parseInt(monthStr);\n          totals[monthNum] = (totals[monthNum] || 0) + amount;\n        });\n      });\n    }\n\n    return totals;\n  }, [budget?.monthly_items]);\n\n  // Calculate actual spending for each month\n  const monthlySpending = useMemo(() => {\n    const spending: { [key: number]: number } = {};\n    MONTHS.forEach((month) => {\n      spending[month.value] = 0;\n    });\n\n    yearlySpending.forEach((record) => {\n      if (record.type === SpendingType.Outcome) {\n        const recordDate = new Date(record.date);\n        const month = recordDate.getMonth() + 1;\n        const amount = Number(record.amount);\n        spending[month] = (spending[month] || 0) + amount;\n      }\n    });\n\n    return spending;\n  }, [yearlySpending]);\n\n  // Get items for a specific month\n  const getMonthItems = useCallback(\n    (month: number) => {\n      if (!budget?.monthly_items) return [];\n\n      return budget.monthly_items\n        .map((item, index) => ({\n          index,\n          name: item.name,\n          amount: item.months?.[month.toString()] || 0,\n        }))\n        .filter((item) => item.amount > 0);\n    },\n    [budget?.monthly_items],\n  );\n\n  const handleOpenAddModal = (month: number) => {\n    setSelectedMonth(month);\n    setItemName('');\n    setItemAmount(0);\n    setModalOpen(true);\n  };\n\n  const handleSaveItem = useCallback(async () => {\n    if (!currentGroup?.account_id || !itemName.trim() || selectedMonth === null) {\n      alert('請填寫項目名稱與金額');\n      return;\n    }\n\n    setSaving(true);\n    try {\n      // Check if item with same name exists\n      const existingItemIndex = budget?.monthly_items?.findIndex(\n        (item) => item.name === itemName,\n      );\n\n      let newItems: MonthlyBudgetItem[];\n\n      if (existingItemIndex !== undefined && existingItemIndex >= 0) {\n        // Update existing item\n        newItems = [...(budget?.monthly_items || [])];\n        newItems[existingItemIndex] = {\n          ...newItems[existingItemIndex],\n          months: {\n            ...newItems[existingItemIndex].months,\n            [selectedMonth.toString()]: itemAmount,\n          },\n        };\n      } else {\n        // Create new item\n        const newItem: MonthlyBudgetItem = {\n          name: itemName,\n          months: {\n            [selectedMonth.toString()]: itemAmount,\n          },\n        };\n        newItems = [...(budget?.monthly_items || []), newItem];\n      }\n\n      await updateBudget({\n        budget_id: budget?.budget_id,\n        account_id: currentGroup.account_id,\n        annual_budget: budget?.annual_budget || 0,\n        monthly_items: newItems,\n      });\n\n      setModalOpen(false);\n    } catch (error) {\n      console.error(error);\n      alert('儲存失敗，請稍後再試');\n    } finally {\n      setSaving(false);\n    }\n  }, [currentGroup, budget, itemName, itemAmount, selectedMonth, updateBudget]);\n\n  const handleDeleteItem = useCallback(\n    async (month: number, itemIndex: number) => {\n      if (!currentGroup?.account_id) return;\n\n      const confirmDelete = window.confirm('確定要刪除此項目嗎？');\n      if (!confirmDelete) return;\n\n      try {\n        const newItems = [...(budget?.monthly_items || [])];\n        const item = newItems[itemIndex];\n\n        // Remove the month amount from the item\n        const newMonths = { ...item.months };\n        delete newMonths[month.toString()];\n\n        // If item has no more months, remove the entire item\n        if (Object.keys(newMonths).length === 0) {\n          newItems.splice(itemIndex, 1);\n        } else {\n          newItems[itemIndex] = {\n            ...item,\n            months: newMonths,\n          };\n        }\n\n        await updateBudget({\n          budget_id: budget?.budget_id,\n          account_id: currentGroup.account_id,\n          annual_budget: budget?.annual_budget || 0,\n          monthly_items: newItems,\n        });\n      } catch (error) {\n        console.error(error);\n        alert('刪除失敗，請稍後再試');\n      }\n    },\n    [currentGroup, budget, updateBudget],\n  );\n\n  const currentMonth = new Date().getMonth() + 1;\n\n  return (\n    <>\n      <div className=\"grid w-full grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3 md:max-w-250\">\n        {MONTHS.map((month) => {\n          const monthItems = getMonthItems(month.value);\n          const monthTotal = monthlyTotals[month.value];\n          const monthSpent = monthlySpending[month.value];\n          const usagePercentage = monthTotal > 0 ? (monthSpent / monthTotal) * 100 : 0;\n          const isCurrentMonth = month.value === currentMonth;\n          const isOverBudget = monthSpent > monthTotal;\n\n          return (\n            <div\n              key={month.value}\n              className={`bg-background rounded-xl p-4 shadow ${\n                isCurrentMonth ? 'ring-2 ring-primary-500' : ''\n              }`}\n            >\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-lg font-bold\">\n                  {month.label}\n                  {isCurrentMonth && (\n                    <span className=\"text-primary-500 ml-2 text-xs\">(本月)</span>\n                  )}\n                </h3>\n                <button\n                  type=\"button\"\n                  onClick={() => handleOpenAddModal(month.value)}\n                  className=\"text-primary-500 hover:text-primary-600 text-sm font-medium\"\n                >\n                  + 新增\n                </button>\n              </div>\n\n              <div className=\"mt-2\">\n                <p className=\"text-2xl font-bold\">\n                  {normalizeNumber(monthTotal)} 元\n                </p>\n                <p className=\"text-sm text-gray-500\">\n                  已使用 {normalizeNumber(monthSpent)} 元\n                  {monthTotal > 0 && (\n                    <span className={`ml-1 font-medium ${isOverBudget ? 'text-red-600' : 'text-green-600'}`}>\n                      ({usagePercentage.toFixed(1)}%)\n                    </span>\n                  )}\n                </p>\n              </div>\n\n              {/* Progress Bar */}\n              {monthTotal > 0 && (\n                <div className=\"mt-2\">\n                  <div className=\"h-2 w-full overflow-hidden rounded-full bg-gray-200\">\n                    <div\n                      className={`h-full transition-all ${\n                        isOverBudget ? 'bg-red-500' : 'bg-green-500'\n                      }`}\n                      style={{ width: `${Math.min(usagePercentage, 100)}%` }}\n                    />\n                  </div>\n                </div>\n              )}\n\n              <div className=\"mt-3 space-y-2\">\n                {monthItems.length > 0 ? (\n                  monthItems.map((item) => (\n                    <div\n                      key={`${month.value}-${item.index}`}\n                      className=\"flex items-center justify-between rounded-lg bg-gray-50 p-2\"\n                    >\n                      <div className=\"flex-1\">\n                        <p className=\"text-sm font-medium\">{item.name}</p>\n                        <p className=\"text-xs text-gray-500\">\n                          {normalizeNumber(item.amount)} 元\n                        </p>\n                      </div>\n                      <button\n                        type=\"button\"\n                        onClick={() => handleDeleteItem(month.value, item.index)}\n                        className=\"rounded p-1 text-red-500 transition-colors hover:bg-red-50 active:bg-red-50\"\n                      >\n                        <DeleteIcon className=\"size-4\" />\n                      </button>\n                    </div>\n                  ))\n                ) : (\n                  <p className=\"py-4 text-center text-xs text-gray-400\">\n                    尚未新增項目\n                  </p>\n                )}\n              </div>\n            </div>\n          );\n        })}\n      </div>\n\n      {modalOpen && selectedMonth !== null && (\n        <Modal\n          defaultOpen={true}\n          onClose={() => setModalOpen(false)}\n          className=\"flex w-full flex-col self-end sm:max-w-96 sm:self-center sm:rounded-xl\"\n          title={`新增 ${MONTHS[selectedMonth - 1].label} 預算項目`}\n        >\n          <div className=\"flex w-full flex-col gap-4\">\n            <fieldset>\n              <legend className=\"mb-2\">項目名稱</legend>\n              <input\n                type=\"text\"\n                className=\"h-10 w-full rounded-md border border-solid border-gray-300 px-3 py-1\"\n                value={itemName}\n                onChange={(e) => setItemName(e.target.value)}\n                placeholder=\"例如：房租、水電費\"\n              />\n            </fieldset>\n\n            <fieldset>\n              <legend className=\"mb-2\">預算金額</legend>\n              <input\n                type=\"number\"\n                className=\"h-10 w-full rounded-md border border-solid border-gray-300 px-3 py-1\"\n                value={itemAmount || ''}\n                onChange={(e) => setItemAmount(Number(e.target.value))}\n                placeholder=\"5000\"\n              />\n            </fieldset>\n\n            <div className=\"flex w-full justify-end gap-2 pt-4\">\n              <button\n                type=\"button\"\n                onClick={() => setModalOpen(false)}\n                disabled={saving}\n                className=\"rounded-lg border border-solid border-gray-300 px-4 py-2 text-gray-500\"\n              >\n                取消\n              </button>\n              <button\n                type=\"button\"\n                onClick={handleSaveItem}\n                disabled={saving}\n                className=\"bg-text text-background flex items-center justify-center rounded-lg px-6 py-2 font-bold transition-colors hover:bg-gray-800 active:bg-gray-800 disabled:cursor-not-allowed disabled:bg-gray-400\"\n              >\n                {saving ? <Loading className=\"size-5 animate-spin\" /> : '新增'}\n              </button>\n            </div>\n          </div>\n        </Modal>\n      )}\n    </>\n  );\n};\n","export const BudgetSkeleton = () => {\n  return (\n    <div className=\"content-wrapper animate-pulse\">\n      {/* Title Skeleton */}\n      <div className=\"h-8 w-48 bg-gray-200 rounded mb-2\"></div>\n\n      <div className=\"flex w-full flex-col gap-5\">\n        {/* Annual Budget Section Skeleton */}\n        <div className=\"bg-background flex w-full flex-col gap-4 rounded-2xl border border-solid border-gray-200 p-6 shadow-sm\">\n          <div className=\"h-6 w-32 bg-gray-200 rounded\"></div>\n          <div className=\"grid grid-cols-1 gap-4 md:grid-cols-3\">\n            {[1, 2, 3].map((i) => (\n              <div key={i} className=\"flex flex-col gap-2 rounded-lg bg-gray-50 p-4\">\n                <div className=\"h-4 w-24 bg-gray-200 rounded\"></div>\n                <div className=\"h-8 w-32 bg-gray-200 rounded\"></div>\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {/* Monthly Budget Section Skeleton */}\n        <div className=\"bg-background flex w-full flex-col gap-4 rounded-2xl border border-solid border-gray-200 p-6 shadow-sm\">\n          <div className=\"h-6 w-32 bg-gray-200 rounded\"></div>\n\n          {/* Monthly Blocks Skeleton */}\n          <div className=\"grid grid-cols-2 gap-3 md:grid-cols-4 lg:grid-cols-6\">\n            {[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12].map((i) => (\n              <div\n                key={i}\n                className=\"flex flex-col gap-2 rounded-lg border border-gray-200 bg-gray-50 p-3\"\n              >\n                <div className=\"h-4 w-16 bg-gray-200 rounded\"></div>\n                <div className=\"h-6 w-20 bg-gray-200 rounded\"></div>\n                <div className=\"h-3 w-full bg-gray-100 rounded-full mt-1\">\n                  <div className=\"h-3 bg-gray-200 rounded-full\" style={{ width: '60%' }}></div>\n                </div>\n              </div>\n            ))}\n          </div>\n\n          {/* Monthly Items List Skeleton */}\n          <div className=\"mt-4 flex flex-col gap-2\">\n            {[1, 2, 3, 4, 5].map((i) => (\n              <div\n                key={i}\n                className=\"flex items-center gap-3 rounded-lg border border-gray-200 bg-gray-50 p-3\"\n              >\n                <div className=\"size-6 bg-gray-200 rounded\"></div>\n                <div className=\"flex-1\">\n                  <div className=\"h-4 w-32 bg-gray-200 rounded mb-1\"></div>\n                  <div className=\"h-3 w-24 bg-gray-200 rounded\"></div>\n                </div>\n                <div className=\"h-5 w-20 bg-gray-200 rounded\"></div>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n","'use client';\n\nimport { PageTitle } from '@/components/PageTitle';\nimport { AnnualBudgetSection } from '@/app/budget/AnnualBudgetSection';\nimport { MonthlyBudgetSection } from '@/app/budget/MonthlyBudgetSection';\nimport { MonthlyBudgetBlocks } from '@/app/budget/MonthlyBudgetBlocks';\nimport { BudgetSkeleton } from '@/components/skeletons/BudgetSkeleton';\nimport { BudgetProvider, useBudgetCtx } from '@/context/BudgetProvider';\nimport { useGroupCtx } from '@/context/GroupProvider';\nimport { getItems } from '@/services/getRecords';\nimport { useEffect, useState, startTransition } from 'react';\n\nfunction BudgetContent() {\n  const { currentGroup } = useGroupCtx();\n  const { syncBudget, budget, loading } = useBudgetCtx();\n  const [yearlySpending, setYearlySpending] = useState<SpendingRecord[]>([]);\n  const [isInitialLoad, setIsInitialLoad] = useState(true);\n\n  // Parallel fetch: budget and spending data simultaneously\n  useEffect(() => {\n    if (!currentGroup?.account_id) return;\n\n    const accountId = currentGroup.account_id;\n\n    // Fetch both budget and spending data in parallel\n    Promise.all([\n      syncBudget(accountId),\n      (async () => {\n        const now = new Date();\n        const startOfYear = new Date(now.getFullYear(), 0, 1);\n        const endOfYear = new Date(now.getFullYear(), 11, 31, 23, 59, 59);\n\n        const response = await getItems(\n          String(accountId),\n          undefined,\n          startOfYear.toISOString(),\n          endOfYear.toISOString(),\n        );\n\n        if (response.status && response.data) {\n          // Use startTransition to make UI update non-blocking\n          startTransition(() => {\n            setYearlySpending(response.data);\n            if (isInitialLoad) {\n              setIsInitialLoad(false);\n            }\n          });\n        }\n      })(),\n    ]).catch((error) => {\n      console.error('[BudgetPage] Error fetching data:', error);\n    });\n  }, [currentGroup?.account_id, syncBudget, isInitialLoad]);\n\n  if (!currentGroup) {\n    return (\n      <div className=\"flex w-full flex-1 items-center justify-center\">\n        <p className=\"text-gray-400\">請先選擇一個帳本</p>\n      </div>\n    );\n  }\n\n  // Show skeleton only on initial load\n  if (isInitialLoad && (loading || yearlySpending.length === 0)) {\n    return <BudgetSkeleton />;\n  }\n\n  // Progressive rendering: Show UI immediately, data will populate when ready\n  return (\n    <div className=\"content-wrapper space-y-3 md:space-y-5\">\n      <div className=\"grid w-full grid-cols-1 gap-3 md:max-w-250 md:grid-cols-2 md:gap-5\">\n        <AnnualBudgetSection yearlySpending={yearlySpending} />\n        <MonthlyBudgetSection yearlySpending={yearlySpending} />\n      </div>\n      <MonthlyBudgetBlocks yearlySpending={yearlySpending} />\n    </div>\n  );\n}\n\nexport default function BudgetPage() {\n  return (\n    <div className=\"bg-soft relative flex w-full flex-1 flex-col\">\n      <PageTitle>預算管理</PageTitle>\n      <BudgetProvider>\n        <BudgetContent />\n      </BudgetProvider>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}