module.exports=[99283,a=>{"use strict";function b(a,c,d={}){let e=`${encodeURIComponent(a)}=${encodeURIComponent(c)}`;if(d.expires){let a=d.expires instanceof Date?d.expires:new Date(Date.now()+24*d.expires*36e5);e+=`; expires=${a.toUTCString()}`}d.path&&(e+=`; path=${d.path}`),d.domain&&(e+=`; domain=${d.domain}`),d.secure&&(e+="; secure"),d.sameSite&&(e+=`; samesite=${d.sameSite}`),document.cookie=e}function c(a){let b=encodeURIComponent(a)+"=",c=document.cookie.split(";");for(let a=0;a<c.length;a++){let d=c[a].trim();if(d.startsWith(b))return decodeURIComponent(d.substring(b.length))}return null}a.s(["getCookie",()=>c,"setCookie",()=>b])},73651,a=>{"use strict";var b=a.i(87924),c=a.i(89829),d=a.i(22283),e=a.i(99283),f=a.i(72131);let g=(a,b)=>({data:b,loading:!1}),h=(0,f.createContext)({loading:!0,data:[],syncData:()=>{}});a.s(["SpendingProvider",0,({children:a})=>{let[i,j]=(0,f.useReducer)(g,{data:[],loading:!0}),{db:k,getSpendingData:l,setSpendingData:m}=(0,c.useIDB)(),n=(0,f.useRef)(null),o=(0,f.useCallback)(a=>{j(a)},[]),p=(0,f.useCallback)((a,b,c,e)=>{(a||b)&&(0,d.getItems)(b,a,c,e).then(a=>{n.current&&n.current.abort(),console.log("Get Data from API"),o(a.data),m(k,a.data,Number(b),c).then(()=>{console.log("Update IDB success.")}).catch(a=>{console.log("Update IDB failed: ",a)})}).catch(console.error)},[k,o,m]),q=(0,f.useCallback)((a,b,c,d)=>{p(b,a,c,d)},[p]),r=(0,f.useMemo)(()=>({...i,syncData:q}),[i,q]);return(0,f.useEffect)(()=>{let a=n.current=new AbortController,b=(0,e.getCookie)("currentGroupId");return k&&b&&l(k,Number(b),a.signal).then(a=>{if(a&&1===a.length){let b=JSON.parse(a[0].data);console.log("Get Data from IDB",b),0!==b.length&&(o(b),n.current=null)}}).catch(a=>{console.log("Error while syncing data: ",a)}),()=>a.abort()},[k,l,o]),(0,b.jsx)(h.Provider,{value:r,children:a})},"useGetSpendingCtx",0,()=>(0,f.useContext)(h)])},68428,a=>{"use strict";a.s(["getStartEndOfMonth",0,a=>({startDate:new Date(new Date(a).getFullYear(),new Date(a).getMonth(),1,0,0,0),endDate:new Date(new Date(a).getFullYear(),new Date(a).getMonth()+1,0,23,59,59)})])},22283,a=>{"use strict";let b="/api/aurora/items",c=async(a,c,d,e)=>{try{let f=new URLSearchParams;if(a)f.set("groupId",a);else{if(!c)return{status:!1,data:[],message:"ç¼ºå°‘ç¾¤çµ„ ID æˆ–ä¿¡ç®±è³‡è¨Š"};f.set("email",c)}d&&f.set("startDate",d),e&&f.set("endDate",e);let g=await fetch(`${b}?${f}`).then(a=>a.json());return{status:!0,data:g,message:"success"}}catch(a){return console.error(a),{status:!1,data:[],message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}},d=async a=>{try{return await fetch(b,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})}catch(a){return console.error(a),{status:!1,message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}},e=async a=>{try{return await fetch(`${b}?id=${a}`,{method:"DELETE"})}catch(a){return console.error(a),{status:!1,message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}};a.s(["deleteItem",0,e,"getItems",0,c,"putItem",0,d])},51275,a=>{"use strict";var b=a.i(72131);a.s(["default",0,a=>{let c=(0,b.useRef)(null);return(0,b.useEffect)(()=>{let b=b=>{c.current&&!c.current.contains(b.target)&&a()};return document.addEventListener("mousedown",b),()=>{document.removeEventListener("mousedown",b)}},[a]),c}])},46058,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},71336,a=>{"use strict";var b,c,d=((b={}).Income="Income",b.Outcome="Outcome",b),e=((c={}).Need="å¿…",c.NotNeed="éž",c);let f=["æŠ•è³‡","è–ªè³‡","çŽé‡‘","å…¶ä»–"],g=["ðŸ“ˆ","ðŸ’°","ðŸŽ","âœ¨"].map((a,b)=>({value:a,label:f[b]})),h=["é£²é£Ÿ","æœé£¾","ä½å®¿","äº¤é€š","å­¸ç¿’","å¨›æ¨‚","æ—¥å¸¸","é†«ç™‚","æŠ•è³‡","å…¶ä»–"],i=["ðŸ”","ðŸ‘—","ðŸ ","ðŸš—","ðŸ“š","ðŸŽ²","ðŸ§»","ðŸ’Š","ðŸ“‰","âœ¨"].map((a,b)=>({value:a,label:h[b]}));a.s(["CATEGORY_WORDING_MAP",0,{"ðŸ”":"é£²é£Ÿ","ðŸ‘—":"æœé£¾","ðŸ ":"ä½å®¿","ðŸš—":"äº¤é€š","ðŸ“š":"å­¸ç¿’","ðŸŽ²":"å¨›æ¨‚","ðŸ§»":"æ—¥å¸¸","ðŸ’Š":"é†«ç™‚","ðŸ“‰":"æŠ•è³‡","âœ¨":"å…¶ä»–","ðŸ“ˆ":"æŠ•è³‡","ðŸ’°":"è–ªè³‡","ðŸŽ":"çŽé‡‘"},"IDB_NAME",0,"Expense Tracking","IDB_VERSION",0,2,"INCOME_TYPE_MAP",0,g,"MENU_CONFIG",0,{"/":"é¦–é ","/transactions":"å¸³ç›®","/group":"å¸³æœ¬","/analysis":"åˆ†æž","/budget":"é ç®—"},"MONTH_LABEL",0,{Jan:"1",Feb:"2",Mar:"3",Apr:"4",May:"5",Jun:"6",Jul:"7",Aug:"8",Sep:"9",Oct:"10",Nov:"11",Dec:"12"},"MONTH_MAP",0,{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},"Necessity",()=>e,"OUTCOME_TYPE_MAP",0,i,"SpendingType",()=>d,"WEEKDAY",0,["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"]])},89829,a=>{"use strict";var b,c=a.i(71336),d=a.i(72131),e=((b=e||{}).UserConfig="User Config",b.ExpenseRecord="Expense Record",b.GroupData="Group Data",b.BudgetData="Budget Data",b);let f=c.IDB_NAME,g=c.IDB_VERSION,h=["User Config","Expense Record","Group Data","Budget Data"],i={"Expense Record":{indexName:"group_year_month",indexValue:["group_id","year","month"]},"User Config":{indexName:"email",indexValue:["email"]},"Group Data":{indexName:"user_id",indexValue:["user_id"]},"Budget Data":{indexName:"account_id",indexValue:["account_id"]}};a.s(["useIDB",0,()=>{let[a,b]=(0,d.useState)(null);(0,d.useEffect)(()=>{let a=indexedDB.open(f,g);a.onsuccess=()=>{let c=a.result;for(let a of h)if(!c.objectStoreNames.contains(a)){console.error(`Object store ${a} does not exist.`),c.close(),indexedDB.deleteDatabase(f),window.location.reload();return}b(c)},a.onupgradeneeded=()=>{let b=a.result;for(let a of h)if(!b.objectStoreNames.contains(a)){let c=b.createObjectStore(a,{keyPath:"id",autoIncrement:!0}),d=i[a];c.createIndex(d.indexName,d.indexValue,{unique:!0})}},a.onerror=()=>console.error("Error opening IndexedDB:",a.error)},[]);let c=(0,d.useCallback)((a,b)=>a?new Promise((c,d)=>{let e=a.transaction(h,"readwrite").objectStore("User Config"),f={email:b.email,data:JSON.stringify(b)},g=e.index(i["User Config"].indexName).get([b.email]);g.onsuccess=()=>{let a=g.result;a&&(f.id=a.id);let b=e.put(f);b.onsuccess=()=>c(),b.onerror=()=>console.error(b.error)},g.onerror=()=>console.error(g.error)}):Promise.reject("Database not initialized"),[]),e=(0,d.useCallback)((a,b,c)=>a?new Promise((d,e)=>{let f=a.transaction(h,"readonly"),g=!0;f.oncomplete=()=>{g=!1},f.onerror=a=>{g=!1,console.error(a.target.error)},c.addEventListener("abort",()=>{g&&(console.log("getUserData aborted"),f.abort())});let j=f.objectStore("User Config").index(i["User Config"].indexName).get([b]);j.onsuccess=()=>{g=!1,d(j.result)},j.onerror=()=>{g=!1,console.error(j.error)},f.onabort=()=>console.error("Transaction aborted")}):Promise.reject("Database not initialized"),[]),j=(0,d.useCallback)((a,b,c,d=new Date().toISOString())=>a?null==c?Promise.reject("Invalid groupId"):new Promise((e,f)=>{let g=a.transaction(h,"readwrite").objectStore("Expense Record"),j=new Date(d).getFullYear(),k=new Date(d).getMonth(),l={group_id:c,year:j,month:k,data:JSON.stringify(b)},m=g.index(i["Expense Record"].indexName);try{let a=m.get([c,j,k]);a.onsuccess=()=>{let b=a.result;b&&(l.id=b.id);let c=g.put(l);c.onsuccess=()=>e(),c.onerror=()=>f(c.error)},a.onerror=()=>f(a.error)}catch(b){let a=g.getAll();a.onsuccess=()=>{try{let b=a.result.find(a=>a.group_id==c&&a.year===j&&a.month===k);b&&(l.id=b.id);let d=g.put(l);d.onsuccess=()=>e(),d.onerror=()=>f(d.error)}catch(a){f(a)}},a.onerror=()=>f(a.error)}}):Promise.reject("Database not initialized"),[]),k=(0,d.useCallback)((a,b,c)=>a?new Promise((d,e)=>{let f=a.transaction(h,"readonly"),g=!0;f.oncomplete=()=>{g=!1},f.onerror=a=>{g=!1,console.error(a.target.error)},c.addEventListener("abort",()=>{g&&(console.log("getUserData aborted"),f.abort())});let j=f.objectStore("Expense Record").index(i["Expense Record"].indexName),k=new Date().getFullYear(),l=new Date().getMonth(),m=j.getAll([b,k,l]);m.onsuccess=()=>{g=!1,d(m.result)},m.onerror=()=>{g=!1,console.error(m.error)},f.onabort=()=>console.error("Transaction aborted")}):Promise.reject("Database not initialized"),[]),l=(0,d.useCallback)((a,b,c)=>a?new Promise((d,e)=>{let f=a.transaction(h,"readwrite").objectStore("Group Data"),g={user_id:b,data:JSON.stringify(c),timestamp:Date.now()},j=f.index(i["Group Data"].indexName).get([b]);j.onsuccess=()=>{let a=j.result;a&&(g.id=a.id);let b=f.put(g);b.onsuccess=()=>d(),b.onerror=()=>e(b.error)},j.onerror=()=>e(j.error)}):Promise.reject("Database not initialized"),[]),m=(0,d.useCallback)((a,b,c=3e5)=>a?new Promise((d,e)=>{let f=a.transaction(h,"readonly").objectStore("Group Data").index(i["Group Data"].indexName).get([b]);f.onsuccess=()=>{let a=f.result;if(!a||Date.now()-a.timestamp>c)return void d(null);try{let b=JSON.parse(a.data);d(b)}catch(a){e(a)}},f.onerror=()=>e(f.error)}):Promise.reject("Database not initialized"),[]);return{db:a,setSpendingData:j,getSpendingData:k,setUserData:c,getUserData:e,setGroupData:l,getGroupData:m,setBudgetData:(0,d.useCallback)((a,b,c)=>a?new Promise((d,e)=>{let f=a.transaction(h,"readwrite").objectStore("Budget Data"),g={account_id:b,data:JSON.stringify(c),timestamp:Date.now()},j=f.index(i["Budget Data"].indexName).get([b]);j.onsuccess=()=>{let a=j.result;a&&(g.id=a.id);let b=f.put(g);b.onsuccess=()=>d(),b.onerror=()=>e(b.error)},j.onerror=()=>e(j.error)}):Promise.reject("Database not initialized"),[]),getBudgetData:(0,d.useCallback)((a,b,c=3e5)=>a?new Promise((d,e)=>{let f=a.transaction(h,"readonly").objectStore("Budget Data").index(i["Budget Data"].indexName).get([b]);f.onsuccess=()=>{let a=f.result;if(!a||Date.now()-a.timestamp>c)return void d(null);try{let b=JSON.parse(a.data);d(b)}catch(a){e(a)}},f.onerror=()=>e(f.error)}):Promise.reject("Database not initialized"),[])}}])},10584,71384,a=>{"use strict";var b=a.i(87924);let c="/api/aurora/groups",d=async a=>{try{return await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),{status:!0,message:"success"}}catch(a){return console.error(a),{status:!1,data:[],message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}},e=async a=>{try{return await fetch(c,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),{status:!0,message:"success"}}catch(a){return console.error(a),{status:!1,data:[],message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}},f=async a=>{try{return await fetch(`${c}?id=${a}`,{method:"DELETE"}),{status:!0,message:"success"}}catch(a){return console.error(a),{status:!1,data:[],message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}},g=async a=>{try{let b=await fetch(`${c}?id=${a}`).then(a=>a.json());return{status:!0,data:b,message:"success"}}catch(a){return console.error(a),{status:!1,data:[],message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}},h=async(a,b)=>{try{return await fetch(`/api/aurora/group/member?account_id=${a}&user_id=${b}`,{method:"DELETE"}),{status:!0,message:"success"}}catch(a){return console.error(a),{status:!1,message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}},i=async a=>{try{if(!a)return{status:!1,data:[],message:"ç¼ºå°‘å¸³æœ¬ ID"};let b=await fetch(`/api/aurora/group/members?account_id=${a}`).then(a=>a.json());return{status:!0,data:b,message:"success"}}catch(a){return console.error(a),{status:!1,data:[],message:"ç™¼ç”Ÿä¸é æœŸçš„éŒ¯èª¤"}}};a.s(["createGroup",0,d,"deleteGroup",0,f,"getGroupMembers",0,i,"getGroups",0,g,"putGroup",0,e,"removeGroupMember",0,h],71384);var j=a.i(89829),k=a.i(72131);let l=(0,k.createContext)({loading:!0,currentGroup:void 0,groups:[],syncGroup:()=>{},setter:()=>{},setCurrentGroup:()=>{}});a.s(["GroupProvider",0,({children:a})=>{let[c,d]=(0,k.useState)(!0),[e,f]=(0,k.useState)([]),[h,i]=(0,k.useState)(),{db:m,getGroupData:n,setGroupData:o}=(0,j.useIDB)(),p=(0,k.useCallback)(a=>{f(a),d(!1)},[]),q=(0,k.useCallback)(async a=>{if(!m){d(!0),g(a).then(a=>{a.status&&p(a.data)}).catch(console.error);return}try{let b=await n(m,a);b?(console.log("[GroupProvider] Using cached group data"),(0,k.startTransition)(()=>{f(b),d(!1)})):d(!0)}catch(a){console.error("[GroupProvider] Error reading cache:",a),d(!0)}g(a).then(b=>{b.status&&((0,k.startTransition)(()=>{p(b.data)}),o(m,a,b.data).catch(console.error))}).catch(console.error)},[m,n,o,p]),r=(0,k.useMemo)(()=>({loading:c,groups:e,currentGroup:h,setCurrentGroup:i,syncGroup:q,setter:p}),[h,e,c,q,p]);return(0,b.jsx)(l.Provider,{value:r,children:a})},"useGroupCtx",0,()=>(0,k.useContext)(l)],10584)}];

//# sourceMappingURL=_037f4100._.js.map