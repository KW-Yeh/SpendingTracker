module.exports=[35112,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactDOM},90768,a=>{"use strict";a.s(["normalizeNumber",0,a=>{let b=Math.floor(a).toString(),c=[],d=b.split("").reverse(),e=0;return d.forEach(a=>{0!==e&&e%3==0&&c.push(","),c.push(a),e++}),c.toReversed().join("")}])},2211,a=>{"use strict";var b=a.i(87924);a.s(["CalendarIcon",0,a=>(0,b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-calendar-event",viewBox:"0 0 16 16",...a,children:[(0,b.jsx)("path",{d:"M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"}),(0,b.jsx)("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"})]})])},42343,a=>{"use strict";var b=a.i(72131),c={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},d=b.default.createContext&&b.default.createContext(c),e=["attr","size","title"];function f(){return(f=Object.assign.bind()).apply(this,arguments)}function g(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function h(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?g(Object(c),!0).forEach(function(b){var d,e,f;d=a,e=b,f=c[b],(e=function(a){var b=function(a,b){if("object"!=typeof a||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=typeof d)return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(a,"string");return"symbol"==typeof b?b:b+""}(e))in d?Object.defineProperty(d,e,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[e]=f}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):g(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}function i(a){return c=>b.default.createElement(j,f({attr:h({},a.attr)},c),function a(c){return c&&c.map((c,d)=>b.default.createElement(c.tag,h({key:d},c.attr),a(c.child)))}(a.child))}function j(a){var g=c=>{var d,{attr:g,size:i,title:j}=a,k=function(a,b){if(null==a)return{};var c,d,e=function(a,b){if(null==a)return{};var c={};for(var d in a)if(Object.prototype.hasOwnProperty.call(a,d)){if(b.indexOf(d)>=0)continue;c[d]=a[d]}return c}(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],!(b.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}(a,e),l=i||c.size||"1em";return c.className&&(d=c.className),a.className&&(d=(d?d+" ":"")+a.className),b.default.createElement("svg",f({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},c.attr,g,k,{className:d,style:h(h({color:a.color||c.color},c.style),a.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),j&&b.default.createElement("title",null,j),a.children)};return void 0!==d?b.default.createElement(d.Consumer,null,a=>g(a)):g(c)}a.s(["GenIcon",()=>i],42343)},33354,(a,b,c)=>{"use strict";c._=function(a){return a&&a.__esModule?a:{default:a}}},78816,a=>{"use strict";var b=a.i(72131);a.s(["useScrollToTop",0,()=>{(0,b.useEffect)(()=>{window.scrollTo(0,0)},[])}])},32245,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"BailoutToCSR",{enumerable:!0,get:function(){return e}});let d=a.r(41997);function e({reason:a,children:b}){throw Object.defineProperty(new d.BailoutToCSRError(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0})}},7773,(a,b,c)=>{"use strict";function d(a){return a.split("/").map(a=>encodeURIComponent(a)).join("/")}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"encodeURIPath",{enumerable:!0,get:function(){return d}})},97458,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"PreloadChunks",{enumerable:!0,get:function(){return h}});let d=a.r(87924),e=a.r(35112),f=a.r(56704),g=a.r(7773);function h({moduleIds:a}){let b=f.workAsyncStorage.getStore();if(void 0===b)return null;let c=[];if(b.reactLoadableManifest&&a){let d=b.reactLoadableManifest;for(let b of a){if(!d[b])continue;let a=d[b].files;c.push(...a)}}return 0===c.length?null:(0,d.jsx)(d.Fragment,{children:c.map(a=>{let c=`${b.assetPrefix}/_next/${(0,g.encodeURIPath)(a)}`;return a.endsWith(".css")?(0,d.jsx)("link",{precedence:"dynamic",href:c,rel:"stylesheet",as:"style",nonce:b.nonce},a):((0,e.preload)(c,{as:"script",fetchPriority:"low",nonce:b.nonce}),null)})})}},69853,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return j}});let d=a.r(87924),e=a.r(72131),f=a.r(32245),g=a.r(97458);function h(a){return{default:a&&"default"in a?a.default:a}}let i={loader:()=>Promise.resolve(h(()=>null)),loading:null,ssr:!0},j=function(a){let b={...i,...a},c=(0,e.lazy)(()=>b.loader().then(h)),j=b.loading;function k(a){let h=j?(0,d.jsx)(j,{isLoading:!0,pastDelay:!0,error:null}):null,i=!b.ssr||!!b.loading,k=i?e.Suspense:e.Fragment,l=b.ssr?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.PreloadChunks,{moduleIds:b.modules}),(0,d.jsx)(c,{...a})]}):(0,d.jsx)(f.BailoutToCSR,{reason:"next/dynamic",children:(0,d.jsx)(c,{...a})});return(0,d.jsx)(k,{...i?{fallback:h}:{},children:l})}return k.displayName="LoadableComponent",k}},19721,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return e}});let d=a.r(33354)._(a.r(69853));function e(a,b){let c={};"function"==typeof a&&(c.loader=a);let e={...c,...b};return(0,d.default)({...e,modules:e.loadableGenerated?.modules})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},83584,a=>{"use strict";var b=a.i(87924);let c=({title:a,children:c})=>(0,b.jsxs)("div",{className:"relative flex w-full flex-col items-center rounded-xl bg-white p-6 shadow-md transition-all hover:shadow-lg z-10",children:[(0,b.jsx)("div",{className:"mb-4 w-full",children:(0,b.jsxs)("h2",{className:"relative inline-block text-xl font-bold text-gray-800 select-none",children:[a,(0,b.jsx)("span",{className:"absolute -bottom-1 left-0 h-1 w-1/2 rounded-full bg-primary-300"})]})}),c]});var d=a.i(4348),e=a.i(10584),f=a.i(73651),g=a.i(90419),h=a.i(78816),i=a.i(32888),j=a.i(71336);let k=(a,b,c,d,e)=>{let f=[],g=[],h=[];return a.forEach(({label:a})=>{let i=b.get(a)??l();f.push({id:a,name:a,value:i.total,necessary:i.necessary,unnecessary:i.unnecessary,color:c}),g.push({name:a,value:i.necessaryList.reduce((a,b)=>a+b,0),color:d}),h.push({name:a,value:i.unnecessaryList.reduce((a,b)=>a+b,0),color:e})}),{results:f,necessaryList:g,unnecessaryList:h}},l=()=>({necessary:0,unnecessary:0,necessaryList:[],unnecessaryList:[],total:0});var m=a.i(68428),n=a.i(19721),o=a.i(72131),p=a.i(90768);let q=({title:a,total:c,list:d,options:e={headerStyle:"bg-gray-200"}})=>(0,b.jsxs)("div",{className:"flex w-full flex-col gap-2 whitespace-nowrap",children:[(0,b.jsx)("h3",{className:"font-semibold",children:a}),(0,b.jsxs)("table",{className:"w-full border-collapse text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:e.headerStyle,children:[(0,b.jsx)("th",{className:"border border-solid border-gray-300 border-r-transparent px-2 py-1 text-center",children:"類型"}),(0,b.jsx)("th",{className:"border border-solid border-gray-300 border-r-transparent px-2 py-1 text-right",children:"比例 (%)"}),(0,b.jsx)("th",{className:"border border-solid border-gray-300 px-2 py-1 text-right",children:"金額 (NTD)"})]})}),(0,b.jsx)("tbody",{children:d.map(a=>(0,b.jsxs)("tr",{className:0===a.value?"text-gray-300":"",children:[(0,b.jsx)("td",{className:"col-span-1 border border-solid border-gray-300 p-2 text-center",children:a.name}),(0,b.jsxs)("td",{className:"col-span-1 border border-solid border-gray-300 p-2 text-end",children:[0===a.value?0:(Math.round(a.value/c*100)||0).toFixed(0),"%"]}),(0,b.jsxs)("td",{className:"col-span-2 border border-solid border-gray-300 p-2 text-end",children:["$",(0,p.normalizeNumber)(a.value)]})]},`income-${a.name}`))})]})]}),r=j.OUTCOME_TYPE_MAP.map(({label:a})=>({name:a,value:0})),s=j.INCOME_TYPE_MAP.map(({label:a})=>({name:a,value:0})),t=a=>{let[c,d]=(0,o.useState)(r),[e,f]=(0,o.useState)(s),g=(0,o.useMemo)(()=>a.totalIncome+a.totalOutcome,[a.totalIncome,a.totalOutcome]),h=(0,o.useMemo)(()=>100*a.totalOutcome/(g||100),[a.totalOutcome,g]),i=(0,o.useMemo)(()=>100*a.totalIncome/(g||100),[a.totalIncome,g]);return(0,o.useEffect)(()=>{a.outcomeList.length>0&&d(b=>b.map((b,c)=>({...b,value:a.outcomeList[c].value})))},[a.outcomeList]),(0,o.useEffect)(()=>{a.incomeList.length>0&&f(b=>b.map((b,c)=>({...b,value:a.incomeList[c].value})))},[a.incomeList]),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(q,{title:`支出各項資訊 $${(0,p.normalizeNumber)(a.totalOutcome)}（${h.toFixed(0)}%）`,total:a.totalOutcome,list:c,options:{headerStyle:"bg-red-500/30"}}),(0,b.jsx)(q,{title:`收入各項資訊 $${(0,p.normalizeNumber)(a.totalIncome)}（${i.toFixed(0)}%）`,total:a.totalIncome,list:e,options:{headerStyle:"bg-green-500/30"}})]})},u=j.OUTCOME_TYPE_MAP.map(({label:a})=>({name:a,value:0})),v=a=>{let[c,d]=(0,o.useState)(u),[e,f]=(0,o.useState)(u),g=(0,o.useMemo)(()=>a.totalNecessary+a.totalUnnecessary,[a.totalNecessary,a.totalUnnecessary]),h=(0,o.useMemo)(()=>100*a.totalUnnecessary/(g||100),[a.totalUnnecessary,g]),i=(0,o.useMemo)(()=>100*a.totalNecessary/(g||100),[a.totalNecessary,g]);return(0,o.useEffect)(()=>{a.unnecessaryList.length>0&&f(b=>b.map((b,c)=>({...b,value:a.unnecessaryList[c].value})))},[a.unnecessaryList]),(0,o.useEffect)(()=>{a.necessaryList.length>0&&d(b=>b.map((b,c)=>({...b,value:a.necessaryList[c].value})))},[a.necessaryList]),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(q,{title:`必要支出各項資訊 $${(0,p.normalizeNumber)(a.totalNecessary)}（${i.toFixed(0)}%）`,total:a.totalNecessary,list:c,options:{headerStyle:"bg-orange-500/30"}}),(0,b.jsx)(q,{title:`額外支出各項資訊 $${(0,p.normalizeNumber)(a.totalUnnecessary)}（${h.toFixed(0)}%）`,total:a.totalUnnecessary,list:e,options:{headerStyle:"bg-gray-500/30"}})]})},w=(0,n.default)(async()=>{},{loadableGenerated:{modules:[50790]},ssr:!1,loading:()=>(0,b.jsx)("div",{className:"mx-auto mt-15 aspect-square size-45 rounded-full bg-gray-200 p-1.5",children:(0,b.jsx)("div",{className:"bg-background size-full rounded-full p-1.5",children:(0,b.jsx)("div",{className:"size-full rounded-full bg-gray-200 p-5",children:(0,b.jsx)("div",{className:"bg-background size-full rounded-full"})})})})}),x=(0,n.default)(async()=>{},{loadableGenerated:{modules:[75689]},ssr:!1,loading:()=>(0,b.jsx)("div",{className:"mx-auto mt-15 aspect-square size-45 rounded-full bg-gray-200 p-1.5",children:(0,b.jsx)("div",{className:"bg-background size-full rounded-full p-1.5",children:(0,b.jsx)("div",{className:"size-full rounded-full bg-gray-200 p-5",children:(0,b.jsx)("div",{className:"bg-background size-full rounded-full"})})})})});a.s(["ChartBlock",0,()=>{(0,h.useScrollToTop)();let{config:a}=(0,g.useUserConfigCtx)(),{data:n,syncData:p}=(0,f.useGetSpendingCtx)(),{currentGroup:q}=(0,e.useGroupCtx)(),[r,s]=(0,o.useState)({income:{list:[],total:100,necessary:50,unnecessary:50,necessaryList:[],unnecessaryList:[]},outcome:{list:[],total:50,necessary:25,unnecessary:25,necessaryList:[],unnecessaryList:[]}}),u=new Date,y=(0,i.useYearMonth)(u),z=(0,o.useCallback)((b,c,d)=>{let{startDate:e,endDate:f}=(0,m.getStartEndOfMonth)(new Date(Number(c),Number(d)-1));p(b,a?.email,e.toISOString(),f.toISOString())},[p,a?.email]);return(0,o.useEffect)(()=>{(0,o.startTransition)(()=>{s((a=>{var b;let c,d,e,f,g,h,i,m,{incomeResult:n,totalIncome:o,necessaryIncome:p,unnecessaryIncome:q,outcomeResult:r,totalOutcome:s,necessaryOutcome:t,unnecessaryOutcome:u}=(b=a,c=new Map,d=0,e=0,f=0,g=new Map,h=0,i=0,m=0,b.forEach(a=>{if(a.type===j.SpendingType.Income){let b=j.INCOME_TYPE_MAP.find(b=>b.value===a.category);if(b){d+=Number(a.amount);let g=c.get(b.label)??l();a.necessity===j.Necessity.Need?(e+=Number(a.amount),g={...g,necessary:g.necessary+Number(a.amount),necessaryList:[...g.necessaryList,Number(a.amount)]}):(f+=Number(a.amount),g={...g,unnecessary:g.unnecessary+Number(a.amount),unnecessaryList:[...g.unnecessaryList,Number(a.amount)]}),c.set(b.label,{...g,total:g.total+Number(a.amount)})}}else{let b=j.OUTCOME_TYPE_MAP.find(b=>b.value===a.category);if(b){h+=Number(a.amount);let c=g.get(b.label)??l();a.necessity===j.Necessity.Need?(i+=Number(a.amount),c={...c,necessary:c.necessary+Number(a.amount),necessaryList:[...c.necessaryList,Number(a.amount)]}):(m+=Number(a.amount),c={...c,unnecessary:c.unnecessary+Number(a.amount),unnecessaryList:[...c.unnecessaryList,Number(a.amount)]}),g.set(b.label,{...c,total:c.total+Number(a.amount)})}}}),{incomeResult:c,totalIncome:d,necessaryIncome:e,unnecessaryIncome:f,outcomeResult:g,totalOutcome:h,necessaryOutcome:i,unnecessaryOutcome:m}),{results:v,necessaryList:w,unnecessaryList:x}=k(j.INCOME_TYPE_MAP,n,"#82ca9d","#fdba74","#d1d5db"),{results:y,necessaryList:z,unnecessaryList:A}=k(j.OUTCOME_TYPE_MAP,r,"#faa5a5","#fdba74","#d1d5db");return{income:{total:o,necessary:p,unnecessary:q,necessaryList:w,unnecessaryList:x,list:v},outcome:{total:s,necessary:t,unnecessary:u,necessaryList:z,unnecessaryList:A,list:y}}})(n.filter(a=>`${new Date(a.date).getFullYear()}`===y.year&&`${new Date(a.date).getMonth()+1}`===y.month)))})},[n,y.year,y.month]),(0,b.jsxs)("div",{className:"content-wrapper",children:[(0,b.jsx)(d.YearMonthFilter,{refreshData:z,group:q,dateOptions:y,className:"flex self-center rounded-lg border border-gray-200 bg-white p-2 text-base shadow-sm"}),(0,b.jsxs)("div",{className:"flex w-full flex-col items-center gap-8 md:flex-row md:items-start",children:[(0,b.jsx)(c,{title:"收支類別比例",children:(0,b.jsxs)("div",{className:"flex w-full flex-wrap justify-center gap-4",children:[(0,b.jsx)("div",{className:"size-75",children:(0,b.jsx)(w,{totalIncome:r.income.total,totalOutcome:r.outcome.total,list:[...r.outcome.list,...r.income.list]})}),(0,b.jsx)("div",{className:"flex flex-1 flex-col gap-4",children:(0,b.jsx)(t,{totalIncome:r.income.total,totalOutcome:r.outcome.total,incomeList:r.income.list,outcomeList:r.outcome.list})})]})}),(0,b.jsx)(c,{title:"支出類別比例（必要 vs 額外）",children:(0,b.jsxs)("div",{className:"flex w-full flex-wrap justify-center gap-4",children:[(0,b.jsx)("div",{className:"size-75",children:(0,b.jsx)(x,{totalNecessity:r.outcome.necessary,totalUnnecessity:r.outcome.unnecessary,list:[...r.outcome.necessaryList,...r.outcome.unnecessaryList]})}),(0,b.jsx)("div",{className:"flex flex-1 flex-col gap-4",children:(0,b.jsx)(v,{totalNecessary:r.outcome.necessary,totalUnnecessary:r.outcome.unnecessary,necessaryList:r.outcome.necessaryList,unnecessaryList:r.outcome.unnecessaryList})})]})})]})]})}],83584)}];

//# sourceMappingURL=_eee981d4._.js.map