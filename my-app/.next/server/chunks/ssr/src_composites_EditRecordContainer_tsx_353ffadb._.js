module.exports=[63236,a=>{"use strict";var b=a.i(87924),c=a.i(73651),d=a.i(71336),e=a.i(50944),f=a.i(72131),g=a.i(54799);let h=new Uint8Array(256),i=h.length;function j(){return i>h.length-16&&((0,g.randomFillSync)(h),i=0),h.slice(i,i+=16)}let k=[];for(let a=0;a<256;++a)k.push((a+256).toString(16).slice(1));let l={};function m(a,b,c,d,e=0){if(a.length<16)throw Error("Random bytes length must be >= 16");if(d){if(e<0||e+16>d.length)throw RangeError(`UUID byte range ${e}:${e+15} is out of buffer bounds`)}else d=new Uint8Array(16),e=0;return b??=Date.now(),c??=127*a[6]<<24|a[7]<<16|a[8]<<8|a[9],d[e++]=b/0x10000000000&255,d[e++]=b/0x100000000&255,d[e++]=b/0x1000000&255,d[e++]=b/65536&255,d[e++]=b/256&255,d[e++]=255&b,d[e++]=112|c>>>28&15,d[e++]=c>>>20&255,d[e++]=128|c>>>14&63,d[e++]=c>>>6&255,d[e++]=c<<2&255|3&a[10],d[e++]=a[11],d[e++]=a[12],d[e++]=a[13],d[e++]=a[14],d[e++]=a[15],d}let n=function(a,b,c){let d;if(a)d=m(a.random??a.rng?.()??j(),a.msecs,a.seq,b,c);else{var e,f,g;let a=Date.now(),h=j();e=l,f=a,g=h,e.msecs??=-1/0,e.seq??=0,f>e.msecs?(e.seq=g[6]<<23|g[7]<<16|g[8]<<8|g[9],e.msecs=f):(e.seq=e.seq+1|0,0===e.seq&&e.msecs++),d=m(h,l.msecs,l.seq,b,c)}return b??function(a,b=0){return(k[a[b+0]]+k[a[b+1]]+k[a[b+2]]+k[a[b+3]]+"-"+k[a[b+4]]+k[a[b+5]]+"-"+k[a[b+6]]+k[a[b+7]]+"-"+k[a[b+8]]+k[a[b+9]]+"-"+k[a[b+10]]+k[a[b+11]]+k[a[b+12]]+k[a[b+13]]+k[a[b+14]]+k[a[b+15]]).toLowerCase()}(d)};var o=a.i(2211),p=a.i(78653);let q=a=>{let{init:c=new Date,format:e,className:g,labelClassName:h}=a,i=(0,f.useRef)(null),{date:j,setDate:k}=(0,p.useDateCtx)(),[l,m]=(0,f.useState)(c.getFullYear()),[n,q]=(0,f.useState)(c.getFullYear()),[r,s]=(0,f.useState)(c.getFullYear()),[t,u]=(0,f.useState)(c.getFullYear());(0,f.useEffect)(()=>{m(j.getFullYear()),q(j.getMonth()),s(j.getDate()),u(j.getDay())},[j]);let v=(0,f.useMemo)(()=>"yyyy-mm-dd"===e?`${l}-${n+1}-${r}`:"yyyy/mm/dd"===e?`${l}/${n+1}/${r}`:`${l} å¹´ ${n+1} æœˆ ${r} æ—¥ï¼ˆé€±${d.WEEKDAY[t]}ï¼‰`,[l,n,r,t,e]);return(0,b.jsxs)("div",{className:`relative flex items-center ${g}`,children:[(0,b.jsx)("input",{ref:i,type:"date",className:"absolute top-0 right-0 bottom-0 left-0 opacity-0",onChange:a=>{k(new Date(a.target.value))}}),(0,b.jsxs)("button",{type:"button",className:`z-20 flex w-full items-center justify-between gap-4 ${h}`,onClick:()=>{i.current&&(i.current.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),i.current.focus(),i.current.click(),i.current.showPicker())},children:[(0,b.jsx)("span",{children:v}),(0,b.jsx)(o.CalendarIcon,{className:"size-4"})]})]})};var r=a.i(1270),s=a.i(28268);let t=a=>(0,b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-backspace",viewBox:"0 0 16 16",...a,children:[(0,b.jsx)("path",{d:"M5.83 5.146a.5.5 0 0 0 0 .708L7.975 8l-2.147 2.146a.5.5 0 0 0 .707.708l2.147-2.147 2.146 2.147a.5.5 0 0 0 .707-.708L9.39 8l2.146-2.146a.5.5 0 0 0-.707-.708L8.683 7.293 6.536 5.146a.5.5 0 0 0-.707 0z"}),(0,b.jsx)("path",{d:"M13.683 1a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-7.08a2 2 0 0 1-1.519-.698L.241 8.65a1 1 0 0 1 0-1.302L5.084 1.7A2 2 0 0 1 6.603 1zm-7.08 1a1 1 0 0 0-.76.35L1 8l4.844 5.65a1 1 0 0 0 .759.35h7.08a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1z"})]}),u=["7","8","9","4","5","6","1","2","3","clear","0","delete"],v=a=>{let{default:c=0,onChange:d=console.log}=a,[e,g]=(0,f.useState)(c.toString()),h=a=>{"clear"===a?g("0"):"delete"===a?g(a=>1===a.length?"0":a.slice(0,a.length-1)):g(b=>"0"===b?a:b+a)};return(0,f.useEffect)(()=>{d(Number(e))},[e,d]),(0,b.jsx)("div",{className:"grid grid-cols-3 grid-rows-4 gap-1 text-sm sm:text-base",children:u.map((a,c)=>(0,b.jsxs)(w,{value:a,className:"col-span-1",style:{gridRow:Math.floor(c/4)+1},onClick:h,children:["delete"===a&&(0,b.jsx)(t,{className:"size-4"}),"clear"===a&&"C","."===a&&(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-dot",viewBox:"0 0 16 16",children:(0,b.jsx)("path",{d:"M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3"})}),"delete"!==a&&"clear"!==a&&"."!==a&&a]},a))})};v.displayName="NumberKeyboard";let w=a=>(0,b.jsx)("button",{type:"button",className:`${a.className} active:bg-background-gray hover:bg-background-gray bg-background flex items-center justify-center rounded-lg border border-solid border-gray-300 px-6 py-3 transition-colors select-none`,onClick:()=>a.onClick(a.value),children:(0,b.jsx)("span",{children:a.children})});var x=a.i(41879),y=a.i(87586);let z=a=>{let{option1:c,option2:d,value:e,className:g="",onChange:h}=a,i=(0,f.useRef)(null),j=(0,f.useRef)(null),k=(0,f.useRef)(null),l=(0,f.useRef)(null),m=(0,f.useCallback)(()=>{(0,f.startTransition)(()=>{e===c.value?h(d.value):h(c.value)})},[h,e,c.value,d.value]);return(0,f.useEffect)(()=>{let a=i.current,b=j.current,d=k.current,f=l.current;requestAnimationFrame(()=>{if(a&&b&&d&&f){let a=b.offsetWidth,g=d.offsetWidth,h=b.offsetLeft,i=d.offsetLeft;e===c.value?(f.style.left=`${h}px`,f.style.width=`${a}px`,b.style.color="white",d.style.color=y.GRAY_COLORS[500]):(f.style.left=`${i}px`,f.style.width=`${g}px`,d.style.color="white",b.style.color=y.GRAY_COLORS[500])}})},[c.value,e]),(0,b.jsxs)("button",{ref:i,type:"button",onClick:m,className:`relative flex w-fit items-center rounded-md p-1 ${g}`,children:[(0,b.jsx)("div",{ref:l,className:"transition-spring bg-primary-500 absolute top-1 bottom-1 z-10 rounded transition-all"}),(0,b.jsx)("span",{ref:j,className:"z-20 flex-1 bg-transparent px-2 py-1 text-center font-normal transition-colors",children:c.label}),(0,b.jsx)("span",{ref:k,className:"z-20 flex-1 bg-transparent px-2 py-1 text-center font-normal transition-colors",children:d.label})]})};var A=a.i(62566),B=a.i(10584),C=a.i(90419),D=a.i(22283),E=a.i(48372),F=a.i(8038),G=a.i(68428),H=a.i(90768);let I=a=>{let{data:e,isNewData:g,onClose:h}=a,{config:i,setter:j,syncUser:k}=(0,C.useUserConfigCtx)(),{syncData:l}=(0,c.useGetSpendingCtx)(),{currentGroup:m}=(0,B.useGroupCtx)(),{date:o}=(0,p.useDateCtx)(),{getCategoryDescriptions:t,addCategoryDescription:u,removeCategoryDescription:w,syncFavorites:y}=(0,A.useFavoriteCategoriesCtx)(),[I,J]=(0,f.useState)(e.type),[K,L]=(0,f.useState)(e.necessity),[M,N]=(0,f.useState)(e.category),[O,P]=(0,f.useState)(e.description),[Q,R]=(0,f.useState)(Number(e.amount)),[S,T]=(0,f.useState)(!1),[U,V]=(0,f.useState)(!1),[W,X]=(0,f.useState)(e.type===d.SpendingType.Income?d.INCOME_TYPE_MAP:d.OUTCOME_TYPE_MAP),[Y,Z]=(0,f.useState)(!1),$=(0,f.useMemo)(()=>W.find(a=>a.value===M)?.label,[M,W]),_=(0,f.useMemo)(()=>t(M),[M,t]),aa=(0,f.useMemo)(()=>!_.includes(O),[O,_]),ab=(0,f.useCallback)(async a=>{if(i?.user_id&&""!==O){Z(!0);try{a?await u(M,O,i.user_id):await w(M,O,i.user_id)}catch(a){console.error("æ›´æ–°å¸¸ç”¨æè¿°å¤±æ•—:",a),alert("æ›´æ–°å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦")}finally{Z(!1)}}},[i?.user_id,O,M,u,w]);(0,f.useEffect)(()=>{i?.user_id&&y(i.user_id)},[i?.user_id,y]);let ac=(0,f.useCallback)(()=>{h&&h()},[h]),ad=(0,f.useCallback)(async a=>{a.preventDefault();let b=i?.email;if(!b)return;if(0===Q)return void T(!0);V(!0);let c={...e,id:e.id||n(),"user-token":b,groupId:m?.account_id?String(m.account_id):void 0,type:I,date:o.toISOString(),necessity:K,category:M,description:O,amount:Q.toString()};await (0,D.putItem)(c);let{startDate:d,endDate:f}=(0,G.getStartEndOfMonth)(o);l(m?.account_id?String(m.account_id):void 0,b,d.toISOString(),f.toISOString()),V(!1),h&&h()},[Q,m?.account_id,e,o,O,K,h,M,I,l,i?.email]);return(0,f.useEffect)(()=>{0!==Q&&T(!1)},[Q]),(0,b.jsx)(s.Modal,{defaultOpen:!0,onClose:ac,className:"flex w-full flex-col self-end sm:max-w-96 sm:self-center sm:rounded-xl",title:g?"æ–°å¢žå¸³ç›®":"ç·¨è¼¯å¸³ç›®",children:(0,b.jsxs)("form",{className:"flex w-full flex-1 flex-col gap-4",onSubmit:ad,children:[(0,b.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,b.jsx)(z,{option1:{label:"æ”¯å‡º",value:d.SpendingType.Outcome},option2:{label:"æ”¶å…¥",value:d.SpendingType.Income},value:I,className:"h-10 flex-1 border border-solid border-gray-300 text-sm",onChange:a=>{J(a);let b=(0,F.getSpendingCategoryMap)(a);X(b),N(b[0].value)}}),(0,b.jsx)(z,{option1:{label:I===d.SpendingType.Outcome?"å¿…è¦æ”¯å‡º":"å¿…è¦æ”¶å…¥",value:d.Necessity.Need},option2:{label:I===d.SpendingType.Outcome?"é¡å¤–æ”¯å‡º":"é¡å¤–æ”¶å…¥",value:d.Necessity.NotNeed},value:K,className:"h-10 flex-1 border border-solid border-gray-300 text-sm",onChange:L})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,b.jsx)("fieldset",{className:"flex-1",children:(0,b.jsx)(x.Select,{name:"category",value:M,label:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,E.getCategoryIcon)(M),(0,b.jsx)("span",{children:$})]}),onChange:N,className:"h-10 w-full rounded-md border border-solid border-gray-300 px-3 py-1 transition-colors hover:border-gray-500 active:border-gray-500",children:W.map(a=>(0,b.jsx)(x.Select.Item,{value:a.value,children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,E.getCategoryIcon)(a.value),(0,b.jsx)("span",{children:a.label})]})},a.value))})}),(0,b.jsx)(q,{className:"h-10 flex-1 rounded-md border border-solid border-gray-300 bg-transparent",labelClassName:"text-base px-2 py-1",format:"yyyy/mm/dd",init:new Date(e.date)})]}),(0,b.jsxs)("div",{className:"group flex w-full items-center",children:[(0,b.jsx)("fieldset",{className:"flex-1",children:(0,b.jsx)("input",{type:"text",id:"description",name:"description",className:"h-10 w-full rounded-md rounded-r-none border border-r-0 border-solid border-gray-300 px-2 py-1 transition-colors group-hover:border-gray-500 group-active:border-gray-500 focus:outline-0",autoComplete:"off",placeholder:"æè¿°",onChange:a=>{P(a.target.value)},value:O})}),(0,b.jsx)("fieldset",{className:"w-10",children:(0,b.jsxs)(x.Select,{name:"category",onChange:P,className:"h-10 w-10 justify-center rounded-md rounded-l-none border border-l-0 border-solid border-gray-300 px-3 py-1 transition-colors group-hover:border-gray-500 group-active:border-gray-500",menuStyle:"min-w-24",children:[_.map(a=>(0,b.jsx)(x.Select.Item,{value:a,className:"justify-center",children:(0,b.jsx)("span",{children:a})},a)),0===_.length&&(0,b.jsx)(x.Select.Item,{value:"",className:"justify-center",children:(0,b.jsx)("span",{children:"å°šæœªè¨­å®š"})})]})})]}),(0,b.jsx)("button",{type:"button",disabled:""===O||Y,className:`border-text bg-text text-background w-full rounded-lg border border-solid p-2 font-semibold transition-colors hover:bg-gray-800 active:bg-gray-800 disabled:!cursor-not-allowed disabled:border-gray-300 disabled:bg-gray-300 disabled:text-gray-500 ${""===O?"hidden":""}`,onClick:()=>ab(aa),children:Y?"æ›´æ–°è³‡æ–™ä¸­...":aa?"+ æ–°å¢žå¸¸ç”¨æè¿°":"- åˆªé™¤å¸¸ç”¨æè¿°"})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsxs)("div",{className:`flex w-full items-center rounded-md border border-solid bg-white px-2 ${S?"border-red-500":"border-gray-300"}`,children:[(0,b.jsx)("span",{className:"text-sm text-gray-500",children:"é‡‘é¡"}),(0,b.jsx)("input",{type:"text",className:"h-10 flex-1 bg-transparent py-1 text-end focus:outline-0 focus-visible:outline-0",value:(0,H.normalizeNumber)(Q),readOnly:!0})]}),(0,b.jsx)(v,{default:Number(e.amount),onChange:R})]}),(0,b.jsxs)("div",{className:"flex w-full flex-1 items-end justify-between py-2",children:[(0,b.jsx)("button",{disabled:U,type:"button",onClick:ac,className:"bg-background flex w-24 items-center justify-center rounded-lg border border-solid border-gray-300 p-2 text-gray-300 transition-colors hover:border-gray-500 hover:text-gray-500 active:border-gray-500 active:text-gray-500",children:(0,b.jsx)("span",{children:"å–æ¶ˆ"})}),(0,b.jsxs)("button",{disabled:U,type:"submit",className:"submit-button flex w-36 items-center justify-center",children:[U&&(0,b.jsx)(r.Loading,{className:"size-6 animate-spin py-1 text-white"}),!U&&(0,b.jsx)("span",{children:"é€å‡º"})]})]})]})})};a.s(["default",0,({recordId:a})=>{let g=(0,e.useRouter)(),[h,i]=(0,f.useState)(),{data:j}=(0,c.useGetSpendingCtx)(),[k,l]=(0,f.useState)(!1),[m,o]=(0,f.useState)(!1),p=(0,f.useCallback)(()=>{i(void 0),l(!1),o(!1),g.back()},[g]);return((0,f.useEffect)(()=>{if(!m){let b={id:n(),"user-token":"",category:"ðŸ”",necessity:d.Necessity.Need,type:d.SpendingType.Outcome,amount:"0",description:"",date:new Date().toISOString()};if(a){if(j.length>0){let c=j.find(b=>b.id===a);l(void 0!==c),c&&(b={...b,...c}),i(b)}}else i(b);o(!0)}},[a,j,m]),m&&h)?(0,b.jsx)(I,{data:h,isNewData:!k,onClose:p}):null}],63236)}];

//# sourceMappingURL=src_composites_EditRecordContainer_tsx_353ffadb._.js.map