{"version":3,"sources":["../../../../src/utils/handleCookie.ts","../../../../src/context/SpendingProvider.tsx","../../../../src/utils/getStartEndOfMonth.ts","../../../../src/services/getRecords.ts","../../../../src/hooks/useFocusRef.ts","../../../../node_modules/%40swc/helpers/cjs/_interop_require_wildcard.cjs","../../../../src/utils/constants.ts","../../../../src/hooks/useIDB.ts","../../../../src/services/groupServices.ts","../../../../src/context/GroupProvider.tsx"],"sourcesContent":["interface CookieOptions {\n  expires?: number | Date;\n  path?: string;\n  domain?: string;\n  secure?: boolean;\n  sameSite?: 'Strict' | 'Lax' | 'None';\n}\n\n/**\n * Ë®≠ÂÆö Cookie\n * @param name - Cookie ÂêçÁ®±\n * @param value - Cookie ÂÄº\n * @param options - Cookie ÈÅ∏È†Ö\n */\nexport function setCookie(\n  name: string,\n  value: string,\n  options: CookieOptions = {},\n): void {\n  let cookieString = `${encodeURIComponent(name)}=${encodeURIComponent(value)}`;\n\n  if (options.expires) {\n    const expires =\n      options.expires instanceof Date\n        ? options.expires\n        : new Date(Date.now() + options.expires * 24 * 60 * 60 * 1000);\n    cookieString += `; expires=${expires.toUTCString()}`;\n  }\n\n  if (options.path) {\n    cookieString += `; path=${options.path}`;\n  }\n\n  if (options.domain) {\n    cookieString += `; domain=${options.domain}`;\n  }\n\n  if (options.secure) {\n    cookieString += '; secure';\n  }\n\n  if (options.sameSite) {\n    cookieString += `; samesite=${options.sameSite}`;\n  }\n\n  document.cookie = cookieString;\n}\n\n/**\n * ÂèñÂæó Cookie ÂÄº\n * @param name - Cookie ÂêçÁ®±\n * @returns Cookie ÂÄºÔºåÂ¶ÇÊûú‰∏çÂ≠òÂú®ÂâáËøîÂõû null\n */\nexport function getCookie(name: string): string | null {\n  const nameEQ = encodeURIComponent(name) + '=';\n  const cookies = document.cookie.split(';');\n\n  for (let i = 0; i < cookies.length; i++) {\n    let cookie = cookies[i].trim();\n    if (cookie.startsWith(nameEQ)) {\n      return decodeURIComponent(cookie.substring(nameEQ.length));\n    }\n  }\n\n  return null;\n}\n","'use client';\n\nimport { useIDB } from '@/hooks/useIDB';\nimport { getItems } from '@/services/getRecords';\nimport { getCookie } from '@/utils/handleCookie';\nimport {\n  createContext,\n  ReactNode,\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useReducer,\n  useRef,\n} from 'react';\n\nconst INIT_CTX_VAL: {\n  loading: boolean;\n  data: SpendingRecord[];\n  syncData: (\n    groupId?: string,\n    email?: string,\n    startDate?: string,\n    endDate?: string,\n  ) => void;\n} = {\n  loading: true,\n  data: [],\n  syncData: () => {},\n};\n\nconst reducer = (\n  _: { data: SpendingRecord[]; loading: boolean },\n  action: SpendingRecord[],\n) => {\n  return { data: action, loading: false };\n};\n\nexport const SpendingProvider = ({ children }: { children: ReactNode }) => {\n  const [state, dispatch] = useReducer(reducer, { data: [], loading: true });\n  const {\n    db: IDB,\n    getSpendingData: getDataFromIDB,\n    setSpendingData: setData2IDB,\n  } = useIDB();\n  const controllerRef = useRef<AbortController | null>(null);\n\n  const handleSetState = useCallback((_data: SpendingRecord[]) => {\n    dispatch(_data);\n  }, []);\n\n  const queryItem = useCallback(\n    (\n      email?: string,\n      groupId?: string,\n      startDate?: string,\n      endDate?: string,\n    ) => {\n      if (!email && !groupId) return;\n      getItems(groupId, email, startDate, endDate)\n        .then((res) => {\n          if (controllerRef.current) {\n            controllerRef.current.abort();\n          }\n          console.log('Get Data from API');\n          handleSetState(res.data);\n          setData2IDB(IDB, res.data, Number(groupId), startDate)\n            .then(() => {\n              console.log('Update IDB success.');\n            })\n            .catch((err) => {\n              console.log('Update IDB failed: ', err);\n            });\n        })\n        .catch(console.error);\n    },\n    [IDB, handleSetState, setData2IDB],\n  );\n\n  const syncData = useCallback(\n    (\n      groupId?: string,\n      email?: string,\n      startDate?: string,\n      endDate?: string,\n    ) => {\n      queryItem(email, groupId, startDate, endDate);\n    },\n    [queryItem],\n  );\n\n  const ctxVal = useMemo(\n    () => ({\n      ...state,\n      syncData,\n    }),\n    [state, syncData],\n  );\n\n  useEffect(() => {\n    const controller = (controllerRef.current = new AbortController());\n    const groupId = getCookie('currentGroupId');\n    if (IDB && groupId) {\n      getDataFromIDB(IDB, Number(groupId), controller.signal)\n        .then((res) => {\n          if (res && res.length === 1) {\n            const _data = JSON.parse(res[0].data) as SpendingRecord[];\n            console.log('Get Data from IDB', _data);\n            if (_data.length !== 0) {\n              handleSetState(_data);\n              controllerRef.current = null;\n            }\n          }\n        })\n        .catch((err) => {\n          console.log('Error while syncing data: ', err);\n        });\n    }\n    return () => controller.abort();\n  }, [IDB, getDataFromIDB, handleSetState]);\n\n  return <Ctx.Provider value={ctxVal}>{children}</Ctx.Provider>;\n};\n\nconst Ctx = createContext(INIT_CTX_VAL);\nexport const useGetSpendingCtx = () => useContext(Ctx);\n","export const getStartEndOfMonth = (theDay: string | Date) => {\n  const startDate = new Date(\n    new Date(theDay).getFullYear(),\n    new Date(theDay).getMonth(),\n    1,\n    0,\n    0,\n    0,\n  );\n  const endDate = new Date(\n    new Date(theDay).getFullYear(),\n    new Date(theDay).getMonth() + 1,\n    0,\n    23,\n    59,\n    59,\n  );\n  return { startDate, endDate };\n};\n","const URL = '/api/aurora/items';\n\nexport const getItems = async (\n  groupId?: string,\n  email?: string,\n  startDate?: string,\n  endDate?: string,\n): Promise<{\n  status: boolean;\n  data: SpendingRecord[];\n  message: string;\n}> => {\n  try {\n    const query = new URLSearchParams();\n    if (groupId) {\n      query.set('groupId', groupId);\n    } else if (email) {\n      query.set('email', email);\n    } else {\n      return { status: false, data: [], message: 'Áº∫Â∞ëÁæ§ÁµÑ ID Êàñ‰ø°ÁÆ±Ë≥áË®ä' };\n    }\n    if (startDate) query.set('startDate', startDate);\n    if (endDate) query.set('endDate', endDate);\n    const data = await fetch(`${URL}?${query}`).then((res) => res.json());\n    return { status: true, data, message: 'success' };\n  } catch (error) {\n    console.error(error);\n    return { status: false, data: [], message: 'ÁôºÁîü‰∏çÈ†êÊúüÁöÑÈåØË™§' };\n  }\n};\n\nexport const putItem = async (data: SpendingRecord) => {\n  try {\n    return await fetch(URL, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(data)\n    });\n  } catch (error) {\n    console.error(error);\n    return { status: false, message: 'ÁôºÁîü‰∏çÈ†êÊúüÁöÑÈåØË™§' };\n  }\n};\n\nexport const deleteItem = async (id: string) => {\n  try {\n    return await fetch(`${URL}?id=${id}`, { method: 'DELETE' });\n  } catch (error) {\n    console.error(error);\n    return { status: false, message: 'ÁôºÁîü‰∏çÈ†êÊúüÁöÑÈåØË™§' };\n  }\n};\n","\"use client\";\nimport { useEffect, useRef } from \"react\";\n\nconst useFocusRef = <T extends HTMLElement>(callback: () => void) => {\n  const ref = useRef<T>(null);\n\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (ref.current && !ref.current.contains(event.target as Node)) {\n        callback();\n      }\n    };\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    return () => {\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n    };\n  }, [callback]);\n\n  return ref;\n};\n\nexport default useFocusRef;\n","\"use strict\";\n\nfunction _getRequireWildcardCache(nodeInterop) {\n    if (typeof WeakMap !== \"function\") return null;\n\n    var cacheBabelInterop = new WeakMap();\n    var cacheNodeInterop = new WeakMap();\n\n    return (_getRequireWildcardCache = function(nodeInterop) {\n        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n    })(nodeInterop);\n}\nfunction _interop_require_wildcard(obj, nodeInterop) {\n    if (!nodeInterop && obj && obj.__esModule) return obj;\n    if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") return { default: obj };\n\n    var cache = _getRequireWildcardCache(nodeInterop);\n\n    if (cache && cache.has(obj)) return cache.get(obj);\n\n    var newObj = { __proto__: null };\n    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n    for (var key in obj) {\n        if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n            if (desc && (desc.get || desc.set)) Object.defineProperty(newObj, key, desc);\n            else newObj[key] = obj[key];\n        }\n    }\n\n    newObj.default = obj;\n\n    if (cache) cache.set(obj, newObj);\n\n    return newObj;\n}\nexports._ = _interop_require_wildcard;\n","export enum Route {\n  Base = '/',\n  Insert = '/transactions',\n  List = '/analysis',\n  Budget = '/budget',\n  Login = '/login',\n  Group = '/group',\n  Setting = '/setting',\n}\n\nexport const MENU_CONFIG: Record<string, string> = {\n  [Route.Base]: 'È¶ñÈ†Å',\n  [Route.Insert]: 'Â∏≥ÁõÆ',\n  [Route.Group]: 'Â∏≥Êú¨',\n  [Route.List]: 'ÂàÜÊûê',\n  [Route.Budget]: 'È†êÁÆó',\n};\n\nexport const PAGE_TITLE: Record<string, string> = {\n  [Route.Base]: 'È¶ñÈ†Å',\n  [Route.Insert]: 'Â∏≥ÁõÆÁÄèË¶Ω',\n  [Route.Group]: 'Â∏≥Êú¨ÁÆ°ÁêÜ',\n  [Route.List]: 'Ê∂àË≤ªÂàÜÊûê',\n  [Route.Budget]: 'È†êÁÆóË¶èÂäÉ',\n  [Route.Login]: 'ÊúÉÂì°ÁôªÂÖ•',\n  [Route.Setting]: 'Ë®≠ÂÆö',\n};\n\nexport enum SpendingType {\n  Income = 'Income',\n  Outcome = 'Outcome',\n}\n\nexport enum Necessity {\n  Need = 'ÂøÖ',\n  NotNeed = 'Èùû',\n}\n\nconst INCOME_TYPE_OPTIONS = ['üìà', 'üí∞', 'üéÅ', '‚ú®'];\nconst INCOME_WORDINGS = ['ÊäïË≥á', 'Ëñ™Ë≥á', 'ÁçéÈáë', 'ÂÖ∂‰ªñ'];\nexport const INCOME_TYPE_MAP = INCOME_TYPE_OPTIONS.map((option, index) => ({\n  value: option,\n  label: INCOME_WORDINGS[index],\n}));\n\nconst OUTCOME_TYPE_OPTIONS = [\n  'üçî',\n  'üëó',\n  'üè†',\n  'üöó',\n  'üìö',\n  'üé≤',\n  'üßª',\n  'üíä',\n  'üìâ',\n  '‚ú®',\n];\nconst OUTCOME_WORDINGS = [\n  'È£≤È£ü',\n  'ÊúçÈ£æ',\n  '‰ΩèÂÆø',\n  '‰∫§ÈÄö',\n  'Â≠∏Áøí',\n  'Â®õÊ®Ç',\n  'Êó•Â∏∏',\n  'ÈÜ´ÁôÇ',\n  'ÊäïË≥á',\n  'ÂÖ∂‰ªñ',\n];\nexport const OUTCOME_TYPE_MAP = OUTCOME_TYPE_OPTIONS.map((option, index) => ({\n  value: option,\n  label: OUTCOME_WORDINGS[index],\n}));\n\nexport const CATEGORY_WORDING_MAP: Record<string, string> = {\n  'üçî': 'È£≤È£ü',\n  'üëó': 'ÊúçÈ£æ',\n  'üè†': '‰ΩèÂÆø',\n  'üöó': '‰∫§ÈÄö',\n  'üìö': 'Â≠∏Áøí',\n  'üé≤': 'Â®õÊ®Ç',\n  'üßª': 'Êó•Â∏∏',\n  'üíä': 'ÈÜ´ÁôÇ',\n  'üìâ': 'ÊäïË≥á',\n  '‚ú®': 'ÂÖ∂‰ªñ',\n  'üìà': 'ÊäïË≥á',\n  'üí∞': 'Ëñ™Ë≥á',\n  'üéÅ': 'ÁçéÈáë',\n};\n\nexport const WEEKDAY = ['Êó•', '‰∏Ä', '‰∫å', '‰∏â', 'Âõõ', '‰∫î', 'ÂÖ≠'];\n\nexport const DEFAULT_DESC: Record<string, string[]> = {\n  'üçî': ['Êó©È§ê', 'ÂçàÈ§ê', 'ÊôöÈ§ê', 'ÈªûÂøÉ', 'È£≤Êñô'],\n  'üëó': [],\n  'üè†': ['ÊàøÁßü', 'Ê∞¥Ë≤ª', 'ÈõªË≤ª', 'Áì¶ÊñØË≤ª', 'Á∂≤Ë∑ØË≤ª', 'ÊàøË≤∏'],\n  'üöó': ['Âä†Ê≤π', 'Âä†ÂÄº(ÊÇ†ÈÅä)', 'Âä†ÂÄº(È´òÈêµ)'],\n  'üìö': [],\n  'üé≤': [],\n  'üßª': [],\n  'üíä': [],\n  'üìâ': [],\n  'üìà': [],\n  'üí∞': ['Ëñ™Ê∞¥'],\n  'üéÅ': ['ÂÄã‰∫∫Á∏æÊïàÁçéÈáë', 'Âπ¥ÁµÇÁçéÈáë', 'Á¥ÖÂà©ÁçéÈáë', '‰∏âÁØÄÁçéÈáë'],\n  '‚ú®': [],\n};\n\nexport const MONTH_MAP: Record<string, string> = {\n  '1': 'Jan',\n  '2': 'Feb',\n  '3': 'Mar',\n  '4': 'Apr',\n  '5': 'May',\n  '6': 'Jun',\n  '7': 'Jul',\n  '8': 'Aug',\n  '9': 'Sep',\n  '10': 'Oct',\n  '11': 'Nov',\n  '12': 'Dec',\n};\n\nexport const MONTH_LABEL: Record<string, string> = {\n  Jan: '1',\n  Feb: '2',\n  Mar: '3',\n  Apr: '4',\n  May: '5',\n  Jun: '6',\n  Jul: '7',\n  Aug: '8',\n  Sep: '9',\n  Oct: '10',\n  Nov: '11',\n  Dec: '12',\n};\n\nexport const BUDGET_PERIOD_OPTIONS = ['yearly', 'monthly', 'weekly', 'daily'];\nexport const BUDGET_PERIOD_WORDINGS: Record<string, string> = {\n  yearly: 'ÊØèÂπ¥',\n  monthly: 'ÊØèÊúà',\n  weekly: 'ÊØèÈÄ±',\n  daily: 'ÊØèÊó•',\n};\n\nexport const IDB_NAME = 'Expense Tracking';\nexport const IDB_VERSION = 2;\n","'use client';\n\nimport { IDB_NAME, IDB_VERSION } from '@/utils/constants';\nimport { useCallback, useEffect, useState } from 'react';\n\nenum StoreName {\n  UserConfig = 'User Config',\n  ExpenseRecord = 'Expense Record',\n  GroupData = 'Group Data',\n  BudgetData = 'Budget Data',\n}\n\nconst DB_NAME = IDB_NAME;\nconst DB_VERSION = IDB_VERSION;\nconst STORE_NAME = [\n  StoreName.UserConfig,\n  StoreName.ExpenseRecord,\n  StoreName.GroupData,\n  StoreName.BudgetData,\n];\nconst STORE_CONFIG: Record<\n  string,\n  {\n    indexName: string;\n    indexValue: string[];\n  }\n> = {\n  [StoreName.ExpenseRecord]: {\n    // include group_id in the compound index so we can scope queries by group\n    indexName: 'group_year_month',\n    indexValue: ['group_id', 'year', 'month'],\n  },\n  [StoreName.UserConfig]: {\n    indexName: 'email',\n    indexValue: ['email'],\n  },\n  [StoreName.GroupData]: {\n    indexName: 'user_id',\n    indexValue: ['user_id'],\n  },\n  [StoreName.BudgetData]: {\n    indexName: 'account_id',\n    indexValue: ['account_id'],\n  },\n};\n\n// Generic DB record shapes used by the API below\ninterface UserDATA_IDB {\n  id?: number;\n  email: string;\n  data: string;\n}\n\ninterface SpendingDATA_IDB {\n  id?: number;\n  group_id: string | number;\n  year: number;\n  month: number;\n  data: string;\n}\n\ninterface GroupDATA_IDB {\n  id?: number;\n  user_id: number;\n  data: string; // JSON stringified Group[]\n  timestamp: number; // For cache expiration\n}\n\ninterface BudgetDATA_IDB {\n  id?: number;\n  account_id: number;\n  data: string; // JSON stringified Budget\n  timestamp: number; // For cache expiration\n}\n\nexport const useIDB = () => {\n  const [db, setDb] = useState<IDBDatabase | null>(null);\n\n  useEffect(() => {\n    const openRequest = indexedDB.open(DB_NAME, DB_VERSION);\n\n    openRequest.onsuccess = () => {\n      const db = openRequest.result;\n      for (const storeName of STORE_NAME) {\n        if (!db.objectStoreNames.contains(storeName)) {\n          console.error(`Object store ${storeName} does not exist.`);\n          db.close();\n          indexedDB.deleteDatabase(DB_NAME);\n          window.location.reload();\n          return;\n        }\n      }\n      setDb(db);\n    };\n\n    openRequest.onupgradeneeded = () => {\n      const db = openRequest.result;\n      for (const storeName of STORE_NAME) {\n        if (!db.objectStoreNames.contains(storeName)) {\n          const store = db.createObjectStore(storeName, {\n            keyPath: 'id',\n            autoIncrement: true,\n          });\n          const config = STORE_CONFIG[storeName];\n          store.createIndex(config.indexName, config.indexValue, {\n            unique: true,\n          });\n        }\n      }\n    };\n\n    openRequest.onerror = () =>\n      console.error('Error opening IndexedDB:', openRequest.error);\n  }, []);\n\n  const setUserData = useCallback(\n    (db: IDBDatabase | null, userData: User): Promise<void> => {\n      if (!db) return Promise.reject('Database not initialized');\n\n      return new Promise((resolve, reject) => {\n        const transaction = db.transaction(STORE_NAME, 'readwrite');\n        const store = transaction.objectStore(StoreName.UserConfig);\n\n        const newData: {\n          id?: number;\n          email: string;\n          data: string;\n        } = {\n          email: userData.email,\n          data: JSON.stringify(userData),\n        };\n\n        const index = store.index(STORE_CONFIG[StoreName.UserConfig].indexName);\n        const checkRequest = index.get([userData.email]);\n        checkRequest.onsuccess = () => {\n          const existingRecord = checkRequest.result;\n          if (existingRecord) {\n            newData.id = existingRecord.id;\n          }\n          const request = store.put(newData);\n          request.onsuccess = () => resolve();\n          request.onerror = () => console.error(request.error);\n        };\n        checkRequest.onerror = () => console.error(checkRequest.error);\n      });\n    },\n    [],\n  );\n\n  const getUserData = useCallback(\n    (\n      db: IDBDatabase | null,\n      email: string,\n      signal: AbortSignal,\n    ): Promise<UserDATA_IDB | undefined> => {\n      if (!db) return Promise.reject('Database not initialized');\n\n      return new Promise((resolve, reject) => {\n        const transaction = db.transaction(STORE_NAME, 'readonly');\n        let isTransactionActive = true;\n\n        transaction.oncomplete = () => {\n          isTransactionActive = false;\n        };\n\n        transaction.onerror = (event) => {\n          isTransactionActive = false;\n          console.error((event.target as IDBTransaction).error);\n        };\n\n        signal.addEventListener('abort', () => {\n          if (isTransactionActive) {\n            console.log('getUserData aborted');\n            transaction.abort();\n          }\n        });\n\n        const store = transaction.objectStore(StoreName.UserConfig);\n        const index = store.index(STORE_CONFIG[StoreName.UserConfig].indexName);\n        const request = index.get([email]);\n\n        request.onsuccess = () => {\n          isTransactionActive = false;\n          resolve(request.result as unknown as UserDATA_IDB);\n        };\n        request.onerror = () => {\n          isTransactionActive = false;\n          console.error(request.error);\n        };\n\n        transaction.onabort = () => console.error('Transaction aborted');\n      });\n    },\n    [],\n  );\n\n  const setSpendingData = useCallback(\n    (\n      db: IDBDatabase | null,\n      record: SpendingRecord[],\n      groupId: string | number,\n      time: string = new Date().toISOString(),\n    ): Promise<void> => {\n      if (!db) return Promise.reject('Database not initialized');\n      if (groupId === undefined || groupId === null) {\n        return Promise.reject('Invalid groupId');\n      }\n\n      return new Promise((resolve, reject) => {\n        const transaction = db.transaction(STORE_NAME, 'readwrite');\n        const store = transaction.objectStore(StoreName.ExpenseRecord);\n        const year = new Date(time).getFullYear();\n        const month = new Date(time).getMonth();\n\n        const newData: {\n          id?: number;\n          group_id: string | number;\n          year: number;\n          month: number;\n          data: string;\n        } = {\n          group_id: groupId,\n          year,\n          month,\n          data: JSON.stringify(record),\n        };\n\n        const index = store.index(\n          STORE_CONFIG[StoreName.ExpenseRecord].indexName,\n        );\n        // include groupId in the lookup key for the compound index\n        // index.get may throw a DataError synchronously if the key is invalid\n        try {\n          const checkRequest = index.get([groupId, year, month]);\n          checkRequest.onsuccess = () => {\n            const existingRecord = checkRequest.result;\n            if (existingRecord) {\n              newData.id = existingRecord.id;\n            }\n            const request = store.put(newData);\n            request.onsuccess = () => resolve();\n            request.onerror = () => reject(request.error);\n          };\n          checkRequest.onerror = () => reject(checkRequest.error);\n        } catch (err) {\n          // Fallback: scan all records and find matching group/year/month\n          const allReq = store.getAll();\n          allReq.onsuccess = () => {\n            try {\n              const all = allReq.result as unknown as SpendingDATA_IDB[];\n              const existingRecord = all.find(\n                (r) =>\n                  r.group_id == groupId && r.year === year && r.month === month,\n              );\n              if (existingRecord) {\n                newData.id = existingRecord.id;\n              }\n              const request = store.put(newData);\n              request.onsuccess = () => resolve();\n              request.onerror = () => reject(request.error);\n            } catch (e) {\n              reject(e);\n            }\n          };\n          allReq.onerror = () => reject(allReq.error);\n        }\n      });\n    },\n    [],\n  );\n\n  const getSpendingData = useCallback(\n    (\n      db: IDBDatabase | null,\n      groupId: string | number,\n      signal: AbortSignal,\n    ): Promise<SpendingDATA_IDB[] | undefined> => {\n      if (!db) return Promise.reject('Database not initialized');\n\n      return new Promise((resolve, reject) => {\n        const transaction = db.transaction(STORE_NAME, 'readonly');\n        let isTransactionActive = true;\n\n        transaction.oncomplete = () => {\n          isTransactionActive = false;\n        };\n\n        transaction.onerror = (event) => {\n          isTransactionActive = false;\n          console.error((event.target as IDBTransaction).error);\n        };\n\n        signal.addEventListener('abort', () => {\n          if (isTransactionActive) {\n            console.log('getUserData aborted');\n            transaction.abort();\n          }\n        });\n\n        const store = transaction.objectStore(StoreName.ExpenseRecord);\n        const index = store.index(\n          STORE_CONFIG[StoreName.ExpenseRecord].indexName,\n        );\n        const year = new Date().getFullYear();\n        const month = new Date().getMonth();\n        // include groupId in the query key so we only fetch records for that group\n        const request = index.getAll([groupId, year, month]);\n\n        request.onsuccess = () => {\n          isTransactionActive = false;\n          resolve(request.result as unknown as SpendingDATA_IDB[]);\n        };\n        request.onerror = () => {\n          isTransactionActive = false;\n          console.error(request.error);\n        };\n\n        transaction.onabort = () => console.error('Transaction aborted');\n      });\n    },\n    [],\n  );\n\n  // Cache Group data\n  const setGroupData = useCallback(\n    (db: IDBDatabase | null, userId: number, groups: Group[]): Promise<void> => {\n      if (!db) return Promise.reject('Database not initialized');\n\n      return new Promise((resolve, reject) => {\n        const transaction = db.transaction(STORE_NAME, 'readwrite');\n        const store = transaction.objectStore(StoreName.GroupData);\n\n        const newData: GroupDATA_IDB = {\n          user_id: userId,\n          data: JSON.stringify(groups),\n          timestamp: Date.now(),\n        };\n\n        const index = store.index(STORE_CONFIG[StoreName.GroupData].indexName);\n        const checkRequest = index.get([userId]);\n        checkRequest.onsuccess = () => {\n          const existingRecord = checkRequest.result;\n          if (existingRecord) {\n            newData.id = existingRecord.id;\n          }\n          const request = store.put(newData);\n          request.onsuccess = () => resolve();\n          request.onerror = () => reject(request.error);\n        };\n        checkRequest.onerror = () => reject(checkRequest.error);\n      });\n    },\n    [],\n  );\n\n  const getGroupData = useCallback(\n    (db: IDBDatabase | null, userId: number, maxAge: number = 5 * 60 * 1000): Promise<Group[] | null> => {\n      if (!db) return Promise.reject('Database not initialized');\n\n      return new Promise((resolve, reject) => {\n        const transaction = db.transaction(STORE_NAME, 'readonly');\n        const store = transaction.objectStore(StoreName.GroupData);\n        const index = store.index(STORE_CONFIG[StoreName.GroupData].indexName);\n        const request = index.get([userId]);\n\n        request.onsuccess = () => {\n          const result = request.result as GroupDATA_IDB | undefined;\n          if (!result) {\n            resolve(null);\n            return;\n          }\n\n          // Check cache expiration\n          if (Date.now() - result.timestamp > maxAge) {\n            resolve(null); // Cache expired\n            return;\n          }\n\n          try {\n            const groups = JSON.parse(result.data) as Group[];\n            resolve(groups);\n          } catch (error) {\n            reject(error);\n          }\n        };\n        request.onerror = () => reject(request.error);\n      });\n    },\n    [],\n  );\n\n  // Cache Budget data\n  const setBudgetData = useCallback(\n    (db: IDBDatabase | null, accountId: number, budget: Budget): Promise<void> => {\n      if (!db) return Promise.reject('Database not initialized');\n\n      return new Promise((resolve, reject) => {\n        const transaction = db.transaction(STORE_NAME, 'readwrite');\n        const store = transaction.objectStore(StoreName.BudgetData);\n\n        const newData: BudgetDATA_IDB = {\n          account_id: accountId,\n          data: JSON.stringify(budget),\n          timestamp: Date.now(),\n        };\n\n        const index = store.index(STORE_CONFIG[StoreName.BudgetData].indexName);\n        const checkRequest = index.get([accountId]);\n        checkRequest.onsuccess = () => {\n          const existingRecord = checkRequest.result;\n          if (existingRecord) {\n            newData.id = existingRecord.id;\n          }\n          const request = store.put(newData);\n          request.onsuccess = () => resolve();\n          request.onerror = () => reject(request.error);\n        };\n        checkRequest.onerror = () => reject(checkRequest.error);\n      });\n    },\n    [],\n  );\n\n  const getBudgetData = useCallback(\n    (db: IDBDatabase | null, accountId: number, maxAge: number = 5 * 60 * 1000): Promise<Budget | null> => {\n      if (!db) return Promise.reject('Database not initialized');\n\n      return new Promise((resolve, reject) => {\n        const transaction = db.transaction(STORE_NAME, 'readonly');\n        const store = transaction.objectStore(StoreName.BudgetData);\n        const index = store.index(STORE_CONFIG[StoreName.BudgetData].indexName);\n        const request = index.get([accountId]);\n\n        request.onsuccess = () => {\n          const result = request.result as BudgetDATA_IDB | undefined;\n          if (!result) {\n            resolve(null);\n            return;\n          }\n\n          // Check cache expiration\n          if (Date.now() - result.timestamp > maxAge) {\n            resolve(null); // Cache expired\n            return;\n          }\n\n          try {\n            const budget = JSON.parse(result.data) as Budget;\n            resolve(budget);\n          } catch (error) {\n            reject(error);\n          }\n        };\n        request.onerror = () => reject(request.error);\n      });\n    },\n    [],\n  );\n\n  return {\n    db,\n    setSpendingData,\n    getSpendingData,\n    setUserData,\n    getUserData,\n    setGroupData,\n    getGroupData,\n    setBudgetData,\n    getBudgetData,\n  };\n};\n","const URL = '/api/aurora/groups';\n\nexport const createGroup = async (data: Group) => {\n  try {\n    await fetch(URL, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n    return { status: true, message: 'success' };\n  } catch (error) {\n    console.error(error);\n    return { status: false, data: [], message: 'ÁôºÁîü‰∏çÈ†êÊúüÁöÑÈåØË™§' };\n  }\n};\n\nexport const putGroup = async (data: Group) => {\n  try {\n    await fetch(URL, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n    return { status: true, message: 'success' };\n  } catch (error) {\n    console.error(error);\n    return { status: false, data: [], message: 'ÁôºÁîü‰∏çÈ†êÊúüÁöÑÈåØË™§' };\n  }\n};\n\nexport const deleteGroup = async (id: string) => {\n  try {\n    await fetch(`${URL}?id=${id}`, {\n      method: 'DELETE',\n    });\n    return { status: true, message: 'success' };\n  } catch (error) {\n    console.error(error);\n    return { status: false, data: [], message: 'ÁôºÁîü‰∏çÈ†êÊúüÁöÑÈåØË™§' };\n  }\n};\n\nexport const getGroups = async (\n  user_id: number,\n): Promise<{\n  status: boolean;\n  data: Group[];\n  message: string;\n}> => {\n  try {\n    const data = await fetch(`${URL}?id=${user_id}`).then((res) => res.json());\n    return { status: true, data, message: 'success' };\n  } catch (error) {\n    console.error(error);\n    return { status: false, data: [], message: 'ÁôºÁîü‰∏çÈ†êÊúüÁöÑÈåØË™§' };\n  }\n};\n\nexport const removeGroupMember = async (\n  accountId: number,\n  userId: number,\n): Promise<{\n  status: boolean;\n  message: string;\n}> => {\n  try {\n    await fetch(\n      `/api/aurora/group/member?account_id=${accountId}&user_id=${userId}`,\n      {\n        method: 'DELETE',\n      },\n    );\n    return { status: true, message: 'success' };\n  } catch (error) {\n    console.error(error);\n    return { status: false, message: 'ÁôºÁîü‰∏çÈ†êÊúüÁöÑÈåØË™§' };\n  }\n};\n\nexport const getGroupMembers = async (\n  accountId: number,\n): Promise<{\n  status: boolean;\n  data: GroupMember[];\n  message: string;\n}> => {\n  try {\n    if (!accountId) {\n      return { status: false, data: [], message: 'Áº∫Â∞ëÂ∏≥Êú¨ ID' };\n    }\n    const data = await fetch(`/api/aurora/group/members?account_id=${accountId}`).then(\n      (res) => res.json(),\n    );\n    return { status: true, data, message: 'success' };\n  } catch (error) {\n    console.error(error);\n    return { status: false, data: [], message: 'ÁôºÁîü‰∏çÈ†êÊúüÁöÑÈåØË™§' };\n  }\n};\n","'use client';\n\nimport { getGroups } from '@/services/groupServices';\nimport { useIDB } from '@/hooks/useIDB';\nimport {\n  createContext,\n  ReactNode,\n  useCallback,\n  useContext,\n  useMemo,\n  useState,\n  startTransition,\n} from 'react';\n\nconst INIT_CTX_VAL: {\n  loading: boolean;\n  currentGroup?: Group;\n  groups: Group[];\n  syncGroup: (user_id: number) => void;\n  setter: (_groups: Group[]) => void;\n  setCurrentGroup: (_group?: Group) => void;\n} = {\n  loading: true,\n  currentGroup: undefined,\n  groups: [],\n  syncGroup: () => {},\n  setter: () => {},\n  setCurrentGroup: () => {},\n};\n\nexport const GroupProvider = ({ children }: { children: ReactNode }) => {\n  const [loading, setLoading] = useState(true);\n  const [groups, setGroups] = useState<Group[]>([]);\n  const [currentGroup, setCurrentGroup] = useState<Group>();\n  const { db, getGroupData, setGroupData } = useIDB();\n\n  const handleState = useCallback((res: Group[]) => {\n    setGroups(res);\n    setLoading(false);\n  }, []);\n\n  // Stale-While-Revalidate strategy\n  const queryGroup = useCallback(\n    async (user_id: number) => {\n      if (!db) {\n        // Fallback to direct API call if IndexedDB not ready\n        setLoading(true);\n        getGroups(user_id)\n          .then((res) => {\n            if (res.status) {\n              handleState(res.data);\n            }\n          })\n          .catch(console.error);\n        return;\n      }\n\n      // Try to get cached data first\n      try {\n        const cachedData = await getGroupData(db, user_id);\n        if (cachedData) {\n          // Show cached data immediately (stale)\n          console.log('[GroupProvider] Using cached group data');\n          startTransition(() => {\n            setGroups(cachedData);\n            setLoading(false);\n          });\n        } else {\n          // No cache, show loading\n          setLoading(true);\n        }\n      } catch (error) {\n        console.error('[GroupProvider] Error reading cache:', error);\n        setLoading(true);\n      }\n\n      // Always fetch fresh data in background (revalidate)\n      getGroups(user_id)\n        .then((res) => {\n          if (res.status) {\n            // Update UI with fresh data\n            startTransition(() => {\n              handleState(res.data);\n            });\n            // Update cache\n            setGroupData(db, user_id, res.data).catch(console.error);\n          }\n        })\n        .catch(console.error);\n    },\n    [db, getGroupData, setGroupData, handleState],\n  );\n\n  const ctxVal = useMemo(\n    () => ({\n      loading,\n      groups,\n      currentGroup,\n      setCurrentGroup,\n      syncGroup: queryGroup,\n      setter: handleState,\n    }),\n    [currentGroup, groups, loading, queryGroup, handleState],\n  );\n\n  return <Ctx.Provider value={ctxVal}>{children}</Ctx.Provider>;\n};\n\nconst Ctx = createContext(INIT_CTX_VAL);\nexport const useGroupCtx = () => useContext(Ctx);\n"],"names":[],"mappings":"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","ignoreList":[5]}